const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-fhQdrTv-.js","assets/webworkerAll-Df3z09ZK.js","assets/colorToUniform-B4CQF_NW.js","assets/WebGPURenderer-C_2d22ZB.js","assets/SharedSystems-DsSOgjzf.js","assets/WebGLRenderer-D87XONwH.js"])))=>i.map(i=>d[i]);
var Jb=Object.defineProperty;var tv=(i,t,e)=>t in i?Jb(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var U=(i,t,e)=>tv(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();const ev="modulepreload",iv=function(i){return"/idle-game-pixijs/"+i},ud={},po=function(t,e,s){let r=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),l=(h==null?void 0:h.nonce)||(h==null?void 0:h.getAttribute("nonce"));r=Promise.allSettled(e.map(u=>{if(u=iv(u),u in ud)return;ud[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":ev,d||(g.as="script"),g.crossOrigin="",g.href=u,l&&g.setAttribute("nonce",l),document.head.appendChild(g),d)return new Promise((m,y)=>{g.addEventListener("load",m),g.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(h){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=h,window.dispatchEvent(l),!l.defaultPrevented)throw h}return r.then(h=>{for(const l of h||[])l.status==="rejected"&&o(l.reason);return t().catch(o)})};var q=(i=>(i.Application="application",i.WebGLPipes="webgl-pipes",i.WebGLPipesAdaptor="webgl-pipes-adaptor",i.WebGLSystem="webgl-system",i.WebGPUPipes="webgpu-pipes",i.WebGPUPipesAdaptor="webgpu-pipes-adaptor",i.WebGPUSystem="webgpu-system",i.CanvasSystem="canvas-system",i.CanvasPipesAdaptor="canvas-pipes-adaptor",i.CanvasPipes="canvas-pipes",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i.MaskEffect="mask-effect",i.BlendMode="blend-mode",i.TextureSource="texture-source",i.Environment="environment",i.ShapeBuilder="shape-builder",i.Batcher="batcher",i))(q||{});const Nh=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},Yr=(i,t)=>Nh(i).priority??t,_e={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(Nh).forEach(t=>{t.type.forEach(e=>{var s,r;return(r=(s=this._removeHandlers)[e])==null?void 0:r.call(s,t)})}),this},add(...i){return i.map(Nh).forEach(t=>{t.type.forEach(e=>{var o,h;const s=this._addHandlers,r=this._queue;s[e]?(h=s[e])==null||h.call(s,t):(r[e]=r[e]||[],(o=r[e])==null||o.push(t))})}),this},handle(i,t,e){var h;const s=this._addHandlers,r=this._removeHandlers;if(s[i]||r[i])throw new Error(`Extension type ${i} already has a handler`);s[i]=t,r[i]=e;const o=this._queue;return o[i]&&((h=o[i])==null||h.forEach(l=>t(l)),delete o[i]),this},handleByMap(i,t){return this.handle(i,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(i,t,e=-1){return this.handle(i,s=>{t.findIndex(o=>o.name===s.name)>=0||(t.push({name:s.name,value:s.ref}),t.sort((o,h)=>Yr(h.value,e)-Yr(o.value,e)))},s=>{const r=t.findIndex(o=>o.name===s.name);r!==-1&&t.splice(r,1)})},handleByList(i,t,e=-1){return this.handle(i,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((r,o)=>Yr(o,e)-Yr(r,e)))},s=>{const r=t.indexOf(s.ref);r!==-1&&t.splice(r,1)})}},sv={extension:{type:q.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await po(()=>import("./browserAll-fhQdrTv-.js"),__vite__mapDeps([0,1,2]))}},nv={extension:{type:q.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await po(()=>import("./webworkerAll-Df3z09ZK.js"),__vite__mapDeps([1,2]))}};class ge{constructor(t,e,s){this._x=e||0,this._y=s||0,this._observer=t}clone(t){return new ge(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=0 y=0 scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}var In=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yl(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Ff={exports:{}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(u,d,f){this.fn=u,this.context=d,this.once=f||!1}function o(u,d,f,g,m){if(typeof f!="function")throw new TypeError("The listener must be a function");var y=new r(f,g||u,m),b=e?e+d:d;return u._events[b]?u._events[b].fn?u._events[b]=[u._events[b],y]:u._events[b].push(y):(u._events[b]=y,u._eventsCount++),u}function h(u,d){--u._eventsCount===0?u._events=new s:delete u._events[d]}function l(){this._events=new s,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],f,g;if(this._eventsCount===0)return d;for(g in f=this._events)t.call(f,g)&&d.push(e?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},l.prototype.listeners=function(d){var f=e?e+d:d,g=this._events[f];if(!g)return[];if(g.fn)return[g.fn];for(var m=0,y=g.length,b=new Array(y);m<y;m++)b[m]=g[m].fn;return b},l.prototype.listenerCount=function(d){var f=e?e+d:d,g=this._events[f];return g?g.fn?1:g.length:0},l.prototype.emit=function(d,f,g,m,y,b){var S=e?e+d:d;if(!this._events[S])return!1;var v=this._events[S],M=arguments.length,k,I;if(v.fn){switch(v.once&&this.removeListener(d,v.fn,void 0,!0),M){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,f),!0;case 3:return v.fn.call(v.context,f,g),!0;case 4:return v.fn.call(v.context,f,g,m),!0;case 5:return v.fn.call(v.context,f,g,m,y),!0;case 6:return v.fn.call(v.context,f,g,m,y,b),!0}for(I=1,k=new Array(M-1);I<M;I++)k[I-1]=arguments[I];v.fn.apply(v.context,k)}else{var R=v.length,D;for(I=0;I<R;I++)switch(v[I].once&&this.removeListener(d,v[I].fn,void 0,!0),M){case 1:v[I].fn.call(v[I].context);break;case 2:v[I].fn.call(v[I].context,f);break;case 3:v[I].fn.call(v[I].context,f,g);break;case 4:v[I].fn.call(v[I].context,f,g,m);break;default:if(!k)for(D=1,k=new Array(M-1);D<M;D++)k[D-1]=arguments[D];v[I].fn.apply(v[I].context,k)}}return!0},l.prototype.on=function(d,f,g){return o(this,d,f,g,!1)},l.prototype.once=function(d,f,g){return o(this,d,f,g,!0)},l.prototype.removeListener=function(d,f,g,m){var y=e?e+d:d;if(!this._events[y])return this;if(!f)return h(this,y),this;var b=this._events[y];if(b.fn)b.fn===f&&(!m||b.once)&&(!g||b.context===g)&&h(this,y);else{for(var S=0,v=[],M=b.length;S<M;S++)(b[S].fn!==f||m&&!b[S].once||g&&b[S].context!==g)&&v.push(b[S]);v.length?this._events[y]=v.length===1?v[0]:v:h(this,y)}return this},l.prototype.removeAllListeners=function(d){var f;return d?(f=e?e+d:d,this._events[f]&&h(this,f)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,i.exports=l})(Ff);var rv=Ff.exports;const ii=yl(rv),ov=Math.PI*2,av=180/Math.PI,hv=Math.PI/180;class at{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new at(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return hh.x=0,hh.y=0,hh}}const hh=new at;class yt{constructor(t=1,e=0,s=0,r=1,o=0,h=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=r,this.tx=o,this.ty=h}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,r,o,h){return this.a=t,this.b=e,this.c=s,this.d=r,this.tx=o,this.ty=h,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new at;const s=t.x,r=t.y;return e.x=this.a*s+this.c*r+this.tx,e.y=this.b*s+this.d*r+this.ty,e}applyInverse(t,e){e=e||new at;const s=this.a,r=this.b,o=this.c,h=this.d,l=this.tx,u=this.ty,d=1/(s*h+o*-r),f=t.x,g=t.y;return e.x=h*d*f+-o*d*g+(u*o-l*h)*d,e.y=s*d*g+-r*d*f+(-u*s+l*r)*d,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),r=this.a,o=this.c,h=this.tx;return this.a=r*e-this.b*s,this.b=r*s+this.b*e,this.c=o*e-this.d*s,this.d=o*s+this.d*e,this.tx=h*e-this.ty*s,this.ty=h*s+this.ty*e,this}append(t){const e=this.a,s=this.b,r=this.c,o=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*s+t.b*o,this.c=t.c*e+t.d*r,this.d=t.c*s+t.d*o,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*s+t.ty*o+this.ty,this}appendFrom(t,e){const s=t.a,r=t.b,o=t.c,h=t.d,l=t.tx,u=t.ty,d=e.a,f=e.b,g=e.c,m=e.d;return this.a=s*d+r*g,this.b=s*f+r*m,this.c=o*d+h*g,this.d=o*f+h*m,this.tx=l*d+u*g+e.tx,this.ty=l*f+u*m+e.ty,this}setTransform(t,e,s,r,o,h,l,u,d){return this.a=Math.cos(l+d)*o,this.b=Math.sin(l+d)*o,this.c=-Math.sin(l-u)*h,this.d=Math.cos(l-u)*h,this.tx=t-(s*this.a+r*this.c),this.ty=e-(s*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,r=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,r=this.c,o=this.d,h=t.pivot,l=-Math.atan2(-r,o),u=Math.atan2(s,e),d=Math.abs(l+u);return d<1e-5||Math.abs(ov-d)<1e-5?(t.rotation=u,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=l,t.skew.y=u),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(r*r+o*o),t.position.x=this.tx+(h.x*e+h.y*r),t.position.y=this.ty+(h.x*s+h.y*o),t}invert(){const t=this.a,e=this.b,s=this.c,r=this.d,o=this.tx,h=t*r-e*s;return this.a=r/h,this.b=-e/h,this.c=-s/h,this.d=t/h,this.tx=(s*this.ty-r*o)/h,this.ty=-(t*this.ty-e*o)/h,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new yt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return cv.identity()}static get shared(){return lv.identity()}}const lv=new yt,cv=new yt,ws=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],bs=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],vs=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],As=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Gh=[],Uf=[],Xr=Math.sign;function uv(){for(let i=0;i<16;i++){const t=[];Gh.push(t);for(let e=0;e<16;e++){const s=Xr(ws[i]*ws[e]+vs[i]*bs[e]),r=Xr(bs[i]*ws[e]+As[i]*bs[e]),o=Xr(ws[i]*vs[e]+vs[i]*As[e]),h=Xr(bs[i]*vs[e]+As[i]*As[e]);for(let l=0;l<16;l++)if(ws[l]===s&&bs[l]===r&&vs[l]===o&&As[l]===h){t.push(l);break}}}for(let i=0;i<16;i++){const t=new yt;t.set(ws[i],bs[i],vs[i],As[i],0,0),Uf.push(t)}}uv();const Lt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>ws[i],uY:i=>bs[i],vX:i=>vs[i],vY:i=>As[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>Gh[i][t],sub:(i,t)=>Gh[i][Lt.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?Lt.S:Lt.N:Math.abs(t)*2<=Math.abs(i)?i>0?Lt.E:Lt.W:t>0?i>0?Lt.SE:Lt.SW:i>0?Lt.NE:Lt.NW,matrixAppendRotationInv:(i,t,e=0,s=0)=>{const r=Uf[Lt.inv(t)];r.tx=e,r.ty=s,i.append(r)}},qr=[new at,new at,new at,new at];let ie=class ao{constructor(t=0,e=0,s=0,r=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new ao(0,0,0,0)}clone(){return new ao(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,s){const{width:r,height:o}=this;if(r<=0||o<=0)return!1;const h=this.x,l=this.y,u=h-s/2,d=h+r+s/2,f=l-s/2,g=l+o+s/2,m=h+s/2,y=h+r-s/2,b=l+s/2,S=l+o-s/2;return t>=u&&t<=d&&e>=f&&e<=g&&!(t>m&&t<y&&e>b&&e<S)}intersects(t,e){if(!e){const Y=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=Y)return!1;const W=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>W}const s=this.left,r=this.right,o=this.top,h=this.bottom;if(r<=s||h<=o)return!1;const l=qr[0].set(t.left,t.top),u=qr[1].set(t.left,t.bottom),d=qr[2].set(t.right,t.top),f=qr[3].set(t.right,t.bottom);if(d.x<=l.x||u.y<=l.y)return!1;const g=Math.sign(e.a*e.d-e.b*e.c);if(g===0||(e.apply(l,l),e.apply(u,u),e.apply(d,d),e.apply(f,f),Math.max(l.x,u.x,d.x,f.x)<=s||Math.min(l.x,u.x,d.x,f.x)>=r||Math.max(l.y,u.y,d.y,f.y)<=o||Math.min(l.y,u.y,d.y,f.y)>=h))return!1;const m=g*(u.y-l.y),y=g*(l.x-u.x),b=m*s+y*o,S=m*r+y*o,v=m*s+y*h,M=m*r+y*h;if(Math.max(b,S,v,M)<=m*l.x+y*l.y||Math.min(b,S,v,M)>=m*f.x+y*f.y)return!1;const k=g*(l.y-d.y),I=g*(d.x-l.x),R=k*s+I*o,D=k*r+I*o,K=k*s+I*h,H=k*r+I*h;return!(Math.max(R,D,K,H)<=k*l.x+I*l.y||Math.min(R,D,K,H)>=k*f.x+I*f.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),o=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=r,this.height=Math.max(o-r,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=r,this.height=o-r,this}getBounds(t){return t=t||new ao,t.copyFrom(this),t}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};const lh={default:-1};function Qt(i="default"){return lh[i]===void 0&&(lh[i]=-1),++lh[i]}const dd={},xt="8.0.0",dv="8.3.4";function gt(i,t,e=3){if(dd[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(s))),dd[t]=!0}const Vf=()=>{};function fd(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function pd(i){return!(i&i-1)&&!!i}function fv(i){const t={};for(const e in i)i[e]!==void 0&&(t[e]=i[e]);return t}const gd=Object.create(null);function pv(i){const t=gd[i];return t===void 0&&(gd[i]=Qt("resource")),t}const Df=class Wf extends ii{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Wf.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){gt(xt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=pv(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Df.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let gv=Df;const Nf=class Gf extends ii{constructor(t={}){super(),this.options=t,this.uid=Qt("textureSource"),this._resourceType="textureSource",this._resourceId=Qt("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...Gf.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new gv(fv(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,s;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(s=this._style)==null||s.on("change",this._onStyleChange,this),this._onStyleChange())}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=Qt("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,s){s=s||this._resolution,t=t||this.width,e=e||this.height;const r=Math.round(t*s),o=Math.round(e*s);return this.width=r/s,this.height=o/s,this._resolution=s,this.pixelWidth===r&&this.pixelHeight===o?!1:(this._refreshPOT(),this.pixelWidth=r,this.pixelHeight=o,this.emit("resize",this),this._resourceId=Qt("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=pd(this.pixelWidth)&&pd(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Nf.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Oi=Nf;class wl extends Oi{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let s=t.format;s||(e instanceof Float32Array?s="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?s="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?s="rgba16uint":(e instanceof Int8Array,s="bgra8unorm")),super({...t,resource:e,format:s}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}wl.extension=q.TextureSource;const _d=new yt;class _v{constructor(t,e){this.mapCoord=new yt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let r=0;r<t.length;r+=2){const o=t[r],h=t[r+1];e[r]=o*s.a+h*s.c+s.tx,e[r+1]=o*s.b+h*s.d+s.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const s=t.orig,r=t.trim;r&&(_d.set(s.width/r.width,0,0,s.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(_d));const o=t.source,h=this.uClampFrame,l=this.clampMargin/o._resolution,u=this.clampOffset/o._resolution;return h[0]=(t.frame.x+l+u)/o.width,h[1]=(t.frame.y+l+u)/o.height,h[2]=(t.frame.x+t.frame.width-l+u)/o.width,h[3]=(t.frame.y+t.frame.height-l+u)/o.height,this.uClampOffset[0]=this.clampOffset/o.pixelWidth,this.uClampOffset[1]=this.clampOffset/o.pixelHeight,this.isSimple=t.frame.width===o.width&&t.frame.height===o.height&&t.rotate===0,!0}}class ft extends ii{constructor({source:t,label:e,frame:s,orig:r,trim:o,defaultAnchor:h,defaultBorders:l,rotate:u,dynamic:d}={}){if(super(),this.uid=Qt("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new ie,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new Oi,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:f,height:g}=this._source;this.frame.width=f,this.frame.height=g}this.orig=r||this.frame,this.trim=o,this.rotate=u??0,this.defaultAnchor=h,this.defaultBorders=l,this.destroyed=!1,this.dynamic=d||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new _v(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:s,height:r}=this._source,o=e.x/s,h=e.y/r,l=e.width/s,u=e.height/r;let d=this.rotate;if(d){const f=l/2,g=u/2,m=o+f,y=h+g;d=Lt.add(d,Lt.NW),t.x0=m+f*Lt.uX(d),t.y0=y+g*Lt.uY(d),d=Lt.add(d,2),t.x1=m+f*Lt.uX(d),t.y1=y+g*Lt.uY(d),d=Lt.add(d,2),t.x2=m+f*Lt.uX(d),t.y2=y+g*Lt.uY(d),d=Lt.add(d,2),t.x3=m+f*Lt.uX(d),t.y3=y+g*Lt.uY(d)}else t.x0=o,t.y0=h,t.x1=o+l,t.y1=h,t.x2=o+l,t.y2=h+u,t.x3=o,t.y3=h+u}destroy(t=!1){this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return gt(xt,"Texture.baseTexture is now Texture.source"),this._source}}ft.EMPTY=new ft({label:"EMPTY",source:new Oi({label:"EMPTY"})});ft.EMPTY.destroy=Vf;ft.WHITE=new ft({source:new wl({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});ft.WHITE.destroy=Vf;function mv(i,t,e,s){const{width:r,height:o}=e.orig,h=e.trim;if(h){const l=h.width,u=h.height;i.minX=h.x-t._x*r-s,i.maxX=i.minX+l,i.minY=h.y-t._y*o-s,i.maxY=i.minY+u}else i.minX=-t._x*r-s,i.maxX=i.minX+r,i.minY=-t._y*o-s,i.maxY=i.minY+o}const md=new yt;class pi{constructor(t=1/0,e=1/0,s=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=md,this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new ie);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=md,this}set(t,e,s,r){this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}addFrame(t,e,s,r,o){o||(o=this.matrix);const h=o.a,l=o.b,u=o.c,d=o.d,f=o.tx,g=o.ty;let m=this.minX,y=this.minY,b=this.maxX,S=this.maxY,v=h*t+u*e+f,M=l*t+d*e+g;v<m&&(m=v),M<y&&(y=M),v>b&&(b=v),M>S&&(S=M),v=h*s+u*e+f,M=l*s+d*e+g,v<m&&(m=v),M<y&&(y=M),v>b&&(b=v),M>S&&(S=M),v=h*t+u*r+f,M=l*t+d*r+g,v<m&&(m=v),M<y&&(y=M),v>b&&(b=v),M>S&&(S=M),v=h*s+u*r+f,M=l*s+d*r+g,v<m&&(m=v),M<y&&(y=M),v>b&&(b=v),M>S&&(S=M),this.minX=m,this.minY=y,this.maxX=b,this.maxY=S}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,s=this.minY,r=this.maxX,o=this.maxY,{a:h,b:l,c:u,d,tx:f,ty:g}=t;let m=h*e+u*s+f,y=l*e+d*s+g;this.minX=m,this.minY=y,this.maxX=m,this.maxY=y,m=h*r+u*s+f,y=l*r+d*s+g,this.minX=m<this.minX?m:this.minX,this.minY=y<this.minY?y:this.minY,this.maxX=m>this.maxX?m:this.maxX,this.maxY=y>this.maxY?y:this.maxY,m=h*e+u*o+f,y=l*e+d*o+g,this.minX=m<this.minX?m:this.minX,this.minY=y<this.minY?y:this.minY,this.maxX=m>this.maxX?m:this.maxX,this.maxY=y>this.maxY?y:this.maxY,m=h*r+u*o+f,y=l*r+d*o+g,this.minX=m<this.minX?m:this.minX,this.minY=y<this.minY?y:this.minY,this.maxX=m>this.maxX?m:this.maxX,this.maxY=y>this.maxY?y:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,s,r){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<s&&(this.minY=s),this.maxY>r&&(this.maxY=r),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new pi(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,s,r){let o=this.minX,h=this.minY,l=this.maxX,u=this.maxY;r||(r=this.matrix);const d=r.a,f=r.b,g=r.c,m=r.d,y=r.tx,b=r.ty;for(let S=e;S<s;S+=2){const v=t[S],M=t[S+1],k=d*v+g*M+y,I=f*v+m*M+b;o=k<o?k:o,h=I<h?I:h,l=k>l?k:l,u=I>u?I:u}this.minX=o,this.minY=h,this.maxX=l,this.maxY=u}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}var xv={grad:.9,turn:360,rad:360/(2*Math.PI)},Mi=function(i){return typeof i=="string"?i.length>0:typeof i=="number"},ee=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*i)/e+0},ze=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),i>e?e:i>t?i:t},Hf=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},xd=function(i){return{r:ze(i.r,0,255),g:ze(i.g,0,255),b:ze(i.b,0,255),a:ze(i.a)}},ch=function(i){return{r:ee(i.r),g:ee(i.g),b:ee(i.b),a:ee(i.a,3)}},yv=/^#([0-9a-f]{3,8})$/i,jr=function(i){var t=i.toString(16);return t.length<2?"0"+t:t},zf=function(i){var t=i.r,e=i.g,s=i.b,r=i.a,o=Math.max(t,e,s),h=o-Math.min(t,e,s),l=h?o===t?(e-s)/h:o===e?2+(s-t)/h:4+(t-e)/h:0;return{h:60*(l<0?l+6:l),s:o?h/o*100:0,v:o/255*100,a:r}},$f=function(i){var t=i.h,e=i.s,s=i.v,r=i.a;t=t/360*6,e/=100,s/=100;var o=Math.floor(t),h=s*(1-e),l=s*(1-(t-o)*e),u=s*(1-(1-t+o)*e),d=o%6;return{r:255*[s,l,h,h,u,s][d],g:255*[u,s,s,l,h,h][d],b:255*[h,h,u,s,s,l][d],a:r}},yd=function(i){return{h:Hf(i.h),s:ze(i.s,0,100),l:ze(i.l,0,100),a:ze(i.a)}},wd=function(i){return{h:ee(i.h),s:ee(i.s),l:ee(i.l),a:ee(i.a,3)}},bd=function(i){return $f((e=(t=i).s,{h:t.h,s:(e*=((s=t.l)<50?s:100-s)/100)>0?2*e/(s+e)*100:0,v:s+e,a:t.a}));var t,e,s},Gn=function(i){return{h:(t=zf(i)).h,s:(r=(200-(e=t.s))*(s=t.v)/100)>0&&r<200?e*s/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,s,r},wv=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,bv=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,vv=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Av=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Hh={string:[[function(i){var t=yv.exec(i);return t?(i=t[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?ee(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?ee(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var t=vv.exec(i)||Av.exec(i);return t?t[2]!==t[4]||t[4]!==t[6]?null:xd({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(i){var t=wv.exec(i)||bv.exec(i);if(!t)return null;var e,s,r=yd({h:(e=t[1],s=t[2],s===void 0&&(s="deg"),Number(e)*(xv[s]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return bd(r)},"hsl"]],object:[[function(i){var t=i.r,e=i.g,s=i.b,r=i.a,o=r===void 0?1:r;return Mi(t)&&Mi(e)&&Mi(s)?xd({r:Number(t),g:Number(e),b:Number(s),a:Number(o)}):null},"rgb"],[function(i){var t=i.h,e=i.s,s=i.l,r=i.a,o=r===void 0?1:r;if(!Mi(t)||!Mi(e)||!Mi(s))return null;var h=yd({h:Number(t),s:Number(e),l:Number(s),a:Number(o)});return bd(h)},"hsl"],[function(i){var t=i.h,e=i.s,s=i.v,r=i.a,o=r===void 0?1:r;if(!Mi(t)||!Mi(e)||!Mi(s))return null;var h=function(l){return{h:Hf(l.h),s:ze(l.s,0,100),v:ze(l.v,0,100),a:ze(l.a)}}({h:Number(t),s:Number(e),v:Number(s),a:Number(o)});return $f(h)},"hsv"]]},vd=function(i,t){for(var e=0;e<t.length;e++){var s=t[e][0](i);if(s)return[s,t[e][1]]}return[null,void 0]},Sv=function(i){return typeof i=="string"?vd(i.trim(),Hh.string):typeof i=="object"&&i!==null?vd(i,Hh.object):[null,void 0]},uh=function(i,t){var e=Gn(i);return{h:e.h,s:ze(e.s+100*t,0,100),l:e.l,a:e.a}},dh=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},Ad=function(i,t){var e=Gn(i);return{h:e.h,s:e.s,l:ze(e.l+100*t,0,100),a:e.a}},zh=function(){function i(t){this.parsed=Sv(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return i.prototype.isValid=function(){return this.parsed!==null},i.prototype.brightness=function(){return ee(dh(this.rgba),2)},i.prototype.isDark=function(){return dh(this.rgba)<.5},i.prototype.isLight=function(){return dh(this.rgba)>=.5},i.prototype.toHex=function(){return t=ch(this.rgba),e=t.r,s=t.g,r=t.b,h=(o=t.a)<1?jr(ee(255*o)):"","#"+jr(e)+jr(s)+jr(r)+h;var t,e,s,r,o,h},i.prototype.toRgb=function(){return ch(this.rgba)},i.prototype.toRgbString=function(){return t=ch(this.rgba),e=t.r,s=t.g,r=t.b,(o=t.a)<1?"rgba("+e+", "+s+", "+r+", "+o+")":"rgb("+e+", "+s+", "+r+")";var t,e,s,r,o},i.prototype.toHsl=function(){return wd(Gn(this.rgba))},i.prototype.toHslString=function(){return t=wd(Gn(this.rgba)),e=t.h,s=t.s,r=t.l,(o=t.a)<1?"hsla("+e+", "+s+"%, "+r+"%, "+o+")":"hsl("+e+", "+s+"%, "+r+"%)";var t,e,s,r,o},i.prototype.toHsv=function(){return t=zf(this.rgba),{h:ee(t.h),s:ee(t.s),v:ee(t.v),a:ee(t.a,3)};var t},i.prototype.invert=function(){return ui({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},i.prototype.saturate=function(t){return t===void 0&&(t=.1),ui(uh(this.rgba,t))},i.prototype.desaturate=function(t){return t===void 0&&(t=.1),ui(uh(this.rgba,-t))},i.prototype.grayscale=function(){return ui(uh(this.rgba,-1))},i.prototype.lighten=function(t){return t===void 0&&(t=.1),ui(Ad(this.rgba,t))},i.prototype.darken=function(t){return t===void 0&&(t=.1),ui(Ad(this.rgba,-t))},i.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},i.prototype.alpha=function(t){return typeof t=="number"?ui({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):ee(this.rgba.a,3);var e},i.prototype.hue=function(t){var e=Gn(this.rgba);return typeof t=="number"?ui({h:t,s:e.s,l:e.l,a:e.a}):ee(e.h)},i.prototype.isEqual=function(t){return this.toHex()===ui(t).toHex()},i}(),ui=function(i){return i instanceof zh?i:new zh(i)},Sd=[],Cv=function(i){i.forEach(function(t){Sd.indexOf(t)<0&&(t(zh,Hh),Sd.push(t))})};function Pv(i,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var r in e)s[e[r]]=r;var o={};i.prototype.toName=function(h){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var l,u,d=s[this.toHex()];if(d)return d;if(h!=null&&h.closest){var f=this.toRgb(),g=1/0,m="black";if(!o.length)for(var y in e)o[y]=new i(e[y]).toRgb();for(var b in e){var S=(l=f,u=o[b],Math.pow(l.r-u.r,2)+Math.pow(l.g-u.g,2)+Math.pow(l.b-u.b,2));S<g&&(g=S,m=b)}return m}},t.string.push([function(h){var l=h.toLowerCase(),u=l==="transparent"?"#0000":e[l];return u?new i(u).toRgb():null},"name"])}Cv([Pv]);const rn=class On{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof On)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const s=typeof t;if(s!==typeof e)return!1;if(s==="number"||s==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((o,h)=>o===e[h]);if(t!==null&&e!==null){const o=Object.keys(t),h=Object.keys(e);return o.length!==h.length?!1:o.every(l=>t[l]===e[l])}return t===e}toRgba(){const[t,e,s,r]=this._components;return{r:t,g:e,b:s,a:r}}toRgb(){const[t,e,s]=this._components;return{r:t,g:e,b:s}}toRgbaString(){const[t,e,s]=this.toUint8RgbArray();return`rgba(${t},${e},${s},${this.alpha})`}toUint8RgbArray(t){const[e,s,r]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t=t||this._arrayRgb,t[0]=Math.round(e*255),t[1]=Math.round(s*255),t[2]=Math.round(r*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t=t||this._arrayRgba;const[e,s,r,o]=this._components;return t[0]=e,t[1]=s,t[2]=r,t[3]=o,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t=t||this._arrayRgb;const[e,s,r]=this._components;return t[0]=e,t[1]=s,t[2]=r,t}toNumber(){return this._int}toBgrNumber(){const[t,e,s]=this.toUint8RgbArray();return(s<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,s,r,o]=On._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=s,this._components[2]*=r,this._components[3]*=o,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let s=this._int>>16&255,r=this._int>>8&255,o=this._int&255;return e&&(s=s*t+.5|0,r=r*t+.5|0,o=o*t+.5|0),(t*255<<24)+(s<<16)+(r<<8)+o}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,s,r,o;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const h=t;e=(h>>16&255)/255,s=(h>>8&255)/255,r=(h&255)/255,o=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,s,r,o=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,s,r,o=255]=t,e/=255,s/=255,r/=255,o/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const l=On.HEX_PATTERN.exec(t);l&&(t=`#${l[2]}`)}const h=ui(t);h.isValid()&&({r:e,g:s,b:r,a:o}=h.rgba,e/=255,s/=255,r/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=s,this._components[2]=r,this._components[3]=o,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,s]=this._components;this._int=(t*255<<16)+(e*255<<8)+(s*255|0)}_clamp(t,e=0,s=1){return typeof t=="number"?Math.min(Math.max(t,e),s):(t.forEach((r,o)=>{t[o]=Math.min(Math.max(r,e),s)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof On||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};rn.shared=new rn;rn._temp=new rn;rn.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let $t=rn;const Mv={cullArea:null,cullable:!1,cullableChildren:!0};class bl{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var s;let e;return this._index>0?e=this._pool[--this._index]:e=new this._classType,(s=e.init)==null||s.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){this._pool.length=0,this._index=0}}class Tv{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new bl(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const s=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[s]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const Ei=new Tv;function Iv(i,t,e){const s=i.length;let r;if(t>=s||e===0)return;e=t+e>s?s-t:e;const o=s-e;for(r=t;r<o;++r)i[r]=i[r+e];i.length=o}const kv={allowChildren:!0,removeChildren(i=0,t){const e=t??this.children.length,s=e-i,r=[];if(s>0&&s<=e){for(let h=e-1;h>=i;h--){const l=this.children[h];l&&(r.push(l),l.parent=null)}Iv(this.children,i,e);const o=this.renderGroup||this.parentRenderGroup;o&&o.removeChildren(r);for(let h=0;h<r.length;++h)this.emit("childRemoved",r[h],this,h),r[h].emit("removed",this);return r}else if(s===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(i){const t=this.getChildAt(i);return this.removeChild(t)},getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]},setChildIndex(i,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(i),this.addChildAt(i,t)},getChildIndex(i){const t=this.children.indexOf(i);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(i,t){this.allowChildren||gt(xt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${i}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(i.parent){const r=i.parent.children.indexOf(i);if(i.parent===this&&r===t)return i;r!==-1&&i.parent.children.splice(r,1)}t===e.length?e.push(i):e.splice(t,0,i),i.parent=this,i.didChange=!0,i._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(i),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",i,this,t),i.emit("added",this),i},swapChildren(i,t){if(i===t)return;const e=this.getChildIndex(i),s=this.getChildIndex(t);this.children[e]=t,this.children[s]=i;const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var i;(i=this.parent)==null||i.removeChild(this)},reparentChild(...i){return i.length===1?this.reparentChildAt(i[0],this.children.length):(i.forEach(t=>this.reparentChildAt(t,this.children.length)),i[0])},reparentChildAt(i,t){if(i.parent===this)return this.setChildIndex(i,t),i;const e=i.worldTransform.clone();i.removeFromParent(),this.addChildAt(i,t);const s=this.worldTransform.clone();return s.invert(),e.prepend(s),i.setFromMatrix(e),i}};class Cd{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Ev{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const s=this._tests[e];if(s.test(t))return Ei.get(s.maskClass,t)}return t}returnMaskEffect(t){Ei.return(t)}}const $h=new Ev;_e.handleByList(q.MaskEffect,$h._effectClasses);const Rv={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],addEffect(i){if(this.effects.indexOf(i)!==-1)return;this.effects.push(i),this.effects.sort((s,r)=>s.priority-r.priority);const e=this.renderGroup||this.parentRenderGroup;e&&(e.structureDidChange=!0),this._updateIsSimple()},removeEffect(i){const t=this.effects.indexOf(i);t!==-1&&(this.effects.splice(t,1),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateIsSimple())},set mask(i){const t=this._maskEffect;(t==null?void 0:t.mask)!==i&&(t&&(this.removeEffect(t),$h.returnMaskEffect(t),this._maskEffect=null),i!=null&&(this._maskEffect=$h.getMaskEffect(i),this.addEffect(this._maskEffect)))},setMask(i){this._maskOptions={...this._maskOptions,...i},i.mask&&(this.mask=i.mask)},get mask(){var i;return(i=this._maskEffect)==null?void 0:i.mask},set filters(i){var o;!Array.isArray(i)&&i&&(i=[i]);const t=this._filterEffect||(this._filterEffect=new Cd);i=i;const e=(i==null?void 0:i.length)>0,s=((o=t.filters)==null?void 0:o.length)>0,r=e!==s;i=Array.isArray(i)?i.slice(0):i,t.filters=Object.freeze(i),r&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=i??null))},get filters(){var i;return(i=this._filterEffect)==null?void 0:i.filters},set filterArea(i){this._filterEffect||(this._filterEffect=new Cd),this._filterEffect.filterArea=i},get filterArea(){var i;return(i=this._filterEffect)==null?void 0:i.filterArea}},Bv={label:null,get name(){return gt(xt,"Container.name property has been removed, use Container.label instead"),this.label},set name(i){gt(xt,"Container.name property has been removed, use Container.label instead"),this.label=i},getChildByName(i,t=!1){return this.getChildByLabel(i,t)},getChildByLabel(i,t=!1){const e=this.children;for(let s=0;s<e.length;s++){const r=e[s];if(r.label===i||i instanceof RegExp&&i.test(r.label))return r}if(t)for(let s=0;s<e.length;s++){const o=e[s].getChildByLabel(i,!0);if(o)return o}return null},getChildrenByLabel(i,t=!1,e=[]){const s=this.children;for(let r=0;r<s.length;r++){const o=s[r];(o.label===i||i instanceof RegExp&&i.test(o.label))&&e.push(o)}if(t)for(let r=0;r<s.length;r++)s[r].getChildrenByLabel(i,!0,e);return e}},Ri=new bl(yt),on=new bl(pi);function Yf(i,t,e){e.clear();let s,r;return i.parent?t?s=i.parent.worldTransform:(r=Ri.get().identity(),s=go(i,r)):s=yt.IDENTITY,Xf(i,e,s,t),r&&Ri.return(r),e.isValid||e.set(0,0,0,0),e}function Xf(i,t,e,s){var l,u;if(!i.visible||!i.measurable)return;let r;s?r=i.worldTransform:(i.updateLocalTransform(),r=Ri.get(),r.appendFrom(i.localTransform,e));const o=t,h=!!i.effects.length;if(h&&(t=on.get().clear()),i.boundsArea)t.addRect(i.boundsArea,r);else{i.addBounds&&(t.matrix=r,i.addBounds(t));for(let d=0;d<i.children.length;d++)Xf(i.children[d],t,r,s)}if(h){for(let d=0;d<i.effects.length;d++)(u=(l=i.effects[d]).addBounds)==null||u.call(l,t);o.addBounds(t,yt.IDENTITY),on.return(t)}s||Ri.return(r)}function go(i,t){const e=i.parent;return e&&(go(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}let fh=0;const Pd=500;function Yt(...i){fh!==Pd&&(fh++,fh===Pd?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...i))}function qf(i,t,e){return t.clear(),e||(e=yt.IDENTITY),jf(i,t,e,i,!0),t.isValid||t.set(0,0,0,0),t}function jf(i,t,e,s,r){var u,d;let o;if(r)o=Ri.get(),o=e.copyTo(o);else{if(!i.visible||!i.measurable)return;i.updateLocalTransform();const f=i.localTransform;o=Ri.get(),o.appendFrom(f,e)}const h=t,l=!!i.effects.length;if(l&&(t=on.get().clear()),i.boundsArea)t.addRect(i.boundsArea,o);else{i.renderPipeId&&(t.matrix=o,i.addBounds(t));const f=i.children;for(let g=0;g<f.length;g++)jf(f[g],t,o,s,!1)}if(l){for(let f=0;f<i.effects.length;f++)(d=(u=i.effects[f]).addLocalBounds)==null||d.call(u,t,s);h.addBounds(t,yt.IDENTITY),on.return(t)}Ri.return(o)}function Kf(i,t){const e=i.children;for(let s=0;s<e.length;s++){const r=e[s],o=r.uid,h=(r._didViewChangeTick&65535)<<16|r._didContainerChangeTick&65535,l=t.index;(t.data[l]!==o||t.data[l+1]!==h)&&(t.data[t.index]=o,t.data[t.index+1]=h,t.didChange=!0),t.index=l+2,r.children.length&&Kf(r,t)}return t.didChange}const Lv=new yt,Ov={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(i,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=i/t*e:this.scale.x=e},_setHeight(i,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=i/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new pi});const i=this._localBoundsCacheData;return i.index=1,i.didChange=!1,i.data[0]!==this._didViewChangeTick&&(i.didChange=!0,i.data[0]=this._didViewChangeTick),Kf(this,i),i.didChange&&qf(this,i.localBounds,Lv),i.localBounds},getBounds(i,t){return Yf(this,i,t||new pi)}},Fv={_onRender:null,set onRender(i){const t=this.renderGroup||this.parentRenderGroup;if(!i){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=i},get onRender(){return this._onRender}},Uv={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(i){this._zIndex!==i&&(this._zIndex=i,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Vv))}};function Vv(i,t){return i._zIndex-t._zIndex}const Dv={getGlobalPosition(i=new at,t=!1){return this.parent?this.parent.toGlobal(this._position,i,t):(i.x=this._position.x,i.y=this._position.y),i},toGlobal(i,t,e=!1){if(!e){this.updateLocalTransform();const s=go(this,new yt);return s.append(this.localTransform),s.apply(i,t)}return this.worldTransform.apply(i,t)},toLocal(i,t,e,s){if(t&&(i=t.toGlobal(i,e,s)),!s){this.updateLocalTransform();const r=go(this,new yt);return r.append(this.localTransform),r.applyInverse(i,e)}return this.worldTransform.applyInverse(i,e)}};let Wv=0;class Zf{constructor(){this.uid=Qt("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.tick=0}reset(){this.instructionSize=0,this.tick=Wv++}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}class Nv{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new yt,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new Zf,this._onRenderContainers=[]}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let s=0;s<e.length;s++)this.addChild(e[s])}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let s=0;s<e.length;s++)this.addChild(e[s])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let s=0;s<e.length;s++)this.removeChild(e[s])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender()}destroy(){this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let s=0;s<e.length;s++)this._getChildren(e[s],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const s=t.children;for(let r=0;r<s.length;r++)this._getChildren(s[r],e);return e}}function Gv(i,t,e={}){for(const s in t)!e[s]&&t[s]!==void 0&&(i[s]=t[s])}const ph=new ge(null),gh=new ge(null),_h=new ge(null,1,1),Md=1,Hv=2,mh=4;class kt extends ii{constructor(t={}){var e,s;super(),this.uid=Qt("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new yt,this.relativeGroupTransform=new yt,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new ge(this,0,0),this._scale=_h,this._pivot=gh,this._skew=ph,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Gv(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(r=>this.addChild(r)),(s=t.parent)==null||s.addChild(this)}static mixin(t){Object.defineProperties(kt.prototype,Object.getOwnPropertyDescriptors(t))}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||gt(xt,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let r=0;r<t.length;r++)this.addChild(t[r]);return t[0]}const e=t[0];if(e.parent===this)return this.children.splice(this.children.indexOf(e),1),this.children.push(e),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),e;e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e}removeChild(...t){if(t.length>1){for(let r=0;r<t.length;r++)this.removeChild(t[r]);return t[0]}const e=t[0],s=this.children.indexOf(e);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parent=null,this.emit("childRemoved",e,this,s),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=Ei.get(Nv,this),this.groupTransform=yt.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),Ei.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new yt),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*av}set angle(t){this.rotation=t*hv}get pivot(){return this._pivot===gh&&(this._pivot=new ge(this,0,0)),this._pivot}set pivot(t){this._pivot===gh&&(this._pivot=new ge(this,0,0)),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===ph&&(this._skew=new ge(this,0,0)),this._skew}set skew(t){this._skew===ph&&(this._skew=new ge(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===_h&&(this._scale=new ge(this,1,1)),this._scale}set scale(t){this._scale===_h&&(this._scale=new ge(this,0,0)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const s=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,s.width),e!==void 0&&this._setHeight(e,s.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,s=this._scale,r=this._pivot,o=this._position,h=s._x,l=s._y,u=r._x,d=r._y;e.a=this._cx*h,e.b=this._sx*h,e.c=this._cy*l,e.d=this._sy*l,e.tx=o._x-(u*e.a+d*e.c),e.ty=o._y-(u*e.b+d*e.d)}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=Md,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const s=$t.shared.setValue(t??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=Md,this._onUpdate())}get tint(){const t=this.localColor;return((t&255)<<16)+(t&65280)+(t>>16&255)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Hv,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=mh,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=mh,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=mh,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var r;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let o=0;o<e.length;++o)e[o].destroy(t);(r=this.renderGroup)==null||r.destroy(),this.renderGroup=null}}kt.mixin(kv);kt.mixin(Dv);kt.mixin(Fv);kt.mixin(Ov);kt.mixin(Rv);kt.mixin(Bv);kt.mixin(Uv);kt.mixin(Mv);class yo extends kt{constructor(){super(...arguments),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=0,this._lastInstructionTick=-1,this._bounds=new pi(0,1,0,0),this._boundsDirty=!0}_updateBounds(){}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:s,y:r}=t;return s>=e.minX&&s<=e.maxX&&r>=e.minY&&r<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._bounds=null}}class Ms extends yo{constructor(t=ft.EMPTY){t instanceof ft&&(t={texture:t});const{texture:e=ft.EMPTY,anchor:s,roundPixels:r,width:o,height:h,...l}=t;super({label:"Sprite",...l}),this.renderPipeId="sprite",this.batched=!0,this._sourceBounds={minX:0,maxX:1,minY:0,maxY:0},this._sourceBoundsDirty=!0,this._anchor=new ge({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=r??!1,o!==void 0&&(this.width=o),h!==void 0&&(this.height=h)}static from(t,e=!1){return t instanceof ft?new Ms(t):new Ms(ft.from(t,e))}set texture(t){t||(t=ft.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get sourceBounds(){return this._sourceBoundsDirty&&(this._updateSourceBounds(),this._sourceBoundsDirty=!1),this._sourceBounds}containsPoint(t){const e=this.sourceBounds;return t.x>=e.maxX&&t.x<=e.minX&&t.y>=e.maxY&&t.y<=e.minY}addBounds(t){const e=this._texture.trim?this.sourceBounds:this.bounds;t.addFrame(e.minX,e.minY,e.maxX,e.maxY)}onViewUpdate(){this._sourceBoundsDirty=this._boundsDirty=!0,super.onViewUpdate()}_updateBounds(){mv(this._bounds,this._anchor,this._texture,0)}_updateSourceBounds(){const t=this._anchor,e=this._texture,s=this._sourceBounds,{width:r,height:o}=e.orig;s.maxX=-t._x*r,s.minX=s.maxX+r,s.maxY=-t._y*o,s.minY=s.maxY+o}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(s)}this._texture=null,this._bounds=null,this._sourceBounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const zv=new pi;function Qf(i,t,e){const s=zv;i.measurable=!0,Yf(i,e,s),t.addBoundsMask(s),i.measurable=!1}function Jf(i,t,e){const s=on.get();i.measurable=!0;const r=Ri.get().identity(),o=tp(i,e,r);qf(i,s,o),i.measurable=!1,t.addBoundsMask(s),Ri.return(r),on.return(s)}function tp(i,t,e){return i?(i!==t&&(tp(i.parent,t,e),i.updateLocalTransform(),e.append(i.localTransform)),e):(Yt("Mask bounds, renderable is not inside the root container"),e)}class ep{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Ms),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||Qf(this.mask,t,e)}addLocalBounds(t,e){Jf(this.mask,t,e)}containsPoint(t,e){const s=this.mask;return e(s,t)}destroy(){this.reset()}static test(t){return t instanceof Ms}}ep.extension=q.MaskEffect;class ip{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}ip.extension=q.MaskEffect;class sp{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){Qf(this.mask,t,e)}addLocalBounds(t,e){Jf(this.mask,t,e)}containsPoint(t,e){const s=this.mask;return e(s,t)}destroy(){this.reset()}static test(t){return t instanceof kt}}sp.extension=q.MaskEffect;const $v={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")};let Td=$v;const Wt={get(){return Td},set(i){Td=i}};class np extends Oi{constructor(t){t.resource||(t.resource=Wt.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity;const e=t.resource;(this.pixelWidth!==e.width||this.pixelWidth!==e.height)&&this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,s=this._resolution){const r=super.resize(t,e,s);return r&&this.resizeCanvas(),r}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}np.extension=q.TextureSource;class hn extends Oi{constructor(t){if(t.resource&&globalThis.HTMLImageElement&&t.resource instanceof HTMLImageElement){const e=Wt.get().createCanvas(t.resource.width,t.resource.height);e.getContext("2d").drawImage(t.resource,0,0,t.resource.width,t.resource.height),t.resource=e,Yt("ImageSource: Image element passed, converting to canvas. Use CanvasSource instead.")}super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}hn.extension=q.TextureSource;var Yh=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(Yh||{});class xh{constructor(t,e=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=s,this._once=r}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const rp=class ke{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new xh(null,null,1/0),this.deltaMS=1/ke.targetFPMS,this.elapsedMS=1/ke.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,s=Yh.NORMAL){return this._addListener(new xh(t,e,s))}addOnce(t,e,s=Yh.NORMAL){return this._addListener(new xh(t,e,s,!0))}_addListener(t){let e=this._head.next,s=this._head;if(!e)t.connect(s);else{for(;e;){if(t.priority>e.priority){t.connect(s);break}s=e,e=e.next}t.previous||t.connect(s)}return this._startIfPossible(),this}remove(t,e){let s=this._head.next;for(;s;)s.match(t,e)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const o=t-this._lastFrame|0;if(o<this._minElapsedMS)return;this._lastFrame=t-o%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ke.targetFPMS;const s=this._head;let r=s.next;for(;r;)r=r.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),s=Math.min(Math.max(0,e)/1e3,ke.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!ke._shared){const t=ke._shared=new ke;t.autoStart=!0,t._protected=!0}return ke._shared}static get system(){if(!ke._system){const t=ke._system=new ke;t.autoStart=!0,t._protected=!0}return ke._system}};rp.targetFPMS=.06;let Qs=rp,yh;async function op(){return yh??(yh=(async()=>{var h;const t=document.createElement("canvas").getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(l=>{const u=document.createElement("video");u.onloadeddata=()=>l(u),u.onerror=()=>l(null),u.autoplay=!1,u.crossOrigin="anonymous",u.preload="auto",u.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",u.load()});if(!e)return"premultiply-alpha-on-upload";const s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const o=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,o),t.deleteFramebuffer(r),t.deleteTexture(s),(h=t.getExtension("WEBGL_lose_context"))==null||h.loseContext(),o[0]<=o[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),yh}const wo=class ap extends Oi{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...ap.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Qs.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await op(),this._load=new Promise((s,r)=>{this.isValid?s(this):(this._resolve=s,this._reject=r,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Qs.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Qs.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Qs.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};wo.extension=q.TextureSource;wo.defaultOptions={...Oi.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};wo.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let ho=wo;const ei=(i,t,e=!1)=>(Array.isArray(i)||(i=[i]),t?i.map(s=>typeof s=="string"||e?t(s):s):i);class Yv{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||Yt(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=ei(t);let r;for(let u=0;u<this.parsers.length;u++){const d=this.parsers[u];if(d.test(e)){r=d.getCacheableAssets(s,e);break}}const o=new Map(Object.entries(r||{}));r||s.forEach(u=>{o.set(u,e)});const h=[...o.keys()],l={cacheKeys:h,keys:s};s.forEach(u=>{this._cacheMap.set(u,l)}),h.forEach(u=>{const d=r?r[u]:e;this._cache.has(u)&&this._cache.get(u)!==d&&Yt("[Cache] already has key:",u),this._cache.set(u,o.get(u))})}remove(t){if(!this._cacheMap.has(t)){Yt(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Vt=new Yv,Xh=[];_e.handleByList(q.TextureSource,Xh);function hp(i={}){const t=i&&i.resource,e=t?i.resource:i,s=t?i:{resource:i};for(let r=0;r<Xh.length;r++){const o=Xh[r];if(o.test(e))return new o(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function Xv(i={},t=!1){const e=i&&i.resource,s=e?i.resource:i,r=e?i:{resource:i};if(!t&&Vt.has(s))return Vt.get(s);const o=new ft({source:hp(r)});return o.on("destroy",()=>{Vt.has(s)&&Vt.remove(s)}),t||Vt.set(s,o),o}function qv(i,t=!1){return typeof i=="string"?Vt.get(i):i instanceof Oi?new ft({source:i}):Xv(i,t)}ft.from=qv;Oi.from=hp;_e.add(ep,ip,sp,ho,hn,np,wl);var ns=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(ns||{});function Qe(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function kn(i){return i.split("?")[0].split("#")[0]}function jv(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Kv(i,t,e){return i.replace(new RegExp(jv(t),"g"),e)}function Zv(i,t){let e="",s=0,r=-1,o=0,h=-1;for(let l=0;l<=i.length;++l){if(l<i.length)h=i.charCodeAt(l);else{if(h===47)break;h=47}if(h===47){if(!(r===l-1||o===1))if(r!==l-1&&o===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const u=e.lastIndexOf("/");if(u!==e.length-1){u===-1?(e="",s=0):(e=e.slice(0,u),s=e.length-1-e.lastIndexOf("/")),r=l,o=0;continue}}else if(e.length===2||e.length===1){e="",s=0,r=l,o=0;continue}}}else e.length>0?e+=`/${i.slice(r+1,l)}`:e=i.slice(r+1,l),s=l-r-1;r=l,o=0}else h===46&&o!==-1?++o:o=-1}return e}const Re={toPosix(i){return Kv(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},isBlobUrl(i){return i.startsWith("blob:")},hasProtocol(i){return/^[^/:]+:/.test(this.toPosix(i))},getProtocol(i){Qe(i),i=this.toPosix(i);const t=/^file:\/\/\//.exec(i);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(i);return e?e[0]:""},toAbsolute(i,t,e){if(Qe(i),this.isDataUrl(i)||this.isBlobUrl(i))return i;const s=kn(this.toPosix(t??Wt.get().getBaseUrl())),r=kn(this.toPosix(e??this.rootname(s)));return i=this.toPosix(i),i.startsWith("/")?Re.join(r,i.slice(1)):this.isAbsolute(i)?i:this.join(s,i)},normalize(i){if(Qe(i),i.length===0)return".";if(this.isDataUrl(i)||this.isBlobUrl(i))return i;i=this.toPosix(i);let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const s=i.endsWith("/");return i=Zv(i),i.length>0&&s&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return Qe(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const s=i[e];if(Qe(s),s.length>0)if(t===void 0)t=s;else{const r=i[e-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(Qe(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let s=-1,r=!0;const o=this.getProtocol(i),h=i;i=i.slice(o.length);for(let l=i.length-1;l>=1;--l)if(t=i.charCodeAt(l),t===47){if(!r){s=l;break}}else r=!1;return s===-1?e?"/":this.isUrl(h)?o+i:o:e&&s===1?"//":o+i.slice(0,s)},rootname(i){Qe(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){Qe(i),t&&Qe(t),i=kn(this.toPosix(i));let e=0,s=-1,r=!0,o;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let h=t.length-1,l=-1;for(o=i.length-1;o>=0;--o){const u=i.charCodeAt(o);if(u===47){if(!r){e=o+1;break}}else l===-1&&(r=!1,l=o+1),h>=0&&(u===t.charCodeAt(h)?--h===-1&&(s=o):(h=-1,s=l))}return e===s?s=l:s===-1&&(s=i.length),i.slice(e,s)}for(o=i.length-1;o>=0;--o)if(i.charCodeAt(o)===47){if(!r){e=o+1;break}}else s===-1&&(r=!1,s=o+1);return s===-1?"":i.slice(e,s)},extname(i){Qe(i),i=kn(this.toPosix(i));let t=-1,e=0,s=-1,r=!0,o=0;for(let h=i.length-1;h>=0;--h){const l=i.charCodeAt(h);if(l===47){if(!r){e=h+1;break}continue}s===-1&&(r=!1,s=h+1),l===46?t===-1?t=h:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||s===-1||o===0||o===1&&t===s-1&&t===e+1?"":i.slice(t,s)},parse(i){Qe(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=kn(this.toPosix(i));let e=i.charCodeAt(0);const s=this.isAbsolute(i);let r;t.root=this.rootname(i),s||this.hasProtocol(i)?r=1:r=0;let o=-1,h=0,l=-1,u=!0,d=i.length-1,f=0;for(;d>=r;--d){if(e=i.charCodeAt(d),e===47){if(!u){h=d+1;break}continue}l===-1&&(u=!1,l=d+1),e===46?o===-1?o=d:f!==1&&(f=1):o!==-1&&(f=-1)}return o===-1||l===-1||f===0||f===1&&o===l-1&&o===h+1?l!==-1&&(h===0&&s?t.base=t.name=i.slice(1,l):t.base=t.name=i.slice(h,l)):(h===0&&s?(t.name=i.slice(1,o),t.base=i.slice(1,l)):(t.name=i.slice(h,o),t.base=i.slice(h,l)),t.ext=i.slice(o,l)),t.dir=this.dirname(i),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function lp(i,t,e,s,r){const o=t[e];for(let h=0;h<o.length;h++){const l=o[h];e<t.length-1?lp(i.replace(s[e],l),t,e+1,s,r):r.push(i.replace(s[e],l))}}function Qv(i){const t=/\{(.*?)\}/g,e=i.match(t),s=[];if(e){const r=[];e.forEach(o=>{const h=o.substring(1,o.length-1).split(",");r.push(h)}),lp(i,r,0,e,s)}else s.push(i);return s}const _o=i=>!Array.isArray(i);class ln{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}getAlias(t){const{alias:e,src:s}=t;return ei(e||s,o=>typeof o=="string"?o:Array.isArray(o)?o.map(h=>(h==null?void 0:h.src)??h):o!=null&&o.src?o.src:o,!0)}addManifest(t){this._manifest&&Yt("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];let r=e;Array.isArray(e)||(r=Object.entries(e).map(([o,h])=>typeof h=="string"||Array.isArray(h)?{alias:o,src:h}:{alias:o,...h})),r.forEach(o=>{const h=o.src,l=o.alias;let u;if(typeof l=="string"){const d=this._createBundleAssetId(t,l);s.push(d),u=[l,d]}else{const d=l.map(f=>this._createBundleAssetId(t,f));s.push(...d),u=[...l,...d]}this.add({...o,alias:u,src:h})}),this._bundles[t]=s}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let s;s=o=>{this.hasKey(o)&&Yt(`[Resolver] already has key: ${o} overwriting`)},ei(e).forEach(o=>{const{src:h}=o;let{data:l,format:u,loadParser:d}=o;const f=ei(h).map(y=>typeof y=="string"?Qv(y):Array.isArray(y)?y:[y]),g=this.getAlias(o);Array.isArray(g)?g.forEach(s):s(g);const m=[];f.forEach(y=>{y.forEach(b=>{let S={};if(typeof b!="object"){S.src=b;for(let v=0;v<this._parsers.length;v++){const M=this._parsers[v];if(M.test(b)){S=M.parse(b);break}}}else l=b.data??l,u=b.format??u,d=b.loadParser??d,S={...S,...b};if(!g)throw new Error(`[Resolver] alias is undefined for this asset: ${S.src}`);S=this._buildResolvedAsset(S,{aliases:g,data:l,format:u,loadParser:d}),m.push(S)})}),g.forEach(y=>{this._assetMap[y]=m})})}resolveBundle(t){const e=_o(t);t=ei(t);const s={};return t.forEach(r=>{const o=this._bundles[r];if(o){const h=this.resolve(o),l={};for(const u in h){const d=h[u];l[this._extractAssetIdFromBundle(r,u)]=d}s[r]=l}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const r in e)s[r]=e[r].src;return s}return e.src}resolve(t){const e=_o(t);t=ei(t);const s={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let o=this._assetMap[r];const h=this._getPreferredOrder(o);h==null||h.priority.forEach(l=>{h.params[l].forEach(u=>{const d=o.filter(f=>f[l]?f[l]===u:!1);d.length&&(o=d)})}),this._resolverHash[r]=o[0]}else this._resolverHash[r]=this._buildResolvedAsset({alias:[r],src:r},{});s[r]=this._resolverHash[r]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[0],r=this._preferredOrder.find(o=>o.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:s,data:r,loadParser:o,format:h}=e;return(this._basePath||this._rootPath)&&(t.src=Re.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=s??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=o??t.loadParser,t.format=h??t.format??Jv(t.src),t}}ln.RETINA_PREFIX=/@([0-9\.]+)x/;function Jv(i){return i.split(".").pop().split("?").shift().split("#").shift()}const qh=(i,t)=>{const e=t.split("?")[1];return e&&(i+=`?${e}`),i},cp=class Fn{constructor(t,e){this.linkedSheets=[],this._texture=t instanceof ft?t:null,this.textureSource=t.source,this.textures={},this.animations={},this.data=e;const s=parseFloat(e.meta.scale);s?(this.resolution=s,t.source.resolution=this.resolution):this.resolution=t.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=Fn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const s=Fn.BATCH_SIZE;for(;e-t<s&&e<this._frameKeys.length;){const r=this._frameKeys[e],o=this._frames[r],h=o.frame;if(h){let l=null,u=null;const d=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,f=new ie(0,0,Math.floor(d.w)/this.resolution,Math.floor(d.h)/this.resolution);o.rotated?l=new ie(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.h)/this.resolution,Math.floor(h.w)/this.resolution):l=new ie(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(u=new ie(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution)),this.textures[r]=new ft({source:this.textureSource,frame:l,orig:f,trim:u,rotate:o.rotated?2:0,defaultAnchor:o.anchor,defaultBorders:o.borders,label:r.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let s=0;s<t[e].length;s++){const r=t[e][s];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Fn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Fn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};cp.BATCH_SIZE=1e3;let Id=cp;const t1=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function up(i,t,e){const s={};if(i.forEach(r=>{s[r]=t}),Object.keys(t.textures).forEach(r=>{s[r]=t.textures[r]}),!e){const r=Re.dirname(i[0]);t.linkedSheets.forEach((o,h)=>{const l=up([`${r}/${t.data.meta.related_multi_packs[h]}`],o,!0);Object.assign(s,l)})}return s}const e1={extension:q.Asset,cache:{test:i=>i instanceof Id,getCacheableAssets:(i,t)=>up(i,t,!1)},resolver:{extension:{type:q.ResolveParser,name:"resolveSpritesheet"},test:i=>{const e=i.split("?")[0].split("."),s=e.pop(),r=e.pop();return s==="json"&&t1.includes(r)},parse:i=>{var e;const t=i.split(".");return{resolution:parseFloat(((e=ln.RETINA_PREFIX.exec(i))==null?void 0:e[1])??"1"),format:t[t.length-2],src:i}}},loader:{name:"spritesheetLoader",extension:{type:q.LoadParser,priority:ns.Normal,name:"spritesheetLoader"},async testParse(i,t){return Re.extname(t.src).toLowerCase()===".json"&&!!i.frames},async parse(i,t,e){var d,f;const{texture:s,imageFilename:r}=(t==null?void 0:t.data)??{};let o=Re.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let h;if(s instanceof ft)h=s;else{const g=qh(o+(r??i.meta.image),t.src);h=(await e.load([g]))[g]}const l=new Id(h.source,i);await l.parse();const u=(d=i==null?void 0:i.meta)==null?void 0:d.related_multi_packs;if(Array.isArray(u)){const g=[];for(const y of u){if(typeof y!="string")continue;let b=o+y;(f=t.data)!=null&&f.ignoreMultiPack||(b=qh(b,t.src),g.push(e.load({src:b,data:{ignoreMultiPack:!0}})))}const m=await Promise.all(g);l.linkedSheets=m,m.forEach(y=>{y.linkedSheets=[l].concat(l.linkedSheets.filter(b=>b!==y))})}return l},async unload(i,t,e){await e.unload(i.textureSource._sourceOrigin),i.destroy(!1)}}};_e.add(e1);var wh=/iPhone/i,kd=/iPod/i,Ed=/iPad/i,Rd=/\biOS-universal(?:.+)Mac\b/i,bh=/\bAndroid(?:.+)Mobile\b/i,Bd=/Android/i,Ys=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Kr=/Silk/i,Ti=/Windows Phone/i,Ld=/\bWindows(?:.+)ARM\b/i,Od=/BlackBerry/i,Fd=/BB10/i,Ud=/Opera Mini/i,Vd=/\b(CriOS|Chrome)(?:.+)Mobile/i,Dd=/Mobile(?:.+)Firefox\b/i,Wd=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function i1(i){return function(t){return t.test(i)}}function Nd(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,s=e.split("[FBAN");typeof s[1]<"u"&&(e=s[0]),s=e.split("Twitter"),typeof s[1]<"u"&&(e=s[0]);var r=i1(e),o={apple:{phone:r(wh)&&!r(Ti),ipod:r(kd),tablet:!r(wh)&&(r(Ed)||Wd(t))&&!r(Ti),universal:r(Rd),device:(r(wh)||r(kd)||r(Ed)||r(Rd)||Wd(t))&&!r(Ti)},amazon:{phone:r(Ys),tablet:!r(Ys)&&r(Kr),device:r(Ys)||r(Kr)},android:{phone:!r(Ti)&&r(Ys)||!r(Ti)&&r(bh),tablet:!r(Ti)&&!r(Ys)&&!r(bh)&&(r(Kr)||r(Bd)),device:!r(Ti)&&(r(Ys)||r(Kr)||r(bh)||r(Bd))||r(/\bokhttp\b/i)},windows:{phone:r(Ti),tablet:r(Ld),device:r(Ti)||r(Ld)},other:{blackberry:r(Od),blackberry10:r(Fd),opera:r(Ud),firefox:r(Dd),chrome:r(Vd),device:r(Od)||r(Fd)||r(Ud)||r(Dd)||r(Vd)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const s1=Nd.default??Nd,Cs=s1(globalThis.navigator),vh=Object.create(null),Gd=Object.create(null);function vl(i,t){let e=Gd[i];return e===void 0&&(vh[t]===void 0&&(vh[t]=1),Gd[i]=e=vh[t]++),e}let Xs;function dp(){return(!Xs||Xs!=null&&Xs.isContextLost())&&(Xs=Wt.get().createCanvas().getContext("webgl",{})),Xs}let Zr;function n1(){if(!Zr){Zr="mediump";const i=dp();i&&i.getShaderPrecisionFormat&&(Zr=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?"highp":"mediump")}return Zr}function r1(i,t,e){return t?i:e?(i=i.replace("out vec4 finalColor;",""),`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${i}
        `):`
        
        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${i}
        `}function o1(i,t,e){const s=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(i.substring(0,9)!=="precision"){let r=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return r==="highp"&&s!=="highp"&&(r="mediump"),`precision ${r} float;
${i}`}else if(s!=="highp"&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}function a1(i,t){return t?`#version 300 es
${i}`:i}const h1={},l1={};function c1(i,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const s=e?h1:l1;return s[t]?(s[t]++,t+=`-${s[t]}`):s[t]=1,i.indexOf("#define SHADER_NAME")!==-1?i:`${`#define SHADER_NAME ${t}`}
${i}`}function u1(i,t){return t?i.replace("#version 300 es",""):i}const Ah={stripVersion:u1,ensurePrecision:o1,addProgramDefines:r1,setProgramName:c1,insertVersion:a1},Sh=Object.create(null),fp=class jh{constructor(t){t={...jh.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:n1()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let r=t.fragment,o=t.vertex;Object.keys(Ah).forEach(h=>{const l=s[h];r=Ah[h](r,l,!0),o=Ah[h](o,l,!1)}),this.fragment=r,this.vertex=o,this._key=vl(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return Sh[e]||(Sh[e]=new jh(t)),Sh[e]}};fp.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let pp=fp;const Hd={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function d1(i){return Hd[i]??Hd.float32}const f1={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function p1({source:i,entryPoint:t}){const e={},s=i.indexOf(`fn ${t}`);if(s!==-1){const r=i.indexOf("->",s);if(r!==-1){const o=i.substring(s,r),h=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let l;for(;(l=h.exec(o))!==null;){const u=f1[l[3]]??"float32";e[l[2]]={location:parseInt(l[1],10),format:u,stride:d1(u).stride,offset:0,instance:!1,start:0}}}}return e}function Ch(i){var g,m;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,r=/var(<[^>]+>)? (\w+)/,o=/:\s*(\w+)/,h=/struct\s+(\w+)\s*{([^}]+)}/g,l=/(\w+)\s*:\s*([\w\<\>]+)/g,u=/struct\s+(\w+)/,d=(g=i.match(t))==null?void 0:g.map(y=>({group:parseInt(y.match(e)[1],10),binding:parseInt(y.match(s)[1],10),name:y.match(r)[2],isUniform:y.match(r)[1]==="<uniform>",type:y.match(o)[1]}));if(!d)return{groups:[],structs:[]};const f=((m=i.match(h))==null?void 0:m.map(y=>{const b=y.match(u)[1],S=y.match(l).reduce((v,M)=>{const[k,I]=M.split(":");return v[k.trim()]=I.trim(),v},{});return S?{name:b,members:S}:null}).filter(({name:y})=>d.some(b=>b.type===y)))??[];return{groups:d,structs:f}}var Un=(i=>(i[i.VERTEX=1]="VERTEX",i[i.FRAGMENT=2]="FRAGMENT",i[i.COMPUTE=4]="COMPUTE",i))(Un||{});function g1({groups:i}){const t=[];for(let e=0;e<i.length;e++){const s=i[e];t[s.group]||(t[s.group]=[]),s.isUniform?t[s.group].push({binding:s.binding,visibility:Un.VERTEX|Un.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?t[s.group].push({binding:s.binding,visibility:Un.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&t[s.group].push({binding:s.binding,visibility:Un.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function _1({groups:i}){const t=[];for(let e=0;e<i.length;e++){const s=i[e];t[s.group]||(t[s.group]={}),t[s.group][s.name]=s.binding}return t}function m1(i,t){const e=new Set,s=new Set,r=[...i.structs,...t.structs].filter(h=>e.has(h.name)?!1:(e.add(h.name),!0)),o=[...i.groups,...t.groups].filter(h=>{const l=`${h.name}-${h.binding}`;return s.has(l)?!1:(s.add(l),!0)});return{structs:r,groups:o}}const Ph=Object.create(null);class bo{constructor(t){var l,u;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:s,layout:r,gpuLayout:o,name:h}=t;if(this.name=h,this.fragment=e,this.vertex=s,e.source===s.source){const d=Ch(e.source);this.structsAndGroups=d}else{const d=Ch(s.source),f=Ch(e.source);this.structsAndGroups=m1(d,f)}this.layout=r??_1(this.structsAndGroups),this.gpuLayout=o??g1(this.structsAndGroups),this.autoAssignGlobalUniforms=((l=this.layout[0])==null?void 0:l.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((u=this.layout[1])==null?void 0:u.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,s=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=vl(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=p1(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return Ph[e]||(Ph[e]=new bo(t)),Ph[e]}}const gp=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>"],x1=gp.reduce((i,t)=>(i[t]=!0,i),{});function y1(i,t){switch(i){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const _p=class mp{constructor(t,e){this._touched=0,this.uid=Qt("uniform"),this._resourceType="uniformGroup",this._resourceId=Qt("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...mp.defaultOptions,...e},this.uniformStructures=t;const s={};for(const r in t){const o=t[r];if(o.name=r,o.size=o.size??1,!x1[o.type])throw new Error(`Uniform type ${o.type} is not supported. Supported uniform types are: ${gp.join(", ")}`);o.value??(o.value=y1(o.type,o.size)),s[r]=o.value}this.uniforms=s,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=vl(Object.keys(s).map(r=>`${r}-${t[r].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};_p.defaultOptions={ubo:!1,isStatic:!1};let xp=_p;class lo{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const s in t){const r=t[s];this.setResource(r,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const s in this.resources)t[e++]=this.resources[s]._resourceId;this._key=t.join("|")}setResource(t,e){var r,o;const s=this.resources[e];t!==s&&(s&&((r=t.off)==null||r.call(t,"change",this.onResourceChange,this)),(o=t.on)==null||o.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const s in e)e[s]._touched=t}destroy(){var e;const t=this.resources;for(const s in t){const r=t[s];(e=r.off)==null||e.call(r,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const s in e)e[s]===t&&(e[s]=null)}else this._updateKey()}}var Kh=(i=>(i[i.WEBGL=1]="WEBGL",i[i.WEBGPU=2]="WEBGPU",i[i.BOTH=3]="BOTH",i))(Kh||{});class Al extends ii{constructor(t){super(),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:e,glProgram:s,groups:r,resources:o,compatibleRenderers:h,groupMap:l}=t;this.gpuProgram=e,this.glProgram=s,h===void 0&&(h=0,e&&(h|=Kh.WEBGPU),s&&(h|=Kh.WEBGL)),this.compatibleRenderers=h;const u={};if(!o&&!r&&(o={}),o&&r)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&r&&!l)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&r&&l)for(const d in l)for(const f in l[d]){const g=l[d][f];u[g]={group:d,binding:f,name:g}}else if(e&&r&&!l){const d=e.structsAndGroups.groups;l={},d.forEach(f=>{l[f.group]=l[f.group]||{},l[f.group][f.binding]=f.name,u[f.name]=f})}else if(o){r={},l={},e&&e.structsAndGroups.groups.forEach(g=>{l[g.group]=l[g.group]||{},l[g.group][g.binding]=g.name,u[g.name]=g});let d=0;for(const f in o)u[f]||(r[99]||(r[99]=new lo,this._ownedBindGroups.push(r[99])),u[f]={group:99,binding:d,name:f},l[99]=l[99]||{},l[99][d]=f,d++);for(const f in o){const g=f;let m=o[f];!m.source&&!m._resourceType&&(m=new xp(m));const y=u[g];y&&(r[y.group]||(r[y.group]=new lo,this._ownedBindGroups.push(r[y.group])),r[y.group].setResource(m,y.binding))}}this.groups=r,this._uniformBindMap=l,this.resources=this._buildResourceAccessor(r,u)}addResource(t,e,s){var r,o;(r=this._uniformBindMap)[e]||(r[e]={}),(o=this._uniformBindMap[e])[s]||(o[s]=t),this.groups[e]||(this.groups[e]=new lo,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const s={};for(const r in e){const o=e[r];Object.defineProperty(s,o.name,{get(){return t[o.group].getResource(o.binding)},set(h){t[o.group].setResource(h,o.binding)}})}return s}destroy(t=!1){var e,s;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(s=this.glProgram)==null||s.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(r=>{r.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(t){const{gpu:e,gl:s,...r}=t;let o,h;return e&&(o=bo.from(e)),s&&(h=pp.from(s)),new Al({gpuProgram:o,glProgram:h,...r})}}const Zh=[];_e.handleByNamedList(q.Environment,Zh);async function w1(i){if(!i)for(let t=0;t<Zh.length;t++){const e=Zh[t];if(e.value.test()){await e.value.load();return}}}let En;function b1(){if(typeof En=="boolean")return En;try{En=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{En=!1}return En}var Sl={exports:{}};Sl.exports=vo;Sl.exports.default=vo;function vo(i,t,e){e=e||2;var s=t&&t.length,r=s?t[0]*e:i.length,o=yp(i,0,r,e,!0),h=[];if(!o||o.next===o.prev)return h;var l,u,d,f,g,m,y;if(s&&(o=P1(i,t,o,e)),i.length>80*e){l=d=i[0],u=f=i[1];for(var b=e;b<r;b+=e)g=i[b],m=i[b+1],g<l&&(l=g),m<u&&(u=m),g>d&&(d=g),m>f&&(f=m);y=Math.max(d-l,f-u),y=y!==0?32767/y:0}return Xn(o,h,e,l,u,y,0),h}function yp(i,t,e,s,r){var o,h;if(r===tl(i,t,e,s)>0)for(o=t;o<e;o+=s)h=zd(o,i[o],i[o+1],h);else for(o=e-s;o>=t;o-=s)h=zd(o,i[o],i[o+1],h);return h&&Ao(h,h.next)&&(jn(h),h=h.next),h}function Ts(i,t){if(!i)return i;t||(t=i);var e=i,s;do if(s=!1,!e.steiner&&(Ao(e,e.next)||Ot(e.prev,e,e.next)===0)){if(jn(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function Xn(i,t,e,s,r,o,h){if(i){!h&&o&&E1(i,s,r,o);for(var l=i,u,d;i.prev!==i.next;){if(u=i.prev,d=i.next,o?A1(i,s,r,o):v1(i)){t.push(u.i/e|0),t.push(i.i/e|0),t.push(d.i/e|0),jn(i),i=d.next,l=d.next;continue}if(i=d,i===l){h?h===1?(i=S1(Ts(i),t,e),Xn(i,t,e,s,r,o,2)):h===2&&C1(i,t,e,s,r,o):Xn(Ts(i),t,e,s,r,o,1);break}}}}function v1(i){var t=i.prev,e=i,s=i.next;if(Ot(t,e,s)>=0)return!1;for(var r=t.x,o=e.x,h=s.x,l=t.y,u=e.y,d=s.y,f=r<o?r<h?r:h:o<h?o:h,g=l<u?l<d?l:d:u<d?u:d,m=r>o?r>h?r:h:o>h?o:h,y=l>u?l>d?l:d:u>d?u:d,b=s.next;b!==t;){if(b.x>=f&&b.x<=m&&b.y>=g&&b.y<=y&&Js(r,l,o,u,h,d,b.x,b.y)&&Ot(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function A1(i,t,e,s){var r=i.prev,o=i,h=i.next;if(Ot(r,o,h)>=0)return!1;for(var l=r.x,u=o.x,d=h.x,f=r.y,g=o.y,m=h.y,y=l<u?l<d?l:d:u<d?u:d,b=f<g?f<m?f:m:g<m?g:m,S=l>u?l>d?l:d:u>d?u:d,v=f>g?f>m?f:m:g>m?g:m,M=Qh(y,b,t,e,s),k=Qh(S,v,t,e,s),I=i.prevZ,R=i.nextZ;I&&I.z>=M&&R&&R.z<=k;){if(I.x>=y&&I.x<=S&&I.y>=b&&I.y<=v&&I!==r&&I!==h&&Js(l,f,u,g,d,m,I.x,I.y)&&Ot(I.prev,I,I.next)>=0||(I=I.prevZ,R.x>=y&&R.x<=S&&R.y>=b&&R.y<=v&&R!==r&&R!==h&&Js(l,f,u,g,d,m,R.x,R.y)&&Ot(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;I&&I.z>=M;){if(I.x>=y&&I.x<=S&&I.y>=b&&I.y<=v&&I!==r&&I!==h&&Js(l,f,u,g,d,m,I.x,I.y)&&Ot(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;R&&R.z<=k;){if(R.x>=y&&R.x<=S&&R.y>=b&&R.y<=v&&R!==r&&R!==h&&Js(l,f,u,g,d,m,R.x,R.y)&&Ot(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function S1(i,t,e){var s=i;do{var r=s.prev,o=s.next.next;!Ao(r,o)&&wp(r,s,s.next,o)&&qn(r,o)&&qn(o,r)&&(t.push(r.i/e|0),t.push(s.i/e|0),t.push(o.i/e|0),jn(s),jn(s.next),s=i=o),s=s.next}while(s!==i);return Ts(s)}function C1(i,t,e,s,r,o){var h=i;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&L1(h,l)){var u=bp(h,l);h=Ts(h,h.next),u=Ts(u,u.next),Xn(h,t,e,s,r,o,0),Xn(u,t,e,s,r,o,0);return}l=l.next}h=h.next}while(h!==i)}function P1(i,t,e,s){var r=[],o,h,l,u,d;for(o=0,h=t.length;o<h;o++)l=t[o]*s,u=o<h-1?t[o+1]*s:i.length,d=yp(i,l,u,s,!1),d===d.next&&(d.steiner=!0),r.push(B1(d));for(r.sort(M1),o=0;o<r.length;o++)e=T1(r[o],e);return e}function M1(i,t){return i.x-t.x}function T1(i,t){var e=I1(i,t);if(!e)return t;var s=bp(e,i);return Ts(s,s.next),Ts(e,e.next)}function I1(i,t){var e=t,s=i.x,r=i.y,o=-1/0,h;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var l=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(l<=s&&l>o&&(o=l,h=e.x<e.next.x?e:e.next,l===s))return h}e=e.next}while(e!==t);if(!h)return null;var u=h,d=h.x,f=h.y,g=1/0,m;e=h;do s>=e.x&&e.x>=d&&s!==e.x&&Js(r<f?s:o,r,d,f,r<f?o:s,r,e.x,e.y)&&(m=Math.abs(r-e.y)/(s-e.x),qn(e,i)&&(m<g||m===g&&(e.x>h.x||e.x===h.x&&k1(h,e)))&&(h=e,g=m)),e=e.next;while(e!==u);return h}function k1(i,t){return Ot(i.prev,i,t.prev)<0&&Ot(t.next,i,i.next)<0}function E1(i,t,e,s){var r=i;do r.z===0&&(r.z=Qh(r.x,r.y,t,e,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,R1(r)}function R1(i){var t,e,s,r,o,h,l,u,d=1;do{for(e=i,i=null,o=null,h=0;e;){for(h++,s=e,l=0,t=0;t<d&&(l++,s=s.nextZ,!!s);t++);for(u=d;l>0||u>0&&s;)l!==0&&(u===0||!s||e.z<=s.z)?(r=e,e=e.nextZ,l--):(r=s,s=s.nextZ,u--),o?o.nextZ=r:i=r,r.prevZ=o,o=r;e=s}o.nextZ=null,d*=2}while(h>1);return i}function Qh(i,t,e,s,r){return i=(i-e)*r|0,t=(t-s)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function B1(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Js(i,t,e,s,r,o,h,l){return(r-h)*(t-l)>=(i-h)*(o-l)&&(i-h)*(s-l)>=(e-h)*(t-l)&&(e-h)*(o-l)>=(r-h)*(s-l)}function L1(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!O1(i,t)&&(qn(i,t)&&qn(t,i)&&F1(i,t)&&(Ot(i.prev,i,t.prev)||Ot(i,t.prev,t))||Ao(i,t)&&Ot(i.prev,i,i.next)>0&&Ot(t.prev,t,t.next)>0)}function Ot(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function Ao(i,t){return i.x===t.x&&i.y===t.y}function wp(i,t,e,s){var r=Jr(Ot(i,t,e)),o=Jr(Ot(i,t,s)),h=Jr(Ot(e,s,i)),l=Jr(Ot(e,s,t));return!!(r!==o&&h!==l||r===0&&Qr(i,e,t)||o===0&&Qr(i,s,t)||h===0&&Qr(e,i,s)||l===0&&Qr(e,t,s))}function Qr(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function Jr(i){return i>0?1:i<0?-1:0}function O1(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&wp(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function qn(i,t){return Ot(i.prev,i,i.next)<0?Ot(i,t,i.next)>=0&&Ot(i,i.prev,t)>=0:Ot(i,t,i.prev)<0||Ot(i,i.next,t)<0}function F1(i,t){var e=i,s=!1,r=(i.x+t.x)/2,o=(i.y+t.y)/2;do e.y>o!=e.next.y>o&&e.next.y!==e.y&&r<(e.next.x-e.x)*(o-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==i);return s}function bp(i,t){var e=new Jh(i.i,i.x,i.y),s=new Jh(t.i,t.x,t.y),r=i.next,o=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,s.next=e,e.prev=s,o.next=s,s.prev=o,s}function zd(i,t,e,s){var r=new Jh(i,t,e);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function jn(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Jh(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}vo.deviation=function(i,t,e,s){var r=t&&t.length,o=r?t[0]*e:i.length,h=Math.abs(tl(i,0,o,e));if(r)for(var l=0,u=t.length;l<u;l++){var d=t[l]*e,f=l<u-1?t[l+1]*e:i.length;h-=Math.abs(tl(i,d,f,e))}var g=0;for(l=0;l<s.length;l+=3){var m=s[l]*e,y=s[l+1]*e,b=s[l+2]*e;g+=Math.abs((i[m]-i[b])*(i[y+1]-i[m+1])-(i[m]-i[y])*(i[b+1]-i[m+1]))}return h===0&&g===0?0:Math.abs((g-h)/h)};function tl(i,t,e,s){for(var r=0,o=t,h=e-s;o<e;o+=s)r+=(i[h]-i[o])*(i[o+1]+i[h+1]),h=o;return r}vo.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},s=0,r=0;r<i.length;r++){for(var o=0;o<i[r].length;o++)for(var h=0;h<t;h++)e.vertices.push(i[r][o][h]);r>0&&(s+=i[r-1].length,e.holes.push(s))}return e};var U1=Sl.exports;const V1=yl(U1);var vp=(i=>(i[i.NONE=0]="NONE",i[i.COLOR=16384]="COLOR",i[i.STENCIL=1024]="STENCIL",i[i.DEPTH=256]="DEPTH",i[i.COLOR_DEPTH=16640]="COLOR_DEPTH",i[i.COLOR_STENCIL=17408]="COLOR_STENCIL",i[i.DEPTH_STENCIL=1280]="DEPTH_STENCIL",i[i.ALL=17664]="ALL",i))(vp||{});class D1{constructor(t){this.items=[],this._name=t}emit(t,e,s,r,o,h,l,u){const{name:d,items:f}=this;for(let g=0,m=f.length;g<m;g++)f[g][d](t,e,s,r,o,h,l,u);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const W1=["init","destroy","contextChange","resolutionChange","reset","renderEnd","renderStart","render","update","postrender","prerender"],Ap=class Sp extends ii{constructor(t){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...W1,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await w1(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const s in this._systemsHash)t={...this._systemsHash[s].constructor.defaultOptions,...t};t={...Sp.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let s=0;s<this.runners.init.items.length;s++)await this.runners.init.items[s].init(t);this._initOptions=t}render(t,e){let s=t;if(s instanceof kt&&(s={container:s},e&&(gt(xt,"passing a second argument is deprecated, please use render options instead"),s.target=e.renderTexture)),s.target||(s.target=this.view.renderTarget),s.target===this.view.renderTarget&&(this._lastObjectRendered=s.container,s.clearColor=this.background.colorRgba),s.clearColor){const r=Array.isArray(s.clearColor)&&s.clearColor.length===4;s.clearColor=r?s.clearColor:$t.shared.setValue(s.clearColor).toArray()}s.transform||(s.container.updateLocalTransform(),s.transform=s.container.localTransform),this.runners.prerender.emit(s),this.runners.renderStart.emit(s),this.runners.render.emit(s),this.runners.renderEnd.emit(s),this.runners.postrender.emit(s)}resize(t,e,s){const r=this.view.resolution;this.view.resize(t,e,s),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),s!==void 0&&s!==r&&this.runners.resolutionChange.emit(s)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=vp.ALL);const{clear:s,clearColor:r,target:o}=t;$t.shared.setValue(r??this.background.colorRgba),e.renderTarget.clear(o,s,$t.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new D1(e)})}_addSystems(t){let e;for(e in t){const s=t[e];this._addSystem(s.value,s.name)}}_addSystem(t,e){const s=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=s,this._systemsHash[e]=s;for(const r in this.runners)this.runners[r].add(s);return this}_addPipes(t,e){const s=e.reduce((r,o)=>(r[o.name]=o.value,r),{});t.forEach(r=>{const o=r.value,h=r.name,l=s[h];this.renderPipes[h]=new o(this,l?new l:null)})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!b1())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}};Ap.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Cp=Ap,to;function N1(i){return to!==void 0||(to=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:i??Cp.defaultOptions.failIfMajorPerformanceCaveat};try{if(!Wt.get().getWebGLRenderingContext())return!1;let r=Wt.get().createCanvas().getContext("webgl",t);const o=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const h=r.getExtension("WEBGL_lose_context");h&&h.loseContext()}return r=null,o}catch{return!1}})()),to}let eo;async function G1(i={}){return eo!==void 0||(eo=await(async()=>{const t=Wt.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(i)).requestDevice(),!0}catch{return!1}})()),eo}const $d=["webgl","webgpu","canvas"];async function H1(i){let t=[];i.preference?(t.push(i.preference),$d.forEach(o=>{o!==i.preference&&t.push(o)})):t=$d.slice();let e,s={};for(let o=0;o<t.length;o++){const h=t[o];if(h==="webgpu"&&await G1()){const{WebGPURenderer:l}=await po(async()=>{const{WebGPURenderer:u}=await import("./WebGPURenderer-C_2d22ZB.js");return{WebGPURenderer:u}},__vite__mapDeps([3,2,4]));e=l,s={...i,...i.webgpu};break}else if(h==="webgl"&&N1(i.failIfMajorPerformanceCaveat??Cp.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:l}=await po(async()=>{const{WebGLRenderer:u}=await import("./WebGLRenderer-D87XONwH.js");return{WebGLRenderer:u}},__vite__mapDeps([5,2,4]));e=l,s={...i,...i.webgl};break}else if(h==="canvas")throw s={...i},new Error("CanvasRenderer is not yet implemented")}if(delete s.webgpu,delete s.webgl,!e)throw new Error("No available renderer for the current environment");const r=new e;return await r.init(s),r}const Pp="8.5.2";class Mp{static init(){var t;(t=globalThis.__PIXI_APP_INIT__)==null||t.call(globalThis,this,Pp)}static destroy(){}}Mp.extension=q.Application;class z1{constructor(t){this._renderer=t}init(){var t;(t=globalThis.__PIXI_RENDERER_INIT__)==null||t.call(globalThis,this._renderer,Pp)}destroy(){this._renderer=null}}z1.extension={type:[q.WebGLSystem,q.WebGPUSystem],name:"initHook",priority:-10};const Tp=class el{constructor(...t){this.stage=new kt,t[0]!==void 0&&gt(xt,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await H1(t),el._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return gt(xt,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const s=el._plugins.slice(0);s.reverse(),s.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Tp._plugins=[];let Ip=Tp;_e.handleByList(q.Application,Ip._plugins);_e.add(Mp);class kp extends ii{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return gt(xt,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return gt(xt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return gt(xt,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return gt(xt,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return gt(xt,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners();for(const s in this.chars)(e=this.chars[s].texture)==null||e.destroy();this.chars=null,t&&(this.pages.forEach(s=>s.texture.destroy(!0)),this.pages=null)}}const Ep=class il{constructor(t,e,s,r){this.uid=Qt("fillGradient"),this.type="linear",this.gradientStops=[],this._styleKey=null,this.x0=t,this.y0=e,this.x1=s,this.y1=r}addColorStop(t,e){return this.gradientStops.push({offset:t,color:$t.shared.setValue(e).toHexa()}),this._styleKey=null,this}buildLinearGradient(){const t=il.defaultTextureSize,{gradientStops:e}=this,s=Wt.get().createCanvas();s.width=t,s.height=t;const r=s.getContext("2d"),o=r.createLinearGradient(0,0,il.defaultTextureSize,1);for(let S=0;S<e.length;S++){const v=e[S];o.addColorStop(v.offset,v.color)}r.fillStyle=o,r.fillRect(0,0,t,t),this.texture=new ft({source:new hn({resource:s,addressModeU:"clamp-to-edge",addressModeV:"repeat"})});const{x0:h,y0:l,x1:u,y1:d}=this,f=new yt,g=u-h,m=d-l,y=Math.sqrt(g*g+m*m),b=Math.atan2(m,g);f.translate(-h,-l),f.scale(1/t,1/t),f.rotate(-b),f.scale(256/y,1),this.transform=f,this._styleKey=null}get styleKey(){if(this._styleKey)return this._styleKey;const t=this.gradientStops.map(r=>`${r.offset}-${r.color}`).join("-"),e=this.texture.uid,s=this.transform.toArray().join("-");return`fill-gradient-${this.uid}-${t}-${e}-${s}-${this.x0}-${this.y0}-${this.x1}-${this.y1}`}};Ep.defaultTextureSize=256;let Kn=Ep;const Yd={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class So{constructor(t,e){this.uid=Qt("fillPattern"),this.transform=new yt,this._styleKey=null,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Yd[e].addressModeU,t.source.style.addressModeV=Yd[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._styleKey=null}get styleKey(){return this._styleKey?this._styleKey:(this._styleKey=`fill-pattern-${this.uid}-${this.texture.uid}-${this.transform.toArray().join("-")}`,this._styleKey)}}var $1=X1,Mh={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},Y1=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function X1(i){var t=[];return i.replace(Y1,function(e,s,r){var o=s.toLowerCase();for(r=j1(r),o=="m"&&r.length>2&&(t.push([s].concat(r.splice(0,2))),o="l",s=s=="m"?"l":"L");;){if(r.length==Mh[o])return r.unshift(s),t.push(r);if(r.length<Mh[o])throw new Error("malformed path data");t.push([s].concat(r.splice(0,Mh[o])))}}),t}var q1=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function j1(i){var t=i.match(q1);return t?t.map(Number):[]}const K1=yl($1);function Z1(i,t){const e=K1(i),s=[];let r=null,o=0,h=0;for(let l=0;l<e.length;l++){const u=e[l],d=u[0],f=u;switch(d){case"M":o=f[1],h=f[2],t.moveTo(o,h);break;case"m":o+=f[1],h+=f[2],t.moveTo(o,h);break;case"H":o=f[1],t.lineTo(o,h);break;case"h":o+=f[1],t.lineTo(o,h);break;case"V":h=f[1],t.lineTo(o,h);break;case"v":h+=f[1],t.lineTo(o,h);break;case"L":o=f[1],h=f[2],t.lineTo(o,h);break;case"l":o+=f[1],h+=f[2],t.lineTo(o,h);break;case"C":o=f[5],h=f[6],t.bezierCurveTo(f[1],f[2],f[3],f[4],o,h);break;case"c":t.bezierCurveTo(o+f[1],h+f[2],o+f[3],h+f[4],o+f[5],h+f[6]),o+=f[5],h+=f[6];break;case"S":o=f[3],h=f[4],t.bezierCurveToShort(f[1],f[2],o,h);break;case"s":t.bezierCurveToShort(o+f[1],h+f[2],o+f[3],h+f[4]),o+=f[3],h+=f[4];break;case"Q":o=f[3],h=f[4],t.quadraticCurveTo(f[1],f[2],o,h);break;case"q":t.quadraticCurveTo(o+f[1],h+f[2],o+f[3],h+f[4]),o+=f[3],h+=f[4];break;case"T":o=f[1],h=f[2],t.quadraticCurveToShort(o,h);break;case"t":o+=f[1],h+=f[2],t.quadraticCurveToShort(o,h);break;case"A":o=f[6],h=f[7],t.arcToSvg(f[1],f[2],f[3],f[4],f[5],o,h);break;case"a":o+=f[6],h+=f[7],t.arcToSvg(f[1],f[2],f[3],f[4],f[5],o,h);break;case"Z":case"z":t.closePath(),s.length>0&&(r=s.pop(),r?(o=r.startX,h=r.startY):(o=0,h=0)),r=null;break;default:Yt(`Unknown SVG path command: ${d}`)}d!=="Z"&&d!=="z"&&r===null&&(r={startX:o,startY:h},s.push(r))}return t}let Q1=class Rp{constructor(t=0,e=0,s=0){this.type="circle",this.x=t,this.y=e,this.radius=s}clone(){return new Rp(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-t,o=this.y-e;return r*=r,o*=o,r+o<=s}strokeContains(t,e,s){if(this.radius===0)return!1;const r=this.x-t,o=this.y-e,h=this.radius,l=s/2,u=Math.sqrt(r*r+o*o);return u<h+l&&u>h-l}getBounds(t){return t=t||new ie,t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}};class Cl{constructor(t=0,e=0,s=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=s,this.halfHeight=r}clone(){return new Cl(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(t-this.x)/this.halfWidth,r=(e-this.y)/this.halfHeight;return s*=s,r*=r,s+r<=1}strokeContains(t,e,s){const{halfWidth:r,halfHeight:o}=this;if(r<=0||o<=0)return!1;const h=s/2,l=r-h,u=o-h,d=r+h,f=o+h,g=t-this.x,m=e-this.y,y=g*g/(l*l)+m*m/(u*u),b=g*g/(d*d)+m*m/(f*f);return y>1&&b<=1}getBounds(t){return t=t||new ie,t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function J1(i,t,e,s,r,o){const h=i-e,l=t-s,u=r-e,d=o-s,f=h*u+l*d,g=u*u+d*d;let m=-1;g!==0&&(m=f/g);let y,b;m<0?(y=e,b=s):m>1?(y=r,b=o):(y=e+m*u,b=s+m*d);const S=i-y,v=t-b;return S*S+v*v}class Hn{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let r=0,o=e.length;r<o;r++)s.push(e[r].x,e[r].y);e=s}this.points=e,this.closePath=!0}clone(){const t=this.points.slice(),e=new Hn(t);return e.closePath=this.closePath,e}contains(t,e){let s=!1;const r=this.points.length/2;for(let o=0,h=r-1;o<r;h=o++){const l=this.points[o*2],u=this.points[o*2+1],d=this.points[h*2],f=this.points[h*2+1];u>e!=f>e&&t<(d-l)*((e-u)/(f-u))+l&&(s=!s)}return s}strokeContains(t,e,s){const r=s/2,o=r*r,{points:h}=this,l=h.length-(this.closePath?0:2);for(let u=0;u<l;u+=2){const d=h[u],f=h[u+1],g=h[(u+2)%h.length],m=h[(u+3)%h.length];if(J1(t,e,d,f,g,m)<=o)return!0}return!1}getBounds(t){t=t||new ie;const e=this.points;let s=1/0,r=-1/0,o=1/0,h=-1/0;for(let l=0,u=e.length;l<u;l+=2){const d=e[l],f=e[l+1];s=d<s?d:s,r=d>r?d:r,o=f<o?f:o,h=f>h?f:h}return t.x=s,t.width=r-s,t.y=o,t.height=h-o,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}const io=(i,t,e,s,r,o)=>{const h=i-e,l=t-s,u=Math.sqrt(h*h+l*l);return u>=r-o&&u<=r+o};class Pl{constructor(t=0,e=0,s=0,r=0,o=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=s,this.height=r,this.radius=o}getBounds(t){return t=t||new ie,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Pl(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let r=t-(this.x+s),o=e-(this.y+s);const h=s*s;if(r*r+o*o<=h||(r=t-(this.x+this.width-s),r*r+o*o<=h)||(o=e-(this.y+this.height-s),r*r+o*o<=h)||(r=t-(this.x+s),r*r+o*o<=h))return!0}return!1}strokeContains(t,e,s){const{x:r,y:o,width:h,height:l,radius:u}=this,d=s/2,f=r+u,g=o+u,m=h-u*2,y=l-u*2,b=r+h,S=o+l;return(t>=r-d&&t<=r+d||t>=b-d&&t<=b+d)&&e>=g&&e<=g+y||(e>=o-d&&e<=o+d||e>=S-d&&e<=S+d)&&t>=f&&t<=f+m?!0:t<f&&e<g&&io(t,e,f,g,u,d)||t>b-u&&e<g&&io(t,e,b-u,g,u,d)||t>b-u&&e>S-u&&io(t,e,b-u,S-u,u,d)||t<f&&e>S-u&&io(t,e,f,S-u,u,d)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const tA=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function eA(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function iA(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const s=tA.replace(/%forloop%/gi,eA(i));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}}finally{t.deleteShader(e)}return i}let qs=null;function Bp(){var t;if(qs)return qs;const i=dp();return qs=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),qs=iA(qs,i),(t=i.getExtension("WEBGL_lose_context"))==null||t.loseContext(),qs}const Lp={};function sA(i,t){let e=2166136261;for(let s=0;s<t;s++)e^=i[s].uid,e=Math.imul(e,16777619),e>>>=0;return Lp[e]||nA(i,t,e)}let Th=0;function nA(i,t,e){const s={};let r=0;Th||(Th=Bp());for(let h=0;h<Th;h++){const l=h<t?i[h]:ft.EMPTY.source;s[r++]=l.source,s[r++]=l.style}const o=new lo(s);return Lp[e]=o,o}class Xd{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function qd(i,t){const e=i.byteLength/8|0,s=new Float64Array(i,0,e);new Float64Array(t,0,e).set(s);const o=i.byteLength-e*8;if(o>0){const h=new Uint8Array(i,e*8,o);new Uint8Array(t,e*8,o).set(h)}}const rA={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var oA=(i=>(i[i.DISABLED=0]="DISABLED",i[i.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",i[i.MASK_ACTIVE=2]="MASK_ACTIVE",i[i.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",i[i.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",i[i.NONE=5]="NONE",i))(oA||{});function jd(i,t){return t.alphaMode==="no-premultiply-alpha"&&rA[i]||i}class aA{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class hA{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new aA,this.blendMode="normal",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Op=[];let sl=0;function Kd(){return sl>0?Op[--sl]:new hA}function Zd(i){Op[sl++]=i}let Rn=0;const Fp=class co{constructor(t={}){this.uid=Qt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],co.defaultOptions.maxTextures=co.defaultOptions.maxTextures??Bp(),t={...co.defaultOptions,...t};const{maxTextures:e,attributesInitialSize:s,indicesInitialSize:r}=t;this.attributeBuffer=new Xd(s*4),this.indexBuffer=new Uint16Array(r),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)Zd(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const s=t._batch.textures.ids[e._source.uid];return!s&&s!==0?!1:(t._textureId=s,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let s=Kd(),r=s.textures;r.clear();const o=e[this.elementStart];let h=jd(o.blendMode,o.texture._source);this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,u=this.attributeBuffer.uint32View,d=this.indexBuffer;let f=this._batchIndexSize,g=this._batchIndexStart,m="startBatch";const y=this.maxTextures;for(let b=this.elementStart;b<this.elementSize;++b){const S=e[b];e[b]=null;const M=S.texture._source,k=jd(S.blendMode,M),I=h!==k;if(M._batchTick===Rn&&!I){S._textureId=M._textureBindLocation,f+=S.indexSize,S.packAsQuad?(this.packQuadAttributes(S,l,u,S._attributeStart,S._textureId),this.packQuadIndex(d,S._indexStart,S._attributeStart/this.vertexSize)):(this.packAttributes(S,l,u,S._attributeStart,S._textureId),this.packIndex(S,d,S._indexStart,S._attributeStart/this.vertexSize)),S._batch=s;continue}M._batchTick=Rn,(r.count>=y||I)&&(this._finishBatch(s,g,f-g,r,h,t,m),m="renderBatch",g=f,h=k,s=Kd(),r=s.textures,r.clear(),++Rn),S._textureId=M._textureBindLocation=r.count,r.ids[M.uid]=r.count,r.textures[r.count++]=M,S._batch=s,f+=S.indexSize,S.packAsQuad?(this.packQuadAttributes(S,l,u,S._attributeStart,S._textureId),this.packQuadIndex(d,S._indexStart,S._attributeStart/this.vertexSize)):(this.packAttributes(S,l,u,S._attributeStart,S._textureId),this.packIndex(S,d,S._indexStart,S._attributeStart/this.vertexSize))}r.count>0&&(this._finishBatch(s,g,f-g,r,h,t,m),g=f,++Rn),this.elementStart=this.elementSize,this._batchIndexStart=g,this._batchIndexSize=f}_finishBatch(t,e,s,r,o,h,l){t.gpuBindGroup=null,t.bindGroup=null,t.action=l,t.batcher=this,t.textures=r,t.blendMode=o,t.start=e,t.size=s,++Rn,this.batches[this.batchIndex++]=t,h.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),s=new Xd(e);qd(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(t){const e=this.indexBuffer;let s=Math.max(t,e.length*1.5);s+=s%2;const r=s>65535?new Uint32Array(s):new Uint16Array(s);if(r.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let o=0;o<e.length;o++)r[o]=e[o];else qd(e.buffer,r.buffer);this.indexBuffer=r}packQuadIndex(t,e,s){t[e]=s+0,t[e+1]=s+1,t[e+2]=s+2,t[e+3]=s+0,t[e+4]=s+2,t[e+5]=s+3}packIndex(t,e,s,r){const o=t.indices,h=t.indexSize,l=t.indexOffset,u=t.attributeOffset;for(let d=0;d<h;d++)e[s++]=r+o[d+l]-u}destroy(){for(let t=0;t<this.batches.length;t++)Zd(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]._batch=null;this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}};Fp.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let lA=Fp;var zt=(i=>(i[i.MAP_READ=1]="MAP_READ",i[i.MAP_WRITE=2]="MAP_WRITE",i[i.COPY_SRC=4]="COPY_SRC",i[i.COPY_DST=8]="COPY_DST",i[i.INDEX=16]="INDEX",i[i.VERTEX=32]="VERTEX",i[i.UNIFORM=64]="UNIFORM",i[i.STORAGE=128]="STORAGE",i[i.INDIRECT=256]="INDIRECT",i[i.QUERY_RESOLVE=512]="QUERY_RESOLVE",i[i.STATIC=1024]="STATIC",i))(zt||{});class ts extends ii{constructor(t){let{data:e,size:s}=t;const{usage:r,label:o,shrinkToFit:h}=t;super(),this.uid=Qt("buffer"),this._resourceType="buffer",this._resourceId=Qt("resource"),this._touched=0,this._updateID=1,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,s=s??(e==null?void 0:e.byteLength);const l=!!e;this.descriptor={size:s,usage:r,mappedAtCreation:l,label:o},this.shrinkToFit=h??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get static(){return!!(this.descriptor.usage&zt.STATIC)}set static(t){t?this.descriptor.usage|=zt.STATIC:this.descriptor.usage&=~zt.STATIC}setDataWithSize(t,e,s){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){s&&this.emit("update",this);return}const r=this._data;if(this._data=t,r.length!==t.length){!this.shrinkToFit&&t.byteLength<r.byteLength?s&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=Qt("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Up(i,t){if(!(i instanceof ts)){let e=t?zt.INDEX:zt.VERTEX;i instanceof Array&&(t?(i=new Uint32Array(i),e=zt.INDEX|zt.COPY_DST):(i=new Float32Array(i),e=zt.VERTEX|zt.COPY_DST)),i=new ts({data:i,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return i}function cA(i,t,e){const s=i.getAttribute(t);if(!s)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const r=s.buffer.data;let o=1/0,h=1/0,l=-1/0,u=-1/0;const d=r.BYTES_PER_ELEMENT,f=(s.offset||0)/d,g=(s.stride||2*4)/d;for(let m=f;m<r.length;m+=g){const y=r[m],b=r[m+1];y>l&&(l=y),b>u&&(u=b),y<o&&(o=y),b<h&&(h=b)}return e.minX=o,e.minY=h,e.maxX=l,e.maxY=u,e}function uA(i){return(i instanceof ts||Array.isArray(i)||i.BYTES_PER_ELEMENT)&&(i={buffer:i}),i.buffer=Up(i.buffer,!1),i}class Vp extends ii{constructor(t={}){super(),this.uid=Qt("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new pi,this._boundsDirty=!0;const{attributes:e,indexBuffer:s,topology:r}=t;if(this.buffers=[],this.attributes={},e)for(const o in e)this.addAttribute(o,e[o]);this.instanceCount=t.instanceCount||1,s&&this.addIndex(s),this.topology=r||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const s=uA(e);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=s}addIndex(t){this.indexBuffer=Up(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,cA(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const dA=new Float32Array(1),fA=new Uint32Array(1);class pA extends Vp{constructor(){const e=new ts({data:dA,label:"attribute-batch-buffer",usage:zt.VERTEX|zt.COPY_DST,shrinkToFit:!1}),s=new ts({data:fA,label:"index-batch-buffer",usage:zt.INDEX|zt.COPY_DST,shrinkToFit:!1}),r=6*4;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:r,offset:0},aUV:{buffer:e,format:"float32x2",stride:r,offset:2*4},aColor:{buffer:e,format:"unorm8x4",stride:r,offset:4*4},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:r,offset:5*4}},indexBuffer:s})}}function Qd(i,t,e){if(i)for(const s in i){const r=s.toLocaleLowerCase(),o=t[r];if(o){let h=i[s];s==="header"&&(h=h.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&o.push(`//----${e}----//`),o.push(h)}else Yt(`${s} placement hook does not exist in shader`)}}const gA=/\{\{(.*?)\}\}/g;function Jd(i){var s;const t={};return(((s=i.match(gA))==null?void 0:s.map(r=>r.replace(/[{()}]/g,"")))??[]).forEach(r=>{t[r]=[]}),t}function tf(i,t){let e;const s=/@in\s+([^;]+);/g;for(;(e=s.exec(i))!==null;)t.push(e[1])}function ef(i,t,e=!1){const s=[];tf(t,s),i.forEach(l=>{l.header&&tf(l.header,s)});const r=s;e&&r.sort();const o=r.map((l,u)=>`       @location(${u}) ${l},`).join(`
`);let h=t.replace(/@in\s+[^;]+;\s*/g,"");return h=h.replace("{{in}}",`
${o}
`),h}function sf(i,t){let e;const s=/@out\s+([^;]+);/g;for(;(e=s.exec(i))!==null;)t.push(e[1])}function _A(i){const e=/\b(\w+)\s*:/g.exec(i);return e?e[1]:""}function mA(i){const t=/@.*?\s+/g;return i.replace(t,"")}function xA(i,t){const e=[];sf(t,e),i.forEach(u=>{u.header&&sf(u.header,e)});let s=0;const r=e.sort().map(u=>u.indexOf("builtin")>-1?u:`@location(${s++}) ${u}`).join(`,
`),o=e.sort().map(u=>`       var ${mA(u)};`).join(`
`),h=`return VSOutput(
                ${e.sort().map(u=>` ${_A(u)}`).join(`,
`)});`;let l=t.replace(/@out\s+[^;]+;\s*/g,"");return l=l.replace("{{struct}}",`
${r}
`),l=l.replace("{{start}}",`
${o}
`),l=l.replace("{{return}}",`
${h}
`),l}function nf(i,t){let e=i;for(const s in t){const r=t[s];r.join(`
`).length?e=e.replace(`{{${s}}}`,`//-----${s} START-----//
${r.join(`
`)}
//----${s} FINISH----//`):e=e.replace(`{{${s}}}`,"")}return e}const Ji=Object.create(null),Ih=new Map;let yA=0;function wA({template:i,bits:t}){const e=Dp(i,t);if(Ji[e])return Ji[e];const{vertex:s,fragment:r}=vA(i,t);return Ji[e]=Wp(s,r,t),Ji[e]}function bA({template:i,bits:t}){const e=Dp(i,t);return Ji[e]||(Ji[e]=Wp(i.vertex,i.fragment,t)),Ji[e]}function vA(i,t){const e=t.map(h=>h.vertex).filter(h=>!!h),s=t.map(h=>h.fragment).filter(h=>!!h);let r=ef(e,i.vertex,!0);r=xA(e,r);const o=ef(s,i.fragment,!0);return{vertex:r,fragment:o}}function Dp(i,t){return t.map(e=>(Ih.has(e)||Ih.set(e,yA++),Ih.get(e))).sort((e,s)=>e-s).join("-")+i.vertex+i.fragment}function Wp(i,t,e){const s=Jd(i),r=Jd(t);return e.forEach(o=>{Qd(o.vertex,s,o.name),Qd(o.fragment,r,o.name)}),{vertex:nf(i,s),fragment:nf(t,r)}}const AA=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}
        
        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);
       
        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,SA=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;
   
    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {
        
        {{start}}

        var outColor:vec4<f32>;
      
        {{main}}
        
        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,CA=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;
        
        {{start}}
        
        vColor = vec4(1.);
        
        {{main}}
        
        vUV = uv;
        
        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,PA=`
   
    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {
        
        {{start}}

        vec4 outColor;
      
        {{main}}
        
        finalColor = outColor * vColor;
        
        {{end}}
    }
`,MA={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},TA={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function IA({bits:i,name:t}){const e=wA({template:{fragment:SA,vertex:AA},bits:[MA,...i]});return bo.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function kA({bits:i,name:t}){return new pp({name:t,...bA({template:{vertex:CA,fragment:PA},bits:[TA,...i]})})}const EA={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},RA={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},kh={};function BA(i){const t=[];if(i===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let s=0;s<i;s++)t.push(`@group(1) @binding(${e++}) var textureSource${s+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${s+1}: sampler;`)}return t.join(`
`)}function LA(i){const t=[];if(i===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<i;e++)e===i-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function OA(i){return kh[i]||(kh[i]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${BA(i)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${LA(i)}
            `}}),kh[i]}const Eh={};function FA(i){const t=[];for(let e=0;e<i;e++)e>0&&t.push("else"),e<i-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function UA(i){return Eh[i]||(Eh[i]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${i}];

            `,main:`

                ${FA(i)}
            `}}),Eh[i]}const VA={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32> 
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},DA={name:"round-pixels-bit",vertex:{header:`   
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {       
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},rf={};function WA(i){let t=rf[i];if(t)return t;const e=new Int32Array(i);for(let s=0;s<i;s++)e[s]=s;return t=rf[i]=new xp({uTextures:{value:e,type:"i32",size:i}},{isStatic:!0}),t}class NA extends Al{constructor(t){const e=kA({name:"batch",bits:[RA,UA(t),DA]}),s=IA({name:"batch",bits:[EA,OA(t),VA]});super({glProgram:e,gpuProgram:s,resources:{batchSamplers:WA(t)}})}}let of=null;const Np=class Gp extends lA{constructor(){super(...arguments),this.geometry=new pA,this.shader=of||(of=new NA(this.maxTextures)),this.name=Gp.extension.name,this.vertexSize=6}packAttributes(t,e,s,r,o){const h=o<<16|t.roundPixels&65535,l=t.transform,u=l.a,d=l.b,f=l.c,g=l.d,m=l.tx,y=l.ty,{positions:b,uvs:S}=t,v=t.color,M=t.attributeOffset,k=M+t.attributeSize;for(let I=M;I<k;I++){const R=I*2,D=b[R],K=b[R+1];e[r++]=u*D+f*K+m,e[r++]=g*K+d*D+y,e[r++]=S[R],e[r++]=S[R+1],s[r++]=v,s[r++]=h}}packQuadAttributes(t,e,s,r,o){const h=t.texture,l=t.transform,u=l.a,d=l.b,f=l.c,g=l.d,m=l.tx,y=l.ty,b=t.bounds,S=b.maxX,v=b.minX,M=b.maxY,k=b.minY,I=h.uvs,R=t.color,D=o<<16|t.roundPixels&65535;e[r+0]=u*v+f*k+m,e[r+1]=g*k+d*v+y,e[r+2]=I.x0,e[r+3]=I.y0,s[r+4]=R,s[r+5]=D,e[r+6]=u*S+f*k+m,e[r+7]=g*k+d*S+y,e[r+8]=I.x1,e[r+9]=I.y1,s[r+10]=R,s[r+11]=D,e[r+12]=u*S+f*M+m,e[r+13]=g*M+d*S+y,e[r+14]=I.x2,e[r+15]=I.y2,s[r+16]=R,s[r+17]=D,e[r+18]=u*v+f*M+m,e[r+19]=g*M+d*v+y,e[r+20]=I.x3,e[r+21]=I.y3,s[r+22]=R,s[r+23]=D}};Np.extension={type:[q.Batcher],name:"default"};let GA=Np;function HA(i,t,e,s,r,o,h,l=null){let u=0;e*=t,r*=o;const d=l.a,f=l.b,g=l.c,m=l.d,y=l.tx,b=l.ty;for(;u<h;){const S=i[e],v=i[e+1];s[r]=d*S+g*v+y,s[r+1]=f*S+m*v+b,r+=o,e+=t,u++}}function zA(i,t,e,s){let r=0;for(t*=e;r<s;)i[t]=0,i[t+1]=0,t+=e,r++}function Hp(i,t,e,s,r){const o=t.a,h=t.b,l=t.c,u=t.d,d=t.tx,f=t.ty;e=e||0,s=s||2,r=r||i.length/s-e;let g=e*s;for(let m=0;m<r;m++){const y=i[g],b=i[g+1];i[g]=o*y+l*b+d,i[g+1]=h*y+u*b+f,g+=s}}function $A(i,t){if(i===16777215||!t)return t;if(t===16777215||!i)return i;const e=i>>16&255,s=i>>8&255,r=i&255,o=t>>16&255,h=t>>8&255,l=t&255,u=e*o/255,d=s*h/255,f=r*l/255;return(u<<16)+(d<<8)+f}const YA=new yt;class zp{constructor(){this.packAsQuad=!1,this.batcherName="default",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,s=this.renderable;return s?$A(e,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||YA}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData}reset(){this.applyTransform=!0,this.renderable=null}}const Zn={extension:{type:q.ShapeBuilder,name:"circle"},build(i,t){let e,s,r,o,h,l;if(i.type==="circle"){const R=i;e=R.x,s=R.y,h=l=R.radius,r=o=0}else if(i.type==="ellipse"){const R=i;e=R.x,s=R.y,h=R.halfWidth,l=R.halfHeight,r=o=0}else{const R=i,D=R.width/2,K=R.height/2;e=R.x+D,s=R.y+K,h=l=Math.max(0,Math.min(R.radius,Math.min(D,K))),r=D-h,o=K-l}if(!(h>=0&&l>=0&&r>=0&&o>=0))return t;const u=Math.ceil(2.3*Math.sqrt(h+l)),d=u*8+(r?4:0)+(o?4:0);if(d===0)return t;if(u===0)return t[0]=t[6]=e+r,t[1]=t[3]=s+o,t[2]=t[4]=e-r,t[5]=t[7]=s-o,t;let f=0,g=u*4+(r?2:0)+2,m=g,y=d,b=r+h,S=o,v=e+b,M=e-b,k=s+S;if(t[f++]=v,t[f++]=k,t[--g]=k,t[--g]=M,o){const R=s-S;t[m++]=M,t[m++]=R,t[--y]=R,t[--y]=v}for(let R=1;R<u;R++){const D=Math.PI/2*(R/u),K=r+Math.cos(D)*h,H=o+Math.sin(D)*l,Y=e+K,V=e-K,W=s+H,Et=s-H;t[f++]=Y,t[f++]=W,t[--g]=W,t[--g]=V,t[m++]=V,t[m++]=Et,t[--y]=Et,t[--y]=Y}b=r,S=o+l,v=e+b,M=e-b,k=s+S;const I=s-S;return t[f++]=v,t[f++]=k,t[--y]=I,t[--y]=v,r&&(t[f++]=M,t[f++]=k,t[--y]=I,t[--y]=M),t},triangulate(i,t,e,s,r,o){if(i.length===0)return;let h=0,l=0;for(let f=0;f<i.length;f+=2)h+=i[f],l+=i[f+1];h/=i.length/2,l/=i.length/2;let u=s;t[u*e]=h,t[u*e+1]=l;const d=u++;for(let f=0;f<i.length;f+=2)t[u*e]=i[f],t[u*e+1]=i[f+1],f>0&&(r[o++]=u,r[o++]=d,r[o++]=u-1),u++;r[o++]=d+1,r[o++]=d,r[o++]=u-1}},XA={...Zn,extension:{...Zn.extension,name:"ellipse"}},qA={...Zn,extension:{...Zn.extension,name:"roundedRectangle"}},jA=1e-4,af=1e-4;function KA(i){const t=i.length;if(t<6)return 1;let e=0;for(let s=0,r=i[t-2],o=i[t-1];s<t;s+=2){const h=i[s],l=i[s+1];e+=(h-r)*(l+o),r=h,o=l}return e<0?-1:1}function hf(i,t,e,s,r,o,h,l){const u=i-e*r,d=t-s*r,f=i+e*o,g=t+s*o;let m,y;h?(m=s,y=-e):(m=-s,y=e);const b=u+m,S=d+y,v=f+m,M=g+y;return l.push(b,S),l.push(v,M),2}function ys(i,t,e,s,r,o,h,l){const u=e-i,d=s-t;let f=Math.atan2(u,d),g=Math.atan2(r-i,o-t);l&&f<g?f+=Math.PI*2:!l&&f>g&&(g+=Math.PI*2);let m=f;const y=g-f,b=Math.abs(y),S=Math.sqrt(u*u+d*d),v=(15*b*Math.sqrt(S)/Math.PI>>0)+1,M=y/v;if(m+=M,l){h.push(i,t),h.push(e,s);for(let k=1,I=m;k<v;k++,I+=M)h.push(i,t),h.push(i+Math.sin(I)*S,t+Math.cos(I)*S);h.push(i,t),h.push(r,o)}else{h.push(e,s),h.push(i,t);for(let k=1,I=m;k<v;k++,I+=M)h.push(i+Math.sin(I)*S,t+Math.cos(I)*S),h.push(i,t);h.push(r,o),h.push(i,t)}return v*2}function ZA(i,t,e,s,r,o,h,l,u){const d=jA;if(i.length===0)return;const f=t;let g=f.alignment;if(t.alignment!==.5){let vt=KA(i);g=(g-.5)*vt+.5}const m=new at(i[0],i[1]),y=new at(i[i.length-2],i[i.length-1]),b=s,S=Math.abs(m.x-y.x)<d&&Math.abs(m.y-y.y)<d;if(b){i=i.slice(),S&&(i.pop(),i.pop(),y.set(i[i.length-2],i[i.length-1]));const vt=(m.x+y.x)*.5,ni=(y.y+m.y)*.5;i.unshift(vt,ni),i.push(vt,ni)}const v=r,M=i.length/2;let k=i.length;const I=v.length/2,R=f.width/2,D=R*R,K=f.miterLimit*f.miterLimit;let H=i[0],Y=i[1],V=i[2],W=i[3],Et=0,$e=0,it=-(Y-W),J=H-V,Mt=0,Ft=0,Xt=Math.sqrt(it*it+J*J);it/=Xt,J/=Xt,it*=R,J*=R;const Ye=g,tt=(1-Ye)*2,et=Ye*2;b||(f.cap==="round"?k+=ys(H-it*(tt-et)*.5,Y-J*(tt-et)*.5,H-it*tt,Y-J*tt,H+it*et,Y+J*et,v,!0)+2:f.cap==="square"&&(k+=hf(H,Y,it,J,tt,et,!0,v))),v.push(H-it*tt,Y-J*tt),v.push(H+it*et,Y+J*et);for(let vt=1;vt<M-1;++vt){H=i[(vt-1)*2],Y=i[(vt-1)*2+1],V=i[vt*2],W=i[vt*2+1],Et=i[(vt+1)*2],$e=i[(vt+1)*2+1],it=-(Y-W),J=H-V,Xt=Math.sqrt(it*it+J*J),it/=Xt,J/=Xt,it*=R,J*=R,Mt=-(W-$e),Ft=V-Et,Xt=Math.sqrt(Mt*Mt+Ft*Ft),Mt/=Xt,Ft/=Xt,Mt*=R,Ft*=R;const ni=V-H,as=Y-W,Le=V-Et,ri=$e-W,er=ni*Le+as*ri,oi=as*Le-ri*ni,Xe=oi<0;if(Math.abs(oi)<.001*Math.abs(er)){v.push(V-it*tt,W-J*tt),v.push(V+it*et,W+J*et),er>=0&&(f.join==="round"?k+=ys(V,W,V-it*tt,W-J*tt,V-Mt*tt,W-Ft*tt,v,!1)+4:k+=2,v.push(V-Mt*et,W-Ft*et),v.push(V+Mt*tt,W+Ft*tt));continue}const ir=(-it+H)*(-J+W)-(-it+V)*(-J+Y),hs=(-Mt+Et)*(-Ft+W)-(-Mt+V)*(-Ft+$e),_i=(ni*hs-Le*ir)/oi,ls=(ri*ir-as*hs)/oi,ue=(_i-V)*(_i-V)+(ls-W)*(ls-W),ve=V+(_i-V)*tt,mi=W+(ls-W)*tt,se=V-(_i-V)*et,ai=W-(ls-W)*et,Wo=Math.min(ni*ni+as*as,Le*Le+ri*ri),Fi=Xe?tt:et,Ae=Wo+Fi*Fi*D;ue<=Ae?f.join==="bevel"||ue/D>K?(Xe?(v.push(ve,mi),v.push(V+it*et,W+J*et),v.push(ve,mi),v.push(V+Mt*et,W+Ft*et)):(v.push(V-it*tt,W-J*tt),v.push(se,ai),v.push(V-Mt*tt,W-Ft*tt),v.push(se,ai)),k+=2):f.join==="round"?Xe?(v.push(ve,mi),v.push(V+it*et,W+J*et),k+=ys(V,W,V+it*et,W+J*et,V+Mt*et,W+Ft*et,v,!0)+4,v.push(ve,mi),v.push(V+Mt*et,W+Ft*et)):(v.push(V-it*tt,W-J*tt),v.push(se,ai),k+=ys(V,W,V-it*tt,W-J*tt,V-Mt*tt,W-Ft*tt,v,!1)+4,v.push(V-Mt*tt,W-Ft*tt),v.push(se,ai)):(v.push(ve,mi),v.push(se,ai)):(v.push(V-it*tt,W-J*tt),v.push(V+it*et,W+J*et),f.join==="round"?Xe?k+=ys(V,W,V+it*et,W+J*et,V+Mt*et,W+Ft*et,v,!0)+2:k+=ys(V,W,V-it*tt,W-J*tt,V-Mt*tt,W-Ft*tt,v,!1)+2:f.join==="miter"&&ue/D<=K&&(Xe?(v.push(se,ai),v.push(se,ai)):(v.push(ve,mi),v.push(ve,mi)),k+=2),v.push(V-Mt*tt,W-Ft*tt),v.push(V+Mt*et,W+Ft*et),k+=2)}H=i[(M-2)*2],Y=i[(M-2)*2+1],V=i[(M-1)*2],W=i[(M-1)*2+1],it=-(Y-W),J=H-V,Xt=Math.sqrt(it*it+J*J),it/=Xt,J/=Xt,it*=R,J*=R,v.push(V-it*tt,W-J*tt),v.push(V+it*et,W+J*et),b||(f.cap==="round"?k+=ys(V-it*(tt-et)*.5,W-J*(tt-et)*.5,V-it*tt,W-J*tt,V+it*et,W+J*et,v,!1)+2:f.cap==="square"&&(k+=hf(V,W,it,J,tt,et,!1,v)));const Be=af*af;for(let vt=I;vt<k+I-2;++vt)H=v[vt*2],Y=v[vt*2+1],V=v[(vt+1)*2],W=v[(vt+1)*2+1],Et=v[(vt+2)*2],$e=v[(vt+2)*2+1],!(Math.abs(H*(W-$e)+V*($e-Y)+Et*(Y-W))<Be)&&l.push(vt,vt+1,vt+2)}function $p(i,t,e,s,r,o,h){const l=V1(i,t,2);if(!l)return;for(let d=0;d<l.length;d+=3)o[h++]=l[d]+r,o[h++]=l[d+1]+r,o[h++]=l[d+2]+r;let u=r*s;for(let d=0;d<i.length;d+=2)e[u]=i[d],e[u+1]=i[d+1],u+=s}const QA=[],JA={extension:{type:q.ShapeBuilder,name:"polygon"},build(i,t){for(let e=0;e<i.points.length;e++)t[e]=i.points[e];return t},triangulate(i,t,e,s,r,o){$p(i,QA,t,e,s,r,o)}},tS={extension:{type:q.ShapeBuilder,name:"rectangle"},build(i,t){const e=i,s=e.x,r=e.y,o=e.width,h=e.height;return o>=0&&h>=0&&(t[0]=s,t[1]=r,t[2]=s+o,t[3]=r,t[4]=s+o,t[5]=r+h,t[6]=s,t[7]=r+h),t},triangulate(i,t,e,s,r,o){let h=0;s*=e,t[s+h]=i[0],t[s+h+1]=i[1],h+=e,t[s+h]=i[2],t[s+h+1]=i[3],h+=e,t[s+h]=i[6],t[s+h+1]=i[7],h+=e,t[s+h]=i[4],t[s+h+1]=i[5],h+=e;const l=s/e;r[o++]=l,r[o++]=l+1,r[o++]=l+2,r[o++]=l+1,r[o++]=l+3,r[o++]=l+2}},eS={extension:{type:q.ShapeBuilder,name:"triangle"},build(i,t){return t[0]=i.x,t[1]=i.y,t[2]=i.x2,t[3]=i.y2,t[4]=i.x3,t[5]=i.y3,t},triangulate(i,t,e,s,r,o){let h=0;s*=e,t[s+h]=i[0],t[s+h+1]=i[1],h+=e,t[s+h]=i[2],t[s+h+1]=i[3],h+=e,t[s+h]=i[4],t[s+h+1]=i[5];const l=s/e;r[o++]=l,r[o++]=l+1,r[o++]=l+2}},Co={};_e.handleByMap(q.ShapeBuilder,Co);_e.add(tS,JA,eS,Zn,XA,qA);const iS=new ie;function sS(i,t){const{geometryData:e,batches:s}=t;s.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let r=0;r<i.instructions.length;r++){const o=i.instructions[r];if(o.action==="texture")nS(o.data,s,e);else if(o.action==="fill"||o.action==="stroke"){const h=o.action==="stroke",l=o.data.path.shapePath,u=o.data.style,d=o.data.hole;h&&d&&lf(d.shapePath,u,null,!0,s,e),lf(l,u,d,h,s,e)}}}function nS(i,t,e){const{vertices:s,uvs:r,indices:o}=e,h=o.length,l=s.length/2,u=[],d=Co.rectangle,f=iS,g=i.image;f.x=i.dx,f.y=i.dy,f.width=i.dw,f.height=i.dh;const m=i.transform;d.build(f,u),m&&Hp(u,m),d.triangulate(u,s,2,l,o,h);const y=g.uvs;r.push(y.x0,y.y0,y.x1,y.y1,y.x3,y.y3,y.x2,y.y2);const b=Ei.get(zp);b.indexOffset=h,b.indexSize=o.length-h,b.attributeOffset=l,b.attributeSize=s.length/2-l,b.baseColor=i.style,b.alpha=i.alpha,b.texture=g,b.geometryData=e,t.push(b)}function lf(i,t,e,s,r,o){const{vertices:h,uvs:l,indices:u}=o,d=i.shapePrimitives.length-1;i.shapePrimitives.forEach(({shape:f,transform:g},m)=>{const y=u.length,b=h.length/2,S=[],v=Co[f.type];if(v.build(f,S),g&&Hp(S,g),s){const R=f.closePath??!0;ZA(S,t,!1,R,h,2,b,u)}else if(e&&d===m){d!==0&&console.warn("[Pixi Graphics] only the last shape have be cut out");const R=[],D=S.slice();rS(e.shapePath).forEach(H=>{R.push(D.length/2),D.push(...H)}),$p(D,R,h,2,b,u,y)}else v.triangulate(S,h,2,b,u,y);const M=l.length/2,k=t.texture;if(k!==ft.WHITE){const R=t.matrix;R&&(g&&R.append(g.clone().invert()),HA(h,2,b,l,M,2,h.length/2-b,R))}else zA(l,M,2,h.length/2-b);const I=Ei.get(zp);I.indexOffset=y,I.indexSize=u.length-y,I.attributeOffset=b,I.attributeSize=h.length/2-b,I.baseColor=t.color,I.alpha=t.alpha,I.texture=k,I.geometryData=o,r.push(I)})}function rS(i){if(!i)return[];const t=i.shapePrimitives,e=[];for(let s=0;s<t.length;s++){const r=t[s].shape,o=[];Co[r.type].build(r,o),e.push(o)}return e}class oS{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class aS{constructor(){this.batcher=new GA,this.instructions=new Zf}init(){this.instructions.reset()}get geometry(){return gt(dv,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}}const Ml=class nl{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){nl.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??nl.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),sS(t,e);const s=t.batchMode;t.customShader||s==="no-batch"?e.isBatchable=!1:s==="auto"&&(e.isBatchable=e.geometryData.vertices.length<400),t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=Ei.get(aS),{batches:s,geometryData:r}=this._gpuContextHash[t.uid],o=r.vertices.length,h=r.indices.length;for(let f=0;f<s.length;f++)s[f].applyTransform=!1;const l=e.batcher;l.ensureAttributeBuffer(o),l.ensureIndexBuffer(h),l.begin();for(let f=0;f<s.length;f++){const g=s[f];l.add(g)}l.finish(e.instructions);const u=l.geometry;u.indexBuffer.setDataWithSize(l.indexBuffer,l.indexSize,!0),u.buffers[0].setDataWithSize(l.attributeBuffer.float32View,l.attributeSize,!0);const d=l.batches;for(let f=0;f<d.length;f++){const g=d[f];g.bindGroup=sA(g.textures.textures,g.textures.count)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new oS;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(Ei.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(s=>{Ei.return(s)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context)}};Ml.extension={type:[q.WebGLSystem,q.WebGPUSystem,q.CanvasSystem],name:"graphicsContext"};Ml.defaultOptions={bezierSmoothness:.5};let Yp=Ml;const hS=8,so=11920929e-14,lS=1;function Xp(i,t,e,s,r,o,h,l,u,d){const g=Math.min(.99,Math.max(0,d??Yp.defaultOptions.bezierSmoothness));let m=(lS-g)/1;return m*=m,cS(t,e,s,r,o,h,l,u,i,m),i}function cS(i,t,e,s,r,o,h,l,u,d){rl(i,t,e,s,r,o,h,l,u,d,0),u.push(h,l)}function rl(i,t,e,s,r,o,h,l,u,d,f){if(f>hS)return;const g=(i+e)/2,m=(t+s)/2,y=(e+r)/2,b=(s+o)/2,S=(r+h)/2,v=(o+l)/2,M=(g+y)/2,k=(m+b)/2,I=(y+S)/2,R=(b+v)/2,D=(M+I)/2,K=(k+R)/2;if(f>0){let H=h-i,Y=l-t;const V=Math.abs((e-h)*Y-(s-l)*H),W=Math.abs((r-h)*Y-(o-l)*H);if(V>so&&W>so){if((V+W)*(V+W)<=d*(H*H+Y*Y)){u.push(D,K);return}}else if(V>so){if(V*V<=d*(H*H+Y*Y)){u.push(D,K);return}}else if(W>so){if(W*W<=d*(H*H+Y*Y)){u.push(D,K);return}}else if(H=D-(i+h)/2,Y=K-(t+l)/2,H*H+Y*Y<=d){u.push(D,K);return}}rl(i,t,g,m,M,k,D,K,u,d,f+1),rl(D,K,I,R,S,v,h,l,u,d,f+1)}const uS=8,dS=11920929e-14,fS=1;function pS(i,t,e,s,r,o,h,l){const d=Math.min(.99,Math.max(0,l??Yp.defaultOptions.bezierSmoothness));let f=(fS-d)/1;return f*=f,gS(t,e,s,r,o,h,i,f),i}function gS(i,t,e,s,r,o,h,l){ol(h,i,t,e,s,r,o,l,0),h.push(r,o)}function ol(i,t,e,s,r,o,h,l,u){if(u>uS)return;const d=(t+s)/2,f=(e+r)/2,g=(s+o)/2,m=(r+h)/2,y=(d+g)/2,b=(f+m)/2;let S=o-t,v=h-e;const M=Math.abs((s-o)*v-(r-h)*S);if(M>dS){if(M*M<=l*(S*S+v*v)){i.push(y,b);return}}else if(S=y-(t+o)/2,v=b-(e+h)/2,S*S+v*v<=l){i.push(y,b);return}ol(i,t,e,d,f,y,b,l,u+1),ol(i,y,b,g,m,o,h,l,u+1)}function qp(i,t,e,s,r,o,h,l){let u=Math.abs(r-o);(!h&&r>o||h&&o>r)&&(u=2*Math.PI-u),l=l||Math.max(6,Math.floor(6*Math.pow(s,1/3)*(u/Math.PI))),l=Math.max(l,3);let d=u/l,f=r;d*=h?-1:1;for(let g=0;g<l+1;g++){const m=Math.cos(f),y=Math.sin(f),b=t+m*s,S=e+y*s;i.push(b,S),f+=d}}function _S(i,t,e,s,r,o){const h=i[i.length-2],u=i[i.length-1]-e,d=h-t,f=r-e,g=s-t,m=Math.abs(u*g-d*f);if(m<1e-8||o===0){(i[i.length-2]!==t||i[i.length-1]!==e)&&i.push(t,e);return}const y=u*u+d*d,b=f*f+g*g,S=u*f+d*g,v=o*Math.sqrt(y)/m,M=o*Math.sqrt(b)/m,k=v*S/y,I=M*S/b,R=v*g+M*d,D=v*f+M*u,K=d*(M+k),H=u*(M+k),Y=g*(v+I),V=f*(v+I),W=Math.atan2(H-D,K-R),Et=Math.atan2(V-D,Y-R);qp(i,R+t,D+e,o,W,Et,d*f>g*u)}const zn=Math.PI*2,Rh={centerX:0,centerY:0,ang1:0,ang2:0},Bh=({x:i,y:t},e,s,r,o,h,l,u)=>{i*=e,t*=s;const d=r*i-o*t,f=o*i+r*t;return u.x=d+h,u.y=f+l,u};function mS(i,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),s=t===1.5707963267948966?.551915024494:e,r=Math.cos(i),o=Math.sin(i),h=Math.cos(i+t),l=Math.sin(i+t);return[{x:r-o*s,y:o+r*s},{x:h+l*s,y:l-h*s},{x:h,y:l}]}const cf=(i,t,e,s)=>{const r=i*s-t*e<0?-1:1;let o=i*e+t*s;return o>1&&(o=1),o<-1&&(o=-1),r*Math.acos(o)},xS=(i,t,e,s,r,o,h,l,u,d,f,g,m)=>{const y=Math.pow(r,2),b=Math.pow(o,2),S=Math.pow(f,2),v=Math.pow(g,2);let M=y*b-y*v-b*S;M<0&&(M=0),M/=y*v+b*S,M=Math.sqrt(M)*(h===l?-1:1);const k=M*r/o*g,I=M*-o/r*f,R=d*k-u*I+(i+e)/2,D=u*k+d*I+(t+s)/2,K=(f-k)/r,H=(g-I)/o,Y=(-f-k)/r,V=(-g-I)/o,W=cf(1,0,K,H);let Et=cf(K,H,Y,V);l===0&&Et>0&&(Et-=zn),l===1&&Et<0&&(Et+=zn),m.centerX=R,m.centerY=D,m.ang1=W,m.ang2=Et};function yS(i,t,e,s,r,o,h,l=0,u=0,d=0){if(o===0||h===0)return;const f=Math.sin(l*zn/360),g=Math.cos(l*zn/360),m=g*(t-s)/2+f*(e-r)/2,y=-f*(t-s)/2+g*(e-r)/2;if(m===0&&y===0)return;o=Math.abs(o),h=Math.abs(h);const b=Math.pow(m,2)/Math.pow(o,2)+Math.pow(y,2)/Math.pow(h,2);b>1&&(o*=Math.sqrt(b),h*=Math.sqrt(b)),xS(t,e,s,r,o,h,u,d,f,g,m,y,Rh);let{ang1:S,ang2:v}=Rh;const{centerX:M,centerY:k}=Rh;let I=Math.abs(v)/(zn/4);Math.abs(1-I)<1e-7&&(I=1);const R=Math.max(Math.ceil(I),1);v/=R;let D=i[i.length-2],K=i[i.length-1];const H={x:0,y:0};for(let Y=0;Y<R;Y++){const V=mS(S,v),{x:W,y:Et}=Bh(V[0],o,h,g,f,M,k,H),{x:$e,y:it}=Bh(V[1],o,h,g,f,M,k,H),{x:J,y:Mt}=Bh(V[2],o,h,g,f,M,k,H);Xp(i,D,K,W,Et,$e,it,J,Mt),D=J,K=Mt,S+=v}}function wS(i,t,e){const s=(h,l)=>{const u=l.x-h.x,d=l.y-h.y,f=Math.sqrt(u*u+d*d),g=u/f,m=d/f;return{len:f,nx:g,ny:m}},r=(h,l)=>{h===0?i.moveTo(l.x,l.y):i.lineTo(l.x,l.y)};let o=t[t.length-1];for(let h=0;h<t.length;h++){const l=t[h%t.length],u=l.radius??e;if(u<=0){r(h,l),o=l;continue}const d=t[(h+1)%t.length],f=s(l,o),g=s(l,d);if(f.len<1e-4||g.len<1e-4){r(h,l),o=l;continue}let m=Math.asin(f.nx*g.ny-f.ny*g.nx),y=1,b=!1;f.nx*g.nx-f.ny*-g.ny<0?m<0?m=Math.PI+m:(m=Math.PI-m,y=-1,b=!0):m>0&&(y=-1,b=!0);const S=m/2;let v,M=Math.abs(Math.cos(S)*u/Math.sin(S));M>Math.min(f.len/2,g.len/2)?(M=Math.min(f.len/2,g.len/2),v=Math.abs(M*Math.sin(S)/Math.cos(S))):v=u;const k=l.x+g.nx*M+-g.ny*v*y,I=l.y+g.ny*M+g.nx*v*y,R=Math.atan2(f.ny,f.nx)+Math.PI/2*y,D=Math.atan2(g.ny,g.nx)-Math.PI/2*y;h===0&&i.moveTo(k+Math.cos(R)*v,I+Math.sin(R)*v),i.arc(k,I,v,R,D,b),o=l}}function bS(i,t,e,s){const r=(l,u)=>Math.sqrt((l.x-u.x)**2+(l.y-u.y)**2),o=(l,u,d)=>({x:l.x+(u.x-l.x)*d,y:l.y+(u.y-l.y)*d}),h=t.length;for(let l=0;l<h;l++){const u=t[(l+1)%h],d=u.radius??e;if(d<=0){l===0?i.moveTo(u.x,u.y):i.lineTo(u.x,u.y);continue}const f=t[l],g=t[(l+2)%h],m=r(f,u);let y;if(m<1e-4)y=u;else{const v=Math.min(m/2,d);y=o(u,f,v/m)}const b=r(g,u);let S;if(b<1e-4)S=u;else{const v=Math.min(b/2,d);S=o(u,g,v/b)}l===0?i.moveTo(y.x,y.y):i.lineTo(y.x,y.y),i.quadraticCurveTo(u.x,u.y,S.x,S.y,s)}}const vS=new ie;class AS{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new pi,this._graphicsPath2D=t}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const s=this._currentPoly.points,r=s[s.length-2],o=s[s.length-1];return(r!==t||o!==e)&&s.push(t,e),this}arc(t,e,s,r,o,h){this._ensurePoly(!1);const l=this._currentPoly.points;return qp(l,t,e,s,r,o,h),this}arcTo(t,e,s,r,o){this._ensurePoly();const h=this._currentPoly.points;return _S(h,t,e,s,r,o),this}arcToSvg(t,e,s,r,o,h,l){const u=this._currentPoly.points;return yS(u,this._currentPoly.lastX,this._currentPoly.lastY,h,l,t,e,s,r,o),this}bezierCurveTo(t,e,s,r,o,h,l){this._ensurePoly();const u=this._currentPoly;return Xp(this._currentPoly.points,u.lastX,u.lastY,t,e,s,r,o,h,l),this}quadraticCurveTo(t,e,s,r,o){this._ensurePoly();const h=this._currentPoly;return pS(this._currentPoly.points,h.lastX,h.lastY,t,e,s,r,o),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));for(let s=0;s<t.instructions.length;s++){const r=t.instructions[s];this[r.action](...r.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,e,s,r,o){return this.drawShape(new ie(t,e,s,r),o),this}circle(t,e,s,r){return this.drawShape(new Q1(t,e,s),r),this}poly(t,e,s){const r=new Hn(t);return r.closePath=e,this.drawShape(r,s),this}regularPoly(t,e,s,r,o=0,h){r=Math.max(r|0,3);const l=-1*Math.PI/2+o,u=Math.PI*2/r,d=[];for(let f=0;f<r;f++){const g=f*u+l;d.push(t+s*Math.cos(g),e+s*Math.sin(g))}return this.poly(d,!0,h),this}roundPoly(t,e,s,r,o,h=0,l){if(r=Math.max(r|0,3),o<=0)return this.regularPoly(t,e,s,r,h);const u=s*Math.sin(Math.PI/r)-.001;o=Math.min(o,u);const d=-1*Math.PI/2+h,f=Math.PI*2/r,g=(r-2)*Math.PI/r/2;for(let m=0;m<r;m++){const y=m*f+d,b=t+s*Math.cos(y),S=e+s*Math.sin(y),v=y+Math.PI+g,M=y-Math.PI-g,k=b+o*Math.cos(v),I=S+o*Math.sin(v),R=b+o*Math.cos(M),D=S+o*Math.sin(M);m===0?this.moveTo(k,I):this.lineTo(k,I),this.quadraticCurveTo(b,S,R,D,l)}return this.closePath()}roundShape(t,e,s=!1,r){return t.length<3?this:(s?bS(this,t,e,r):wS(this,t,e),this.closePath())}filletRect(t,e,s,r,o){if(o===0)return this.rect(t,e,s,r);const h=Math.min(s,r)/2,l=Math.min(h,Math.max(-h,o)),u=t+s,d=e+r,f=l<0?-l:0,g=Math.abs(l);return this.moveTo(t,e+g).arcTo(t+f,e+f,t+g,e,g).lineTo(u-g,e).arcTo(u-f,e+f,u,e+g,g).lineTo(u,d-g).arcTo(u-f,d-f,t+s-g,d,g).lineTo(t+g,d).arcTo(t+f,d-f,t,d-g,g).closePath()}chamferRect(t,e,s,r,o,h){if(o<=0)return this.rect(t,e,s,r);const l=Math.min(o,Math.min(s,r)/2),u=t+s,d=e+r,f=[t+l,e,u-l,e,u,e+l,u,d-l,u-l,d,t+l,d,t,d-l,t,e+l];for(let g=f.length-1;g>=2;g-=2)f[g]===f[g-2]&&f[g-1]===f[g-3]&&f.splice(g-1,2);return this.poly(f,!0,h)}ellipse(t,e,s,r,o){return this.drawShape(new Cl(t,e,s,r),o),this}roundRect(t,e,s,r,o,h){return this.drawShape(new Pl(t,e,s,r,o),h),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let s=this._currentPoly;return s&&this.endPoly(),s=new Hn,s.points.push(t,e),this._currentPoly=s,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new Hn,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let s=e.shape.x,r=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const o=e.transform,h=s;s=o.a*s+o.c*r+o.tx,r=o.b*h+o.d*r+o.ty}this._currentPoly.points.push(s,r)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const s=t.instructions[e];this[s.action](...s.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let s=0;s<e.length;s++){const r=e[s],o=r.shape.getBounds(vS);r.transform?t.addRect(o,r.transform):t.addRect(o)}return t}}class an{constructor(t){this.instructions=[],this.uid=Qt("graphicsPath"),this._dirty=!0,typeof t=="string"?Z1(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new AS(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,s,r,o){const h=this.instructions[this.instructions.length-1],l=this.getLastPoint(at.shared);let u=0,d=0;if(!h||h.action!=="bezierCurveTo")u=l.x,d=l.y;else{u=h.data[2],d=h.data[3];const f=l.x,g=l.y;u=f+(f-u),d=g+(g-d)}return this.instructions.push({action:"bezierCurveTo",data:[u,d,t,e,s,r,o]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,s){const r=this.instructions[this.instructions.length-1],o=this.getLastPoint(at.shared);let h=0,l=0;if(!r||r.action!=="quadraticCurveTo")h=o.x,l=o.y;else{h=r.data[0],l=r.data[1];const u=o.x,d=o.y;h=u+(u-h),l=d+(d-l)}return this.instructions.push({action:"quadraticCurveTo",data:[h,l,t,e,s]}),this._dirty=!0,this}rect(t,e,s,r,o){return this.instructions.push({action:"rect",data:[t,e,s,r,o]}),this._dirty=!0,this}circle(t,e,s,r){return this.instructions.push({action:"circle",data:[t,e,s,r]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,s,r,o,h,l){o=o||r/2;const u=-1*Math.PI/2+h,d=s*2,f=Math.PI*2/d,g=[];for(let m=0;m<d;m++){const y=m%2?o:r,b=m*f+u;g.push(t+y*Math.cos(b),e+y*Math.sin(b))}return this.poly(g,!0,l),this}clone(t=!1){const e=new an;if(!t)e.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const r=this.instructions[s];e.instructions.push({action:r.action,data:r.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,s=t.b,r=t.c,o=t.d,h=t.tx,l=t.ty;let u=0,d=0,f=0,g=0,m=0,y=0,b=0,S=0;for(let v=0;v<this.instructions.length;v++){const M=this.instructions[v],k=M.data;switch(M.action){case"moveTo":case"lineTo":u=k[0],d=k[1],k[0]=e*u+r*d+h,k[1]=s*u+o*d+l;break;case"bezierCurveTo":f=k[0],g=k[1],m=k[2],y=k[3],u=k[4],d=k[5],k[0]=e*f+r*g+h,k[1]=s*f+o*g+l,k[2]=e*m+r*y+h,k[3]=s*m+o*y+l,k[4]=e*u+r*d+h,k[5]=s*u+o*d+l;break;case"quadraticCurveTo":f=k[0],g=k[1],u=k[2],d=k[3],k[0]=e*f+r*g+h,k[1]=s*f+o*g+l,k[2]=e*u+r*d+h,k[3]=s*u+o*d+l;break;case"arcToSvg":u=k[5],d=k[6],b=k[0],S=k[1],k[0]=e*b+r*S,k[1]=s*b+o*S,k[5]=e*u+r*d+h,k[6]=s*u+o*d+l;break;case"circle":k[4]=Bn(k[3],t);break;case"rect":k[4]=Bn(k[4],t);break;case"ellipse":k[8]=Bn(k[8],t);break;case"roundRect":k[5]=Bn(k[5],t);break;case"addPath":k[0].transform(t);break;case"poly":k[2]=Bn(k[2],t);break;default:Yt("unknown transform action",M.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,s=this.instructions[e];if(!s)return t.x=0,t.y=0,t;for(;s.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;s=this.instructions[e]}switch(s.action){case"moveTo":case"lineTo":t.x=s.data[0],t.y=s.data[1];break;case"quadraticCurveTo":t.x=s.data[2],t.y=s.data[3];break;case"bezierCurveTo":t.x=s.data[4],t.y=s.data[5];break;case"arc":case"arcToSvg":t.x=s.data[5],t.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(t);break}return t}}function Bn(i,t){return i?i.prepend(t):t.clone()}function SS(i,t){if(typeof i=="string"){const s=document.createElement("div");s.innerHTML=i.trim(),i=s.querySelector("svg")}const e={context:t,path:new an};return jp(i,e,null,null),t}function jp(i,t,e,s){const r=i.children,{fillStyle:o,strokeStyle:h}=CS(i);o&&e?e={...e,...o}:o&&(e=o),h&&s?s={...s,...h}:h&&(s=h),t.context.fillStyle=e,t.context.strokeStyle=s;let l,u,d,f,g,m,y,b,S,v,M,k,I,R,D,K,H;switch(i.nodeName.toLowerCase()){case"path":R=i.getAttribute("d"),D=new an(R),t.context.path(D),e&&t.context.fill(),s&&t.context.stroke();break;case"circle":y=te(i,"cx",0),b=te(i,"cy",0),S=te(i,"r",0),t.context.ellipse(y,b,S,S),e&&t.context.fill(),s&&t.context.stroke();break;case"rect":l=te(i,"x",0),u=te(i,"y",0),K=te(i,"width",0),H=te(i,"height",0),v=te(i,"rx",0),M=te(i,"ry",0),v||M?t.context.roundRect(l,u,K,H,v||M):t.context.rect(l,u,K,H),e&&t.context.fill(),s&&t.context.stroke();break;case"ellipse":y=te(i,"cx",0),b=te(i,"cy",0),v=te(i,"rx",0),M=te(i,"ry",0),t.context.beginPath(),t.context.ellipse(y,b,v,M),e&&t.context.fill(),s&&t.context.stroke();break;case"line":d=te(i,"x1",0),f=te(i,"y1",0),g=te(i,"x2",0),m=te(i,"y2",0),t.context.beginPath(),t.context.moveTo(d,f),t.context.lineTo(g,m),s&&t.context.stroke();break;case"polygon":I=i.getAttribute("points"),k=I.match(/\d+/g).map(Y=>parseInt(Y,10)),t.context.poly(k,!0),e&&t.context.fill(),s&&t.context.stroke();break;case"polyline":I=i.getAttribute("points"),k=I.match(/\d+/g).map(Y=>parseInt(Y,10)),t.context.poly(k,!1),s&&t.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${i.nodeName}> elements unsupported`);break}}for(let Y=0;Y<r.length;Y++)jp(r[Y],t,e,s)}function te(i,t,e){const s=i.getAttribute(t);return s?Number(s):e}function CS(i){const t=i.getAttribute("style"),e={},s={};let r=!1,o=!1;if(t){const h=t.split(";");for(let l=0;l<h.length;l++){const u=h[l],[d,f]=u.split(":");switch(d){case"stroke":f!=="none"&&(e.color=$t.shared.setValue(f).toNumber(),o=!0);break;case"stroke-width":e.width=Number(f);break;case"fill":f!=="none"&&(r=!0,s.color=$t.shared.setValue(f).toNumber());break;case"fill-opacity":s.alpha=Number(f);break;case"stroke-opacity":e.alpha=Number(f);break;case"opacity":s.alpha=Number(f),e.alpha=Number(f);break}}}else{const h=i.getAttribute("stroke");h&&h!=="none"&&(o=!0,e.color=$t.shared.setValue(h).toNumber(),e.width=te(i,"stroke-width",1));const l=i.getAttribute("fill");l&&l!=="none"&&(r=!0,s.color=$t.shared.setValue(l).toNumber())}return{strokeStyle:o?e:null,fillStyle:r?s:null}}function PS(i){return $t.isColorLike(i)}function uf(i){return i instanceof So}function df(i){return i instanceof Kn}function MS(i,t,e){const s=$t.shared.setValue(t??0);return i.color=s.toNumber(),i.alpha=s.alpha===1?e.alpha:s.alpha,i.texture=ft.WHITE,{...e,...i}}function ff(i,t,e){return i.fill=t,i.color=16777215,i.texture=t.texture,i.matrix=t.transform,{...e,...i}}function pf(i,t,e){return t.buildLinearGradient(),i.fill=t,i.color=16777215,i.texture=t.texture,i.matrix=t.transform,{...e,...i}}function TS(i,t){var r;const e={...t,...i};if(e.texture){if(e.texture!==ft.WHITE){const h=((r=e.matrix)==null?void 0:r.invert())||new yt;h.translate(e.texture.frame.x,e.texture.frame.y),h.scale(1/e.texture.source.width,1/e.texture.source.height),e.matrix=h}const o=e.texture.source.style;o.addressMode==="clamp-to-edge"&&(o.addressMode="repeat",o.update())}const s=$t.shared.setValue(e.color);return e.alpha*=s.alpha,e.color=s.toNumber(),e.matrix=e.matrix?e.matrix.clone():null,e}function Ss(i,t){if(i==null)return null;const e={},s=i;return PS(i)?MS(e,i,t):uf(i)?ff(e,i,t):df(i)?pf(e,i,t):s.fill&&uf(s.fill)?ff(s,s.fill,t):s.fill&&df(s.fill)?pf(s,s.fill,t):TS(s,t)}function mo(i,t){const{width:e,alignment:s,miterLimit:r,cap:o,join:h,...l}=t,u=Ss(i,l);return u?{width:e,alignment:s,miterLimit:r,cap:o,join:h,...u}:null}const IS=new at,gf=new yt,Tl=class di extends ii{constructor(){super(...arguments),this.uid=Qt("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new an,this._transform=new yt,this._fillStyle={...di.defaultFillStyle},this._strokeStyle={...di.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new pi,this._boundsDirty=!0}clone(){const t=new di;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Ss(t,di.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=mo(t,di.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Ss(t,di.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Ss(t,di.defaultStrokeStyle),this}texture(t,e,s,r,o,h){return this.instructions.push({action:"texture",data:{image:t,dx:s||0,dy:r||0,dw:o||t.frame.width,dh:h||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?$t.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new an,this}fill(t,e){let s;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r&&r.action==="stroke"?s=r.data.path:s=this._activePath.clone(),s?(t!=null&&(e!==void 0&&typeof t=="number"&&(gt(xt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=Ss(t,di.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(at.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s&&s.action==="fill"?e=s.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=mo(t,di.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],s=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(s);else{e.data.hole=s;break}}return this._initNextPathLocation(),this}arc(t,e,s,r,o,h){this._tick++;const l=this._transform;return this._activePath.arc(l.a*t+l.c*e+l.tx,l.b*t+l.d*e+l.ty,s,r,o,h),this}arcTo(t,e,s,r,o){this._tick++;const h=this._transform;return this._activePath.arcTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*s+h.c*r+h.tx,h.b*s+h.d*r+h.ty,o),this}arcToSvg(t,e,s,r,o,h,l){this._tick++;const u=this._transform;return this._activePath.arcToSvg(t,e,s,r,o,u.a*h+u.c*l+u.tx,u.b*h+u.d*l+u.ty),this}bezierCurveTo(t,e,s,r,o,h,l){this._tick++;const u=this._transform;return this._activePath.bezierCurveTo(u.a*t+u.c*e+u.tx,u.b*t+u.d*e+u.ty,u.a*s+u.c*r+u.tx,u.b*s+u.d*r+u.ty,u.a*o+u.c*h+u.tx,u.b*o+u.d*h+u.ty,l),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,s,r){return this._tick++,this._activePath.ellipse(t,e,s,r,this._transform.clone()),this}circle(t,e,s){return this._tick++,this._activePath.circle(t,e,s,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*t+s.c*e+s.tx,s.b*t+s.d*e+s.ty),this}moveTo(t,e){this._tick++;const s=this._transform,r=this._activePath.instructions,o=s.a*t+s.c*e+s.tx,h=s.b*t+s.d*e+s.ty;return r.length===1&&r[0].action==="moveTo"?(r[0].data[0]=o,r[0].data[1]=h,this):(this._activePath.moveTo(o,h),this)}quadraticCurveTo(t,e,s,r,o){this._tick++;const h=this._transform;return this._activePath.quadraticCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*s+h.c*r+h.tx,h.b*s+h.d*r+h.ty,o),this}rect(t,e,s,r){return this._tick++,this._activePath.rect(t,e,s,r,this._transform.clone()),this}roundRect(t,e,s,r,o){return this._tick++,this._activePath.roundRect(t,e,s,r,o,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,s,r,o=0,h){return this._tick++,this._activePath.regularPoly(t,e,s,r,o,h),this}roundPoly(t,e,s,r,o,h){return this._tick++,this._activePath.roundPoly(t,e,s,r,o,h),this}roundShape(t,e,s,r){return this._tick++,this._activePath.roundShape(t,e,s,r),this}filletRect(t,e,s,r,o){return this._tick++,this._activePath.filletRect(t,e,s,r,o),this}chamferRect(t,e,s,r,o,h){return this._tick++,this._activePath.chamferRect(t,e,s,r,o,h),this}star(t,e,s,r,o=0,h=0){return this._tick++,this._activePath.star(t,e,s,r,o,h,this._transform.clone()),this}svg(t){return this._tick++,SS(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,s,r,o,h){return t instanceof yt?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,s,r,o,h),this)}transform(t,e,s,r,o,h){return t instanceof yt?(this._transform.append(t),this):(gf.set(t,e,s,r,o,h),this._transform.append(gf),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this._boundsDirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const s=this.instructions[e],r=s.action;if(r==="fill"){const o=s.data;t.addBounds(o.path.bounds)}else if(r==="texture"){const o=s.data;t.addFrame(o.dx,o.dy,o.dx+o.dw,o.dy+o.dh,o.transform)}if(r==="stroke"){const o=s.data,h=o.style.width/2,l=o.path.bounds;t.addFrame(l.minX-h,l.minY-h,l.maxX+h,l.maxY+h)}}return t}containsPoint(t){var r;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let s=!1;for(let o=0;o<e.length;o++){const h=e[o],l=h.data,u=l.path;if(!h.action||!u)continue;const d=l.style,f=u.shapePath.shapePrimitives;for(let g=0;g<f.length;g++){const m=f[g].shape;if(!d||!m)continue;const y=f[g].transform,b=y?y.applyInverse(t,IS):t;h.action==="fill"?s=m.contains(b.x,b.y):s=m.strokeContains(b.x,b.y,d.width);const S=l.hole;if(S){const v=(r=S.shapePath)==null?void 0:r.shapePrimitives;if(v)for(let M=0;M<v.length;M++)v[M].shape.contains(b.x,b.y)&&(s=!1)}if(s)return!0}}return s}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(s),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(s)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Tl.defaultFillStyle={color:16777215,alpha:1,texture:ft.WHITE,matrix:null,fill:null};Tl.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:ft.WHITE,matrix:null,fill:null};let He=Tl;const _f=["align","breakWords","cssOverrides","fontVariant","fontWeight","leading","letterSpacing","lineHeight","padding","textBaseline","trim","whiteSpace","wordWrap","wordWrapWidth","fontFamily","fontStyle","fontSize"];function kS(i){const t=[];let e=0;for(let s=0;s<_f.length;s++){const r=`_${_f[s]}`;t[e++]=i[r]}return e=Kp(i._fill,t,e),e=ES(i._stroke,t,e),e=RS(i.dropShadow,t,e),t.join("-")}function Kp(i,t,e){var s;return i&&(t[e++]=i.color,t[e++]=i.alpha,t[e++]=(s=i.fill)==null?void 0:s.styleKey),e}function ES(i,t,e){return i&&(e=Kp(i,t,e),t[e++]=i.width,t[e++]=i.alignment,t[e++]=i.cap,t[e++]=i.join,t[e++]=i.miterLimit),e}function RS(i,t,e){return i&&(t[e++]=i.alpha,t[e++]=i.angle,t[e++]=i.blur,t[e++]=i.distance,t[e++]=$t.shared.setValue(i.color).toNumber()),e}const Il=class Zs extends ii{constructor(t={}){super(),BS(t);const e={...Zs.defaultTextStyle,...t};for(const s in e){const r=s;this[r]=e[s]}this.update()}get align(){return this._align}set align(t){this._align=t,this.update()}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords=t,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...Zs.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...Zs.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily=t,this.update()}get fontSize(){return this._fontSize}set fontSize(t){typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle=t.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant=t,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight=t,this.update()}get leading(){return this._leading}set leading(t){this._leading=t,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing=t,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight=t,this.update()}get padding(){return this._padding}set padding(t){this._padding=t,this.update()}get trim(){return this._trim}set trim(t){this._trim=t,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline=t,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace=t,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap=t,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth=t,this.update()}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...He.defaultFillStyle,...t},()=>{this._fill=Ss({...this._originalFill},He.defaultFillStyle)})),this._fill=Ss(t===0?"black":t,He.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...He.defaultStrokeStyle,...t},()=>{this._stroke=mo({...this._originalStroke},He.defaultStrokeStyle)})),this._stroke=mo(t,He.defaultStrokeStyle),this.update())}_generateKey(){return this._styleKey=kS(this),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}reset(){const t=Zs.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return this._styleKey||this._generateKey()}clone(){return new Zs({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){var s,r,o,h;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const l=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(s=this._fill)!=null&&s.texture&&this._fill.texture.destroy(l),(r=this._originalFill)!=null&&r.texture&&this._originalFill.texture.destroy(l),(o=this._stroke)!=null&&o.texture&&this._stroke.texture.destroy(l),(h=this._originalStroke)!=null&&h.texture&&this._originalStroke.texture.destroy(l)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(s,r,o)=>(s[r]=o,e==null||e(r,o),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!($t.isColorLike(t)||t instanceof Kn||t instanceof So)}};Il.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Il.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Is=Il;function BS(i){const t=i;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=Is.defaultDropShadow;i.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){gt(xt,"strokeThickness is now a part of stroke");const e=t.stroke;let s={};if($t.isColorLike(e))s.color=e;else if(e instanceof Kn||e instanceof So)s.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))s=e;else throw new Error("Invalid stroke value.");i.stroke={...s,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){gt(xt,"gradient fill is now a fill pattern: `new FillGradient(...)`");let e;i.fontSize==null?i.fontSize=Is.defaultTextStyle.fontSize:typeof i.fontSize=="string"?e=parseInt(i.fontSize,10):e=i.fontSize;const s=new Kn(0,0,0,e*1.7),r=t.fillGradientStops.map(o=>$t.shared.setValue(o).toNumber());r.forEach((o,h)=>{const l=h/(r.length-1);s.addColorStop(l,o)}),i.fill={fill:s}}}class LS{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const s=Wt.get().createCanvas();s.width=t,s.height=e;const r=s.getContext("2d");return{canvas:s,context:r}}getOptimalCanvasAndContext(t,e,s=1){t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),t=fd(t),e=fd(e);const r=(t<<17)+(e<<1);this._canvasPool[r]||(this._canvasPool[r]=[]);let o=this._canvasPool[r].pop();return o||(o=this._createCanvasAndContext(t,e)),o}returnCanvasAndContext(t){const e=t.canvas,{width:s,height:r}=e,o=(s<<17)+(r<<1);t.context.clearRect(0,0,s,r),this._canvasPool[o].push(t)}clear(){this._canvasPool={}}}const mf=new LS,OS=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function al(i){const t=typeof i.fontSize=="number"?`${i.fontSize}px`:i.fontSize;let e=i.fontFamily;Array.isArray(i.fontFamily)||(e=i.fontFamily.split(","));for(let s=e.length-1;s>=0;s--){let r=e[s].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!OS.includes(r)&&(r=`"${r}"`),e[s]=r}return`${i.fontStyle} ${i.fontVariant} ${i.fontWeight} ${t} ${e.join(",")}`}const Lh={willReadFrequently:!0},si=class X{static get experimentalLetterSpacingSupported(){let t=X._experimentalLetterSpacingSupported;if(t!==void 0){const e=Wt.get().getCanvasRenderingContext2D().prototype;t=X._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,s,r,o,h,l,u,d){this.text=t,this.style=e,this.width=s,this.height=r,this.lines=o,this.lineWidths=h,this.lineHeight=l,this.maxLineWidth=u,this.fontProperties=d}static measureText(t=" ",e,s=X._canvas,r=e.wordWrap){var k;const o=`${t}:${e.styleKey}`;if(X._measurementCache[o])return X._measurementCache[o];const h=al(e),l=X.measureFont(h);l.fontSize===0&&(l.fontSize=e.fontSize,l.ascent=e.fontSize);const u=X.__context;u.font=h;const f=(r?X._wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),g=new Array(f.length);let m=0;for(let I=0;I<f.length;I++){const R=X._measureText(f[I],e.letterSpacing,u);g[I]=R,m=Math.max(m,R)}const y=((k=e._stroke)==null?void 0:k.width)||0;let b=m+y;e.dropShadow&&(b+=e.dropShadow.distance);const S=e.lineHeight||l.fontSize;let v=Math.max(S,l.fontSize+y)+(f.length-1)*(S+e.leading);return e.dropShadow&&(v+=e.dropShadow.distance),new X(t,e,b,v,f,g,S+e.leading,m,l)}static _measureText(t,e,s){let r=!1;X.experimentalLetterSpacingSupported&&(X.experimentalLetterSpacing?(s.letterSpacing=`${e}px`,s.textLetterSpacing=`${e}px`,r=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const o=s.measureText(t);let h=o.width;const l=-o.actualBoundingBoxLeft;let d=o.actualBoundingBoxRight-l;if(h>0)if(r)h-=e,d-=e;else{const f=(X.graphemeSegmenter(t).length-1)*e;h+=f,d+=f}return Math.max(h,d)}static _wordWrap(t,e,s=X._canvas){const r=s.getContext("2d",Lh);let o=0,h="",l="";const u=Object.create(null),{letterSpacing:d,whiteSpace:f}=e,g=X._collapseSpaces(f),m=X._collapseNewlines(f);let y=!g;const b=e.wordWrapWidth+d,S=X._tokenize(t);for(let v=0;v<S.length;v++){let M=S[v];if(X._isNewline(M)){if(!m){l+=X._addLine(h),y=!g,h="",o=0;continue}M=" "}if(g){const I=X.isBreakingSpace(M),R=X.isBreakingSpace(h[h.length-1]);if(I&&R)continue}const k=X._getFromCache(M,d,u,r);if(k>b)if(h!==""&&(l+=X._addLine(h),h="",o=0),X.canBreakWords(M,e.breakWords)){const I=X.wordWrapSplit(M);for(let R=0;R<I.length;R++){let D=I[R],K=D,H=1;for(;I[R+H];){const V=I[R+H];if(!X.canBreakChars(K,V,M,R,e.breakWords))D+=V;else break;K=V,H++}R+=H-1;const Y=X._getFromCache(D,d,u,r);Y+o>b&&(l+=X._addLine(h),y=!1,h="",o=0),h+=D,o+=Y}}else{h.length>0&&(l+=X._addLine(h),h="",o=0);const I=v===S.length-1;l+=X._addLine(M,!I),y=!1,h="",o=0}else k+o>b&&(y=!1,l+=X._addLine(h),h="",o=0),(h.length>0||!X.isBreakingSpace(M)||y)&&(h+=M,o+=k)}return l+=X._addLine(h,!1),l}static _addLine(t,e=!0){return t=X._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,s,r){let o=s[t];return typeof o!="number"&&(o=X._measureText(t,e,r)+e,s[t]=o),o}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const s=t[e];if(!X.isBreakingSpace(s))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:X._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:X._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let s="";if(typeof t!="string")return e;for(let r=0;r<t.length;r++){const o=t[r],h=t[r+1];if(X.isBreakingSpace(o,h)||X._isNewline(o)){s!==""&&(e.push(s),s=""),e.push(o);continue}s+=o}return s!==""&&e.push(s),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,s,r,o){return!0}static wordWrapSplit(t){return X.graphemeSegmenter(t)}static measureFont(t){if(X._fonts[t])return X._fonts[t];const e=X._context;e.font=t;const s=e.measureText(X.METRICS_STRING+X.BASELINE_SYMBOL),r={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return X._fonts[t]=r,r}static clearMetrics(t=""){t?delete X._fonts[t]:X._fonts={}}static get _canvas(){if(!X.__canvas){let t;try{const e=new OffscreenCanvas(0,0),s=e.getContext("2d",Lh);if(s!=null&&s.measureText)return X.__canvas=e,e;t=Wt.get().createCanvas()}catch{t=Wt.get().createCanvas()}t.width=t.height=10,X.__canvas=t}return X.__canvas}static get _context(){return X.__context||(X.__context=X._canvas.getContext("2d",Lh)),X.__context}};si.METRICS_STRING="|q";si.BASELINE_SYMBOL="M";si.BASELINE_MULTIPLIER=1.4;si.HEIGHT_MULTIPLIER=2;si.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>[...i.segment(t)].map(e=>e.segment)}return i=>[...i]})();si.experimentalLetterSpacing=!1;si._fonts={};si._newlines=[10,13];si._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];si._measurementCache={};let hl=si;function xf(i,t){if(i.texture===ft.WHITE&&!i.fill)return $t.shared.setValue(i.color).setAlpha(i.alpha??1).toHexa();if(i.fill){if(i.fill instanceof So){const e=i.fill,s=t.createPattern(e.texture.source.resource,"repeat"),r=e.transform.copyTo(yt.shared);return r.scale(e.texture.frame.width,e.texture.frame.height),s.setTransform(r),s}else if(i.fill instanceof Kn){const e=i.fill;if(e.type==="linear"){const s=t.createLinearGradient(e.x0,e.y0,e.x1,e.y1);return e.gradientStops.forEach(r=>{s.addColorStop(r.offset,$t.shared.setValue(r.color).toHex())}),s}}}else{const e=t.createPattern(i.texture.source.resource,"repeat"),s=i.matrix.copyTo(yt.shared);return s.scale(i.texture.frame.width,i.texture.frame.height),e.setTransform(s),e}return Yt("FillStyle not recognised",i),"red"}function Zp(i){if(i==="")return[];typeof i=="string"&&(i=[i]);const t=[];for(let e=0,s=i.length;e<s;e++){const r=i[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);if(r[0].length===0||r[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const o=r[0].charCodeAt(0),h=r[1].charCodeAt(0);if(h<o)throw new Error("[BitmapFont]: Invalid character range.");for(let l=o,u=h;l<=u;l++)t.push(String.fromCharCode(l))}else t.push(...Array.from(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Qp=class Jp extends kp{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...Jp.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const s=e.style.clone();e.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=ft.WHITE,s._fill.fill=null),this.applyFillAsTint=e.overrideFill;const r=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const o=al(s);e.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/r):s.fontSize=this.baseRenderedFontSize=r,this._style=s,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,this.fontMetrics=hl.measureFont(o),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(t){var b,S;const e=Zp(t).filter(v=>!this._currentChars.includes(v)).filter((v,M,k)=>k.indexOf(v)===M);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let s;this._currentPageIndex===-1?s=this._nextPage():s=this.pages[this._currentPageIndex];let{canvas:r,context:o}=s.canvasAndContext,h=s.texture.source;const l=this._style;let u=this._currentX,d=this._currentY;const f=this.baseRenderedFontSize/this.baseMeasurementFontSize,g=this._padding*f;let m=0,y=!1;for(let v=0;v<e.length;v++){const M=e[v],k=hl.measureText(M,l,r,!1),I=Math.ceil((l.fontStyle==="italic"?2:1)*k.width);k.lineHeight=k.height;const R=k.width*f,D=k.height*f,K=I+g*2,H=D+g*2;if(y=!1,M!==`
`&&M!=="\r"&&M!=="	"&&M!==" "&&(y=!0,m=Math.ceil(Math.max(H,m))),u+K>this._textureSize&&(d+=m,m=H,u=0,d+m>this._textureSize)){h.update();const V=this._nextPage();r=V.canvasAndContext.canvas,o=V.canvasAndContext.context,h=V.texture.source,d=0}const Y=R/f-(((b=l.dropShadow)==null?void 0:b.distance)??0)-(((S=l._stroke)==null?void 0:S.width)??0);if(this.chars[M]={id:M.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:Y,kerning:{}},y){this._drawGlyph(o,k,u+g,d+g,f,l);const V=h.width*f,W=h.height*f,Et=new ie(u/V*h.width,d/W*h.height,K/V*h.width,H/W*h.height);this.chars[M].texture=new ft({source:h,frame:Et}),u+=Math.ceil(K)}}h.update(),this._currentX=u,this._currentY=d,this._skipKerning&&this._applyKerning(e,o)}get pageTextures(){return gt(xt,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const s=this._measureCache;for(let r=0;r<t.length;r++){const o=t[r];for(let h=0;h<this._currentChars.length;h++){const l=this._currentChars[h];let u=s[o];u||(u=s[o]=e.measureText(o).width);let d=s[l];d||(d=s[l]=e.measureText(l).width);let f=e.measureText(o+l).width,g=f-(u+d);g&&(this.chars[o].kerning[l]=g),f=e.measureText(o+l).width,g=f-(u+d),g&&(this.chars[l].kerning[o]=g)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=mf.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const s=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),r=new ft({source:new hn({resource:e.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})}),o={canvasAndContext:e,texture:r};return this.pages[this._currentPageIndex]=o,o}_setupContext(t,e,s){e.fontSize=this.baseRenderedFontSize,t.scale(s,s),t.font=al(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const r=e._stroke,o=(r==null?void 0:r.width)??0;if(r&&(t.lineWidth=o,t.lineJoin=r.join,t.miterLimit=r.miterLimit,t.strokeStyle=xf(r,t)),e._fill&&(t.fillStyle=xf(e._fill,t)),e.dropShadow){const h=e.dropShadow,l=$t.shared.setValue(h.color).toArray(),u=h.blur*s,d=h.distance*s;t.shadowColor=`rgba(${l[0]*255},${l[1]*255},${l[2]*255},${h.alpha})`,t.shadowBlur=u,t.shadowOffsetX=Math.cos(h.angle)*d,t.shadowOffsetY=Math.sin(h.angle)*d}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,s,r,o,h){const l=e.text,u=e.fontProperties,d=h._stroke,f=((d==null?void 0:d.width)??0)*o,g=s+f/2,m=r-f/2,y=u.descent*o,b=e.lineHeight*o;h.stroke&&f&&t.strokeText(l,g,m+b-y),h._fill&&t.fillText(l,g,m+b-y)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:s}=this.pages[t];mf.returnCanvasAndContext(e),s.destroy(!0)}this.pages=null}};Qp.defaultOptions={textureSize:512,style:new Is,mipmap:!0};let yf=Qp;function FS(i,t,e,s){const r={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};r.offsetY=e.baseLineOffset;let o=r.lines[0],h=null,l=!0;const u={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},d=b=>{const S=o.width;for(let v=0;v<u.index;v++){const M=b.positions[v];o.chars.push(b.chars[v]),o.charPositions.push(M+S)}o.width+=b.width,l=!1,u.width=0,u.index=0,u.chars.length=0},f=()=>{let b=o.chars.length-1;if(s){let S=o.chars[b];for(;S===" ";)o.width-=e.chars[S].xAdvance,S=o.chars[--b]}r.width=Math.max(r.width,o.width),o={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},l=!0,r.lines.push(o),r.height+=e.lineHeight},g=e.baseMeasurementFontSize/t.fontSize,m=t.letterSpacing*g,y=t.wordWrapWidth*g;for(let b=0;b<i.length+1;b++){let S;const v=b===i.length;v||(S=i[b]);const M=e.chars[S]||e.chars[" "];if(/(?:\s)/.test(S)||S==="\r"||S===`
`||v){if(!l&&t.wordWrap&&o.width+u.width-m>y?(f(),d(u),v||o.charPositions.push(0)):(u.start=o.width,d(u),v||o.charPositions.push(0)),S==="\r"||S===`
`)o.width!==0&&f();else if(!v){const D=M.xAdvance+(M.kerning[h]||0)+m;o.width+=D,o.spaceWidth=D,o.spacesIndex.push(o.charPositions.length),o.chars.push(S)}}else{const R=M.kerning[h]||0,D=M.xAdvance+R+m;u.positions[u.index++]=u.width+R,u.chars.push(S),u.width+=D}h=S}return f(),t.align==="center"?US(r):t.align==="right"?VS(r):t.align==="justify"&&DS(r),r}function US(i){for(let t=0;t<i.lines.length;t++){const e=i.lines[t],s=i.width/2-e.width/2;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=s}}function VS(i){for(let t=0;t<i.lines.length;t++){const e=i.lines[t],s=i.width-e.width;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=s}}function DS(i){const t=i.width;for(let e=0;e<i.lines.length;e++){const s=i.lines[e];let r=0,o=s.spacesIndex[r++],h=0;const l=s.spacesIndex.length,d=(t-s.width)/l;for(let f=0;f<s.charPositions.length;f++)f===o&&(o=s.spacesIndex[r++],h+=d),s.charPositions[f]+=h}}let no=0;class WS{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1}}getFont(t,e){var h;let s=`${e.fontFamily}-bitmap`,r=!0;if(e._fill.fill&&!e._stroke)s+=e._fill.fill.styleKey,r=!1;else if(e._stroke||e.dropShadow){let l=e.styleKey;l=l.substring(0,l.lastIndexOf("-")),s=`${l}-bitmap`,r=!1}if(!Vt.has(s)){const l=new yf({style:e,overrideFill:r,overrideSize:!0,...this.defaultOptions});no++,no>50&&Yt("BitmapText",`You have dynamically created ${no} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),l.once("destroy",()=>{no--,Vt.remove(s)}),Vt.set(s,l)}const o=Vt.get(s);return(h=o.ensureCharacters)==null||h.call(o,t),o}getLayout(t,e,s=!0){const r=this.getFont(t,e);return FS([...t],e,r,s)}measureText(t,e,s=!0){return this.getLayout(t,e,s)}install(...t){var d,f,g,m;let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:(d=t[2])==null?void 0:d.chars,resolution:(f=t[2])==null?void 0:f.resolution,padding:(g=t[2])==null?void 0:g.padding,skipKerning:(m=t[2])==null?void 0:m.skipKerning},gt(xt,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=e==null?void 0:e.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const r=e.style,o=r instanceof Is?r:new Is(r),h=o._fill.fill!==null&&o._fill.fill!==void 0,l=new yf({style:o,overrideFill:h,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1}),u=Zp(e.chars);return l.ensureCharacters(u.join("")),Vt.set(`${s}-bitmap`,l),l.once("destroy",()=>Vt.remove(`${s}-bitmap`)),l}uninstall(t){const e=`${t}-bitmap`,s=Vt.get(e);s&&s.destroy()}}const wf=new WS;class tg extends kp{constructor(t,e){super();const{textures:s,data:r}=t;Object.keys(r.pages).forEach(o=>{const h=r.pages[parseInt(o,10)],l=s[h.id];this.pages.push({texture:l})}),Object.keys(r.chars).forEach(o=>{const h=r.chars[o],{frame:l,source:u}=s[h.page],d=new ie(h.x+l.x,h.y+l.y,h.width,h.height),f=new ft({source:u,frame:d});this.chars[o]={id:o.codePointAt(0),xOffset:h.xOffset,yOffset:h.yOffset,xAdvance:h.xAdvance,kerning:h.kerning??{},texture:f}}),this.baseRenderedFontSize=r.fontSize,this.baseMeasurementFontSize=r.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:r.fontSize},this.baseLineOffset=r.baseLineOffset,this.lineHeight=r.lineHeight,this.fontFamily=r.fontFamily,this.distanceField=r.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){wf.install(t)}static uninstall(t){wf.uninstall(t)}}const Oh={test(i){return typeof i=="string"&&i.startsWith("info face=")},parse(i){const t=i.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const g in t){const m=t[g].match(/^[a-z]+/gm)[0],y=t[g].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),b={};for(const S in y){const v=y[S].split("="),M=v[0],k=v[1].replace(/"/gm,""),I=parseFloat(k),R=isNaN(I)?k:I;b[M]=R}e[m].push(b)}const s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[r]=e.info,[o]=e.common,[h]=e.distanceField??[];h&&(s.distanceField={range:parseInt(h.distanceRange,10),type:h.fieldType}),s.fontSize=parseInt(r.size,10),s.fontFamily=r.face,s.lineHeight=parseInt(o.lineHeight,10);const l=e.page;for(let g=0;g<l.length;g++)s.pages.push({id:parseInt(l[g].id,10)||0,file:l[g].file});const u={};s.baseLineOffset=s.lineHeight-parseInt(o.base,10);const d=e.char;for(let g=0;g<d.length;g++){const m=d[g],y=parseInt(m.id,10);let b=m.letter??m.char??String.fromCharCode(y);b==="space"&&(b=" "),u[y]=b,s.chars[b]={id:y,page:parseInt(m.page,10)||0,x:parseInt(m.x,10),y:parseInt(m.y,10),width:parseInt(m.width,10),height:parseInt(m.height,10),xOffset:parseInt(m.xoffset,10),yOffset:parseInt(m.yoffset,10),xAdvance:parseInt(m.xadvance,10),kerning:{}}}const f=e.kerning||[];for(let g=0;g<f.length;g++){const m=parseInt(f[g].first,10),y=parseInt(f[g].second,10),b=parseInt(f[g].amount,10);s.chars[u[y]].kerning[u[m]]=b}return s}},bf={test(i){const t=i;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(i){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=i.getElementsByTagName("info")[0],s=i.getElementsByTagName("common")[0],r=i.getElementsByTagName("distanceField")[0];r&&(t.distanceField={type:r.getAttribute("fieldType"),range:parseInt(r.getAttribute("distanceRange"),10)});const o=i.getElementsByTagName("page"),h=i.getElementsByTagName("char"),l=i.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(s.getAttribute("lineHeight"),10);for(let d=0;d<o.length;d++)t.pages.push({id:parseInt(o[d].getAttribute("id"),10)||0,file:o[d].getAttribute("file")});const u={};t.baseLineOffset=t.lineHeight-parseInt(s.getAttribute("base"),10);for(let d=0;d<h.length;d++){const f=h[d],g=parseInt(f.getAttribute("id"),10);let m=f.getAttribute("letter")??f.getAttribute("char")??String.fromCharCode(g);m==="space"&&(m=" "),u[g]=m,t.chars[m]={id:g,page:parseInt(f.getAttribute("page"),10)||0,x:parseInt(f.getAttribute("x"),10),y:parseInt(f.getAttribute("y"),10),width:parseInt(f.getAttribute("width"),10),height:parseInt(f.getAttribute("height"),10),xOffset:parseInt(f.getAttribute("xoffset"),10),yOffset:parseInt(f.getAttribute("yoffset"),10),xAdvance:parseInt(f.getAttribute("xadvance"),10),kerning:{}}}for(let d=0;d<l.length;d++){const f=parseInt(l[d].getAttribute("first"),10),g=parseInt(l[d].getAttribute("second"),10),m=parseInt(l[d].getAttribute("amount"),10);t.chars[u[g]].kerning[u[f]]=m}return t}},vf={test(i){return typeof i=="string"&&i.includes("<font>")?bf.test(Wt.get().parseXML(i)):!1},parse(i){return bf.parse(Wt.get().parseXML(i))}},NS=[".xml",".fnt"],GS={extension:{type:q.CacheParser,name:"cacheBitmapFont"},test:i=>i instanceof tg,getCacheableAssets(i,t){const e={};return i.forEach(s=>{e[s]=t,e[`${s}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},HS={extension:{type:q.LoadParser,priority:ns.Normal},name:"loadBitmapFont",test(i){return NS.includes(Re.extname(i).toLowerCase())},async testParse(i){return Oh.test(i)||vf.test(i)},async parse(i,t,e){const s=Oh.test(i)?Oh.parse(i):vf.parse(i),{src:r}=t,{pages:o}=s,h=[],l=s.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let g=0;g<o.length;++g){const m=o[g].file;let y=Re.join(Re.dirname(r),m);y=qh(y,r),h.push({src:y,data:l})}const u=await e.load(h),d=h.map(g=>u[g.src]);return new tg({data:s,textures:d},r)},async load(i,t){return await(await Wt.get().fetch(i)).text()},async unload(i,t,e){await Promise.all(i.pages.map(s=>e.unload(s.texture.source._sourceOrigin))),i.destroy()}};class zS{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const $S={extension:{type:q.CacheParser,name:"cacheTextureArray"},test:i=>Array.isArray(i)&&i.every(t=>t instanceof ft),getCacheableAssets:(i,t)=>{const e={};return i.forEach(s=>{t.forEach((r,o)=>{e[s+(o===0?"":o+1)]=r})}),e}};async function eg(i){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=i});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(i)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const YS={extension:{type:q.DetectionParser,priority:1},test:async()=>eg("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")},Af=["png","jpg","jpeg"],XS={extension:{type:q.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...Af],remove:async i=>i.filter(t=>!Af.includes(t))},qS="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function kl(i){return qS?!1:document.createElement("video").canPlayType(i)!==""}const jS={extension:{type:q.DetectionParser,priority:0},test:async()=>kl("video/mp4"),add:async i=>[...i,"mp4","m4v"],remove:async i=>i.filter(t=>t!=="mp4"&&t!=="m4v")},KS={extension:{type:q.DetectionParser,priority:0},test:async()=>kl("video/ogg"),add:async i=>[...i,"ogv"],remove:async i=>i.filter(t=>t!=="ogv")},ZS={extension:{type:q.DetectionParser,priority:0},test:async()=>kl("video/webm"),add:async i=>[...i,"webm"],remove:async i=>i.filter(t=>t!=="webm")},QS={extension:{type:q.DetectionParser,priority:0},test:async()=>eg("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};class JS{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,s)=>(this._parsersValidated=!1,t[e]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{var h,l;let r=null,o=null;if(e.loadParser&&(o=this._parserHash[e.loadParser],o||Yt(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!o){for(let u=0;u<this.parsers.length;u++){const d=this.parsers[u];if(d.load&&((h=d.test)!=null&&h.call(d,t,e,this))){o=d;break}}if(!o)return Yt(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await o.load(t,e,this),s.parser=o;for(let u=0;u<this.parsers.length;u++){const d=this.parsers[u];d.parse&&d.parse&&await((l=d.testParse)==null?void 0:l.call(d,r,e,this))&&(r=await d.parse(r,e,this)||r,s.parser=d)}return r})(),s}async load(t,e){this._parsersValidated||this._validateParsers();let s=0;const r={},o=_o(t),h=ei(t,d=>({alias:[d],src:d,data:{}})),l=h.length,u=h.map(async d=>{const f=Re.toAbsolute(d.src);if(!r[d.src])try{this.promiseCache[f]||(this.promiseCache[f]=this._getLoadPromiseAndParser(f,d)),r[d.src]=await this.promiseCache[f].promise,e&&e(++s/l)}catch(g){throw delete this.promiseCache[f],delete r[d.src],new Error(`[Loader.load] Failed to load ${f}.
${g}`)}});return await Promise.all(u),o?r[h[0].src]:r}async unload(t){const s=ei(t,r=>({alias:[r],src:r})).map(async r=>{var l,u;const o=Re.toAbsolute(r.src),h=this.promiseCache[o];if(h){const d=await h.promise;delete this.promiseCache[o],await((u=(l=h.parser)==null?void 0:l.unload)==null?void 0:u.call(l,d,r,this))}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(e.name?t[e.name]&&Yt(`[Assets] loadParser name conflict "${e.name}"`):Yt("[Assets] loadParser should have a name"),{...t,[e.name]:e}),{})}}function cn(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function un(i,t){const e=i.split("?")[0],s=Re.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const tC=".json",eC="application/json",iC={extension:{type:q.LoadParser,priority:ns.Low},name:"loadJson",test(i){return cn(i,eC)||un(i,tC)},async load(i){return await(await Wt.get().fetch(i)).json()}},sC=".txt",nC="text/plain",rC={name:"loadTxt",extension:{type:q.LoadParser,priority:ns.Low,name:"loadTxt"},test(i){return cn(i,nC)||un(i,sC)},async load(i){return await(await Wt.get().fetch(i)).text()}},oC=["normal","bold","100","200","300","400","500","600","700","800","900"],aC=[".ttf",".otf",".woff",".woff2"],hC=["font/ttf","font/otf","font/woff","font/woff2"],lC=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function cC(i){const t=Re.extname(i),r=Re.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(l=>l.charAt(0).toUpperCase()+l.slice(1));let o=r.length>0;for(const l of r)if(!l.match(lC)){o=!1;break}let h=r.join(" ");return o||(h=`"${h.replace(/[\\"]/g,"\\$&")}"`),h}const uC=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function dC(i){return uC.test(i)?i:encodeURI(i)}const fC={extension:{type:q.LoadParser,priority:ns.Low},name:"loadWebFont",test(i){return cn(i,hC)||un(i,aC)},async load(i,t){var s,r,o;const e=Wt.get().getFontFaceSet();if(e){const h=[],l=((s=t.data)==null?void 0:s.family)??cC(i),u=((o=(r=t.data)==null?void 0:r.weights)==null?void 0:o.filter(f=>oC.includes(f)))??["normal"],d=t.data??{};for(let f=0;f<u.length;f++){const g=u[f],m=new FontFace(l,`url(${dC(i)})`,{...d,weight:g});await m.load(),e.add(m),h.push(m)}return Vt.set(`${l}-and-url`,{url:i,fontFaces:h}),h.length===1?h[0]:h}return Yt("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>{Vt.remove(t.family),Wt.get().getFontFaceSet().delete(t)})}};function El(i,t=1){var s;const e=(s=ln.RETINA_PREFIX)==null?void 0:s.exec(i);return e?parseFloat(e[1]):t}function Rl(i,t,e){i.label=e,i._sourceOrigin=e;const s=new ft({source:i,label:e}),r=()=>{delete t.promiseCache[e],Vt.has(e)&&Vt.remove(e)};return s.source.once("destroy",()=>{t.promiseCache[e]&&(Yt("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),r())}),s.once("destroy",()=>{i.destroyed||(Yt("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),s}const pC=".svg",gC="image/svg+xml",_C={extension:{type:q.LoadParser,priority:ns.Low,name:"loadSVG"},name:"loadSVG",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(i){return cn(i,gC)||un(i,pC)},async load(i,t,e){return t.data.parseAsGraphicsContext??this.config.parseAsGraphicsContext?xC(i):mC(i,t,e,this.config.crossOrigin)},unload(i){i.destroy(!0)}};async function mC(i,t,e,s){var v,M,k;const o=await(await Wt.get().fetch(i)).blob(),h=URL.createObjectURL(o),l=new Image;l.src=h,l.crossOrigin=s,await l.decode(),URL.revokeObjectURL(h);const u=document.createElement("canvas"),d=u.getContext("2d"),f=((v=t.data)==null?void 0:v.resolution)||El(i),g=((M=t.data)==null?void 0:M.width)??l.width,m=((k=t.data)==null?void 0:k.height)??l.height;u.width=g*f,u.height=m*f,d.drawImage(l,0,0,g*f,m*f);const{parseAsGraphicsContext:y,...b}=t.data,S=new hn({resource:u,alphaMode:"premultiply-alpha-on-upload",resolution:f,...b});return Rl(S,e,i)}async function xC(i){const e=await(await Wt.get().fetch(i)).text(),s=new He;return s.svg(e),s}const yC=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let tn=null,ll=class{constructor(){tn||(tn=URL.createObjectURL(new Blob([yC],{type:"application/javascript"}))),this.worker=new Worker(tn)}};ll.revokeObjectURL=function(){tn&&(URL.revokeObjectURL(tn),tn=null)};const wC=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let en=null;class ig{constructor(){en||(en=URL.createObjectURL(new Blob([wC],{type:"application/javascript"}))),this.worker=new Worker(en)}}ig.revokeObjectURL=function(){en&&(URL.revokeObjectURL(en),en=null)};let Sf=0,Fh;class bC{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new ll;e.addEventListener("message",s=>{e.terminate(),ll.revokeObjectURL(),t(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var s;return this._run("loadImageBitmap",[t,(s=e==null?void 0:e.data)==null?void 0:s.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Fh===void 0&&(Fh=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<Fh&&(this._createdWorkers++,t=new ig().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const s=new Promise((r,o)=>{this._queue.push({id:t,arguments:e,resolve:r,reject:o})});return this._next(),s}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),s=e.id;this._resolveHash[Sf]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Sf++,id:s})}}const Cf=new bC,vC=[".jpeg",".jpg",".png",".webp",".avif"],AC=["image/jpeg","image/png","image/webp","image/avif"];async function SC(i,t){var r;const e=await Wt.get().fetch(i);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${e.status} ${e.statusText}`);const s=await e.blob();return((r=t==null?void 0:t.data)==null?void 0:r.alphaMode)==="premultiplied-alpha"?createImageBitmap(s,{premultiplyAlpha:"none"}):createImageBitmap(s)}const sg={name:"loadTextures",extension:{type:q.LoadParser,priority:ns.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(i){return cn(i,AC)||un(i,vC)},async load(i,t,e){var o;let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Cf.isImageBitmapSupported()?s=await Cf.loadImageBitmap(i,t):s=await SC(i,t):s=await new Promise(h=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=i,s.complete?h(s):s.onload=()=>{h(s)}});const r=new hn({resource:s,alphaMode:"premultiply-alpha-on-upload",resolution:((o=t.data)==null?void 0:o.resolution)||El(i),...t.data});return Rl(r,e,i)},unload(i){i.destroy(!0)}},ng=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"],CC=ng.map(i=>`video/${i.substring(1)}`);function PC(i,t,e){e===void 0&&!t.startsWith("data:")?i.crossOrigin=TC(t):e!==!1&&(i.crossOrigin=typeof e=="string"?e:"anonymous")}function MC(i){return new Promise((t,e)=>{i.addEventListener("canplaythrough",s),i.addEventListener("error",r),i.load();function s(){o(),t()}function r(h){o(),e(h)}function o(){i.removeEventListener("canplaythrough",s),i.removeEventListener("error",r)}})}function TC(i,t=globalThis.location){if(i.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(i,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}const IC={name:"loadVideo",extension:{type:q.LoadParser,name:"loadVideo"},test(i){const t=cn(i,CC),e=un(i,ng);return t||e},async load(i,t,e){var u,d;const s={...ho.defaultOptions,resolution:((u=t.data)==null?void 0:u.resolution)||El(i),alphaMode:((d=t.data)==null?void 0:d.alphaMode)||await op(),...t.data},r=document.createElement("video"),o={preload:s.autoLoad!==!1?"auto":void 0,"webkit-playsinline":s.playsinline!==!1?"":void 0,playsinline:s.playsinline!==!1?"":void 0,muted:s.muted===!0?"":void 0,loop:s.loop===!0?"":void 0,autoplay:s.autoPlay!==!1?"":void 0};Object.keys(o).forEach(f=>{const g=o[f];g!==void 0&&r.setAttribute(f,g)}),s.muted===!0&&(r.muted=!0),PC(r,i,s.crossorigin);const h=document.createElement("source");let l;if(i.startsWith("data:"))l=i.slice(5,i.indexOf(";"));else if(!i.startsWith("blob:")){const f=i.split("?")[0].slice(i.lastIndexOf(".")+1).toLowerCase();l=ho.MIME_TYPES[f]||`video/${f}`}return h.src=i,l&&(h.type=l),new Promise(f=>{const g=async()=>{const m=new ho({...s,resource:r});r.removeEventListener("canplay",g),t.data.preload&&await MC(r),f(Rl(m,e,i))};r.addEventListener("canplay",g),r.appendChild(h)})},unload(i){i.destroy(!0)}},rg={extension:{type:q.ResolveParser,name:"resolveTexture"},test:sg.test,parse:i=>{var t;return{resolution:parseFloat(((t=ln.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:i.split(".").pop(),src:i}}},kC={extension:{type:q.ResolveParser,priority:-2,name:"resolveJson"},test:i=>ln.RETINA_PREFIX.test(i)&&i.endsWith(".json"),parse:rg.parse};class EC{constructor(){this._detections=[],this._initialized=!1,this.resolver=new ln,this.loader=new JS,this.cache=Vt,this._backgroundLoader=new zS(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var o,h;if(this._initialized){Yt("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let l=t.manifest;typeof l=="string"&&(l=await this.load(l)),this.resolver.addManifest(l)}const e=((o=t.texturePreference)==null?void 0:o.resolution)??1,s=typeof e=="number"?[e]:e,r=await this._detectFormats({preferredFormats:(h=t.texturePreference)==null?void 0:h.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:s}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const s=_o(t),r=ei(t).map(l=>{if(typeof l!="string"){const u=this.resolver.getAlias(l);return u.some(d=>!this.resolver.hasKey(d))&&this.add(l),Array.isArray(u)?u[0]:u}return this.resolver.hasKey(l)||this.add({alias:l,src:l}),l}),o=this.resolver.resolve(r),h=await this._mapLoadToResolve(o,e);return s?h[r[0]]:h}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const r=this.resolver.resolveBundle(t),o={},h=Object.keys(r);let l=0,u=0;const d=()=>{e==null||e(++l/u)},f=h.map(g=>{const m=r[g];return u+=Object.keys(m).length,this._mapLoadToResolve(m,d).then(y=>{o[g]=y})});return await Promise.all(f),s?o[t[0]]:o}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Vt.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=Vt.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const r=await this.loader.load(s,e);this._backgroundLoader.active=!0;const o={};return s.forEach(h=>{const l=r[h.src],u=[h.src];h.alias&&u.push(...h.alias),u.forEach(d=>{o[d]=l}),Vt.set(u,l)}),o}async unload(t){this._initialized||await this.init();const e=ei(t).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=ei(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(s=>{Vt.remove(s.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const s of t.detections)t.skipDetections||await s.test()?e=await s.add(e):t.skipDetections||(e=await s.remove(e));return e=e.filter((s,r)=>e.indexOf(s)===r),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(s=>s in t).forEach(s=>{e.config[s]=t[s]})})}}const Vn=new EC;_e.handleByList(q.LoadParser,Vn.loader.parsers).handleByList(q.ResolveParser,Vn.resolver.parsers).handleByList(q.CacheParser,Vn.cache.parsers).handleByList(q.DetectionParser,Vn.detections);_e.add($S,XS,YS,QS,jS,KS,ZS,iC,rC,fC,_C,sg,IC,HS,GS,rg,kC);const Pf={loader:q.LoadParser,resolver:q.ResolveParser,cache:q.CacheParser,detection:q.DetectionParser};_e.handle(q.Asset,i=>{const t=i.ref;Object.entries(Pf).filter(([e])=>!!t[e]).forEach(([e,s])=>_e.add(Object.assign(t[e],{extension:t[e].extension??s})))},i=>{const t=i.ref;Object.keys(Pf).filter(e=>!!t[e]).forEach(e=>_e.remove(t[e]))});class Dt extends yo{constructor(t){t instanceof He&&(t={context:t});const{context:e,roundPixels:s,...r}=t||{};super({label:"Graphics",...r}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new He,this._context.on("update",this.onViewUpdate,this),this.allowChildren=!1,this.roundPixels=s??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}addBounds(t){t.addBounds(this._context.bounds)}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Dt(this._context.clone()):(this._ownedContext=null,new Dt(this._context))}lineStyle(t,e,s){gt(xt,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const r={};return t&&(r.width=t),e&&(r.color=e),s&&(r.alpha=s),this.context.strokeStyle=r,this}beginFill(t,e){gt(xt,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return t&&(s.color=t),e&&(s.alpha=e),this.context.fillStyle=s,this}endFill(){gt(xt,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==He.defaultStrokeStyle.width||t.color!==He.defaultStrokeStyle.color||t.alpha!==He.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return gt(xt,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return gt(xt,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return gt(xt,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return gt(xt,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return gt(xt,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return gt(xt,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}const og=class ag extends Vp{constructor(...t){let e=t[0]??{};e instanceof Float32Array&&(gt(xt,"use new MeshGeometry({ positions, uvs, indices }) instead"),e={positions:e,uvs:t[1],indices:t[2]}),e={...ag.defaultOptions,...e};const s=e.positions||new Float32Array([0,0,1,0,1,1,0,1]),r=e.uvs||new Float32Array([0,0,1,0,1,1,0,1]),o=e.indices||new Uint32Array([0,1,2,0,2,3]),h=e.shrinkBuffersToFit,l=new ts({data:s,label:"attribute-mesh-positions",shrinkToFit:h,usage:zt.VERTEX|zt.COPY_DST}),u=new ts({data:r,label:"attribute-mesh-uvs",shrinkToFit:h,usage:zt.VERTEX|zt.COPY_DST}),d=new ts({data:o,label:"index-mesh-buffer",shrinkToFit:h,usage:zt.INDEX|zt.COPY_DST});super({attributes:{aPosition:{buffer:l,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:u,format:"float32x2",stride:2*4,offset:0}},indexBuffer:d,topology:e.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};og.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let RC=og;class BC extends yo{constructor(t,e){const{text:s,resolution:r,style:o,anchor:h,width:l,height:u,roundPixels:d,...f}=t;super({...f}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=s??"",this.style=o,this.resolution=r??null,this.allowChildren=!1,this._anchor=new ge({_onUpdate:()=>{this.onViewUpdate()}}),h&&(this.anchor=h),this.roundPixels=d??!1,l!==void 0&&(this.width=l),u!==void 0&&(this.height=u)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){var e;t=t||{},(e=this._style)==null||e.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get bounds(){return this._boundsDirty&&(this._updateBounds(),this._boundsDirty=!1),this._bounds}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}addBounds(t){const e=this.bounds;t.addFrame(e.minX,e.minY,e.maxX,e.maxY)}containsPoint(t){const e=this.bounds.width,s=this.bounds.height,r=-e*this.anchor.x;let o=0;return t.x>=r&&t.x<=r+e&&(o=-s*this.anchor.y,t.y>=o&&t.y<=o+s)}onViewUpdate(){this._boundsDirty=!0,this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}:${this._resolution}`}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t!=null&&t.style)&&this._style.destroy(t),this._style=null,this._text=null}}function LC(i,t){let e=i[0]??{};return(typeof e=="string"||i[1])&&(gt(xt,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:i[1]}),e}class gi extends BC{constructor(...t){const e=LC(t,"Text");super(e,Is),this.renderPipeId="text"}_updateBounds(){const t=this._bounds,e=this._anchor,s=hl.measureText(this._text,this._style),{width:r,height:o}=s;t.minX=-e._x*r,t.maxX=t.minX+r,t.minY=-e._y*o,t.maxY=t.minY+o}}const hg=class lg extends RC{constructor(...t){super({});let e=t[0]??{};typeof e=="number"&&(gt(xt,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),e={width:e,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(e)}build(t){t={...lg.defaultOptions,...t},this.verticesX=this.verticesX??t.verticesX,this.verticesY=this.verticesY??t.verticesY,this.width=this.width??t.width,this.height=this.height??t.height;const e=this.verticesX*this.verticesY,s=[],r=[],o=[],h=this.verticesX-1,l=this.verticesY-1,u=this.width/h,d=this.height/l;for(let g=0;g<e;g++){const m=g%this.verticesX,y=g/this.verticesX|0;s.push(m*u,y*d),r.push(m/h,y/l)}const f=h*l;for(let g=0;g<f;g++){const m=g%h,y=g/h|0,b=y*this.verticesX+m,S=y*this.verticesX+m+1,v=(y+1)*this.verticesX+m,M=(y+1)*this.verticesX+m+1;o.push(b,S,v,S,M,v)}this.buffers[0].data=new Float32Array(s),this.buffers[1].data=new Float32Array(r),this.indexBuffer.data=new Uint32Array(o),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};hg.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let OC=hg;const cg=class ug extends OC{constructor(t={}){t={...ug.defaultOptions,...t},super({width:t.width,height:t.height,verticesX:4,verticesY:4}),this.update(t)}update(t){this.width=t.width??this.width,this.height=t.height??this.height,this._originalWidth=t.originalWidth??this._originalWidth,this._originalHeight=t.originalHeight??this._originalHeight,this._leftWidth=t.leftWidth??this._leftWidth,this._rightWidth=t.rightWidth??this._rightWidth,this._topHeight=t.topHeight??this._topHeight,this._bottomHeight=t.bottomHeight??this._bottomHeight,this.updateUvs(),this.updatePositions()}updatePositions(){const t=this.positions,e=this._leftWidth+this._rightWidth,s=this.width>e?1:this.width/e,r=this._topHeight+this._bottomHeight,o=this.height>r?1:this.height/r,h=Math.min(s,o);t[9]=t[11]=t[13]=t[15]=this._topHeight*h,t[17]=t[19]=t[21]=t[23]=this.height-this._bottomHeight*h,t[25]=t[27]=t[29]=t[31]=this.height,t[2]=t[10]=t[18]=t[26]=this._leftWidth*h,t[4]=t[12]=t[20]=t[28]=this.width-this._rightWidth*h,t[6]=t[14]=t[22]=t[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(){const t=this.uvs;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1;const e=1/this._originalWidth,s=1/this._originalHeight;t[2]=t[10]=t[18]=t[26]=e*this._leftWidth,t[9]=t[11]=t[13]=t[15]=s*this._topHeight,t[4]=t[12]=t[20]=t[28]=1-e*this._rightWidth,t[17]=t[19]=t[21]=t[23]=1-s*this._bottomHeight,this.getBuffer("aUV").update()}};cg.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let js=cg;const dg=class fg extends yo{constructor(t){var g,m,y,b;t instanceof ft&&(t={texture:t});const{width:e,height:s,leftWidth:r,rightWidth:o,topHeight:h,bottomHeight:l,texture:u,roundPixels:d,...f}=t;super({label:"NineSliceSprite",...f}),this.renderPipeId="nineSliceSprite",this.batched=!0,this._leftWidth=r??((g=u==null?void 0:u.defaultBorders)==null?void 0:g.left)??js.defaultOptions.leftWidth,this._topHeight=h??((m=u==null?void 0:u.defaultBorders)==null?void 0:m.top)??js.defaultOptions.topHeight,this._rightWidth=o??((y=u==null?void 0:u.defaultBorders)==null?void 0:y.right)??js.defaultOptions.rightWidth,this._bottomHeight=l??((b=u==null?void 0:u.defaultBorders)==null?void 0:b.bottom)??js.defaultOptions.bottomHeight,this.bounds.maxX=this._width=e??u.width??js.defaultOptions.width,this.bounds.maxY=this._height=s??u.height??js.defaultOptions.height,this.allowChildren=!1,this.texture=u??fg.defaultOptions.texture,this.roundPixels=d??!1}get bounds(){return this._bounds}get width(){return this._width}set width(t){this.bounds.maxX=this._width=t,this.onViewUpdate()}get height(){return this._height}set height(t){this.bounds.maxY=this._height=t,this.onViewUpdate()}setSize(t,e){typeof t=="object"&&(e=t.height??t.width,t=t.width),this.bounds.maxX=this._width=t,this.bounds.maxY=this._height=e??t,this.onViewUpdate()}getSize(t){return t||(t={}),t.width=this._width,t.height=this._height,t}get leftWidth(){return this._leftWidth}set leftWidth(t){this._leftWidth=t,this.onViewUpdate()}get topHeight(){return this._topHeight}set topHeight(t){this._topHeight=t,this.onViewUpdate()}get rightWidth(){return this._rightWidth}set rightWidth(t){this._rightWidth=t,this.onViewUpdate()}get bottomHeight(){return this._bottomHeight}set bottomHeight(t){this._bottomHeight=t,this.onViewUpdate()}get texture(){return this._texture}set texture(t){t||(t=ft.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this.onViewUpdate())}get originalWidth(){return this._texture.width}get originalHeight(){return this._texture.height}addBounds(t){const e=this.bounds;t.addFrame(e.minX,e.minY,e.maxX,e.maxY)}destroy(t){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(s)}this._texture=null}};dg.defaultOptions={texture:ft.EMPTY};let FC=dg;_e.add(sv,nv);class rs{constructor(){U(this,"head",0);U(this,"tail",0);U(this,"elements",{})}reset(){this.head=0,this.tail=0,this.elements={}}push(t){this.elements[this.tail]=t,this.tail+=1}pop(){if(this.isEmpty)throw new Error("Queue: called pop on empty queue");const t=this.elements[this.head];return delete this.elements[this.head],this.head+=1,this.isEmpty&&this.reset(),t}get length(){return this.tail-this.head}get isEmpty(){return this.length===0}}class Qi{constructor(t,e){U(this,"style");U(this,"onScreenText");U(this,"prefixText");this.style=new Is({fontFamily:(e==null?void 0:e.fontFamily)||"Arial",fontSize:(e==null?void 0:e.fontSize)||15,fill:(e==null?void 0:e.fill)||16711680,align:(e==null?void 0:e.align)||"center",wordWrap:(e==null?void 0:e.wordWrap)||!0,wordWrapWidth:e!=null&&e.app?e.app.canvas.width:window.innerHeight,breakWords:(e==null?void 0:e.breakWords)||!0}),this.prefixText=(e==null?void 0:e.prefix)||"",this.onScreenText=new gi({text:t,style:this.style}),this.onScreenText.zIndex=(e==null?void 0:e.zIndex)||0,this.onScreenText.anchor=(e==null?void 0:e.anchor)||{x:.5,y:.5},this.onScreenText.x=(e==null?void 0:e.x)||0,this.onScreenText.y=(e==null?void 0:e.y)||0,this.update(t)}setPrefix(t){this.prefixText=t}update(t){this.onScreenText.text=`${this.prefixText}${t}`}get text(){return this.onScreenText}}/**
 * @overview idle-bignum.
 * @copyright 2019 Frederic  Rezeau
 * @license [MIT]{@link https://github.com/FredericRezeau/idle-bignum/blob/master/LICENSE}
 */const Uh=["","K","M","B","T"],Mf=26,Tf=65,UC=12,Vh=1e3;class mt{constructor(t,e,s){U(this,"value");U(this,"exp");U(this,"negative");this.negative=s||t<0,this.value=t,this.exp=e||0,this.normalize()}serialize(){return JSON.stringify({value:this.value,exp:this.exp,negative:this.negative})}static from(t){return t instanceof mt?new mt(t.value,t.exp,t.negative):new mt(t).normalize()}normalize(){for(this.value<0&&(this.negative=this.value<0,this.exp=0,this.value=Math.abs(this.value));this.value<1&&this.exp!==0;)this.value*=Vh,this.exp-=3;for(;this.value>=Vh;)this.value*=1/Vh,this.exp+=3;return this}align(t){const e=t-this.exp;e>0&&(this.value=e<=UC?this.value/Math.pow(10,e):0,this.exp=t)}add(t){t.exp<this.exp?t.align(this.exp):this.align(t.exp),this.value+=t.value,this.normalize(),t.normalize()}substract(t){t.exp<this.exp?t.align(this.exp):this.align(t.exp),this.value-=t.value,this.normalize(),t.normalize()}multiply(t){t>=0&&(this.value*=t,this.normalize())}divide(t){t>0&&(this.value/=t,this.normalize())}getValue(t){return Number(this.value.toFixed(t>=0?t:2)).toString()}getExpName(){let t="";const e=this.exp/3;if(e<Uh.length)t=Uh[e];else{const s=e-Uh.length,r=Tf+s/Mf,o=Tf+s%Mf;t=String.fromCharCode(r,o)}return t}getExp(){return this.exp.toString()}toString(t=-1){return this.getValue(t)+" "+this.getExpName()}isZero(){return this.value===0&&this.exp===0}}const Pt={stage:"1-1",backWorkers:1,frontWorkers:1,customerWorkers:1,stations:[],upgrades:[],bcoins:new mt(8)};function VC(){const{innerHeight:i,innerWidth:t}=window;let e=i,s=e*9/16;return s>t&&(s=t,e=s*16/9),{width:s,height:e}}const Zt={top:0,left:0,...VC()},Dn=new Qi("0",{x:G(60),y:st(1.5),anchor:{x:0,y:0},fontSize:G(3),prefix:"FPS: ",zIndex:10}),sn=new Qi("Initialising",{x:G(5),y:st(1.5),anchor:{x:0,y:0},fontSize:G(3)});function G(i){return Zt.width*(i/100)}function st(i){return Zt.height*(i/100)}const Qn=new rs,uo=new rs,$n=new rs,Kt=[],cl=[],ul=new rs,dl=new rs,Yn=new rs,fl=[],pl=new rs;class Bl extends kt{constructor(e,s,r,o){super({x:e,y:s});U(this,"view");U(this,"_radius");U(this,"_color");this._color=(o==null?void 0:o.color)||"pink",this._radius=r,this.view=new Dt,this.drawCircle(),this.addChild(this.view),this.setSize(r,r)}drawCircle(){this.view.clear().circle(0,0,this._radius).fill({color:this._color})}get color(){return this._color}set color(e){this._color=e,this.drawCircle()}get radius(){return this._radius}set radius(e){this._radius=e,this.drawCircle()}}var ce=(i=>(i.MONEYSACK="",i.CLOCK="",i.GEAR="",i.INFO="",i.RESET="",i))(ce||{});function DC(){return"#"+["r","g","b"].map(()=>(Math.floor(Math.random()*256-10)+10).toString(16).padStart(2,"0")).join("")}function Jn(i,t){return i=Math.floor(i),t=Math.ceil(t),Math.floor(Math.random()*(t-i+1))+i}const WC=i=>{const{top:t,width:e,left:s,height:r}=i,o=(r-t)/2,h=new at(s,o),l=new at(e,o);return NC(h,l)},NC=(i,t)=>{const[e,s]=[Math.min(i.x,t.x),Math.max(i.x,t.x)],r=s-e,[o,h]=[Math.min(i.y,t.y),Math.max(i.y,t.y)],l=h-o,u=Math.random();return new at(e+r*u,o+l*u)};function nn(i,t){if(!i)throw new Error(t)}function gl(i,t,e=!1){const{x:s,y:r}=WC(Zt);let o;if(t==="front")o=new _g(s,r-30,{color:"blue"}),Yn.push(o),e&&(Pt.frontWorkers+=1);else if(t==="back")o=new Nn(s,r+30,{color:"green"}),$n.push(o),e&&(Pt.backWorkers+=1);else throw new Error("Wrong type");i.stage.addChild(o)}function Ll(i,t=!1){const e=[new at(-100,20),new at(Zt.width/2,-100),new at(Zt.width+100,100)],s=e[Jn(0,e.length-1)],{x:r,y:o}=s,h=new Ii(r,o,{color:"beige"});i.stage.addChild(h),pl.push(h),t&&(Pt.customerWorkers+=1)}class pg extends kt{constructor(t,e){super({x:t,y:e})}reset(){this.update(0)}}class GC extends pg{constructor(e,s,r){super(e,s);U(this,"background",new Dt);U(this,"progressFill",new Dt);U(this,"foregroundCover",new Dt);U(this,"outerRadius");U(this,"fillRadius");U(this,"startAngle",-Math.PI/2);this.outerRadius=r,this.fillRadius=.8*r,this.createView()}createView(){this.background.circle(0,0,this.outerRadius).fill("white"),this.progressFill.circle(0,0,this.outerRadius*.8).fill("white"),this.foregroundCover.circle(0,0,this.outerRadius*.4).fill("white"),this.addChild(this.background,this.progressFill,this.foregroundCover)}update(e){const s=this.startAngle+e*2*Math.PI;this.progressFill.clear(),this.progressFill.arc(0,0,this.fillRadius,this.startAngle,s,!1).lineTo(0,0).fill("#a8c3ed"),e===0?this.visible=!1:this.visible=!0}}class HC extends pg{constructor(e,s,r,o,h=1){super(e,s);U(this,"background",new Dt);U(this,"progressFill",new Dt);U(this,"localWidth");U(this,"localHeight");U(this,"outerRadius");this.outerRadius=h,this.width=r,this.height=o,this.localWidth=r,this.localHeight=o,this.createView()}createView(){this.background.roundRect(0,0,this.localWidth,this.localHeight,this.outerRadius).fill("white");const e=this.localWidth*.8,s=this.localHeight*.5,r=this.localWidth/2-e/2,o=this.localHeight/2-s/2;this.progressFill.roundRect(r,o,0,s).fill("#a8c3ed"),this.addChild(this.background,this.progressFill)}update(e){let s=this.localWidth*.8;const r=this.localHeight*.5,o=this.localWidth/2-s/2,h=this.localHeight/2-r/2;s=s*e,this.progressFill.clear().roundRect(o,h,s,r).fill("#a8c3ed")}}var ti;let Li=(ti=class extends Bl{constructor(e,s,r){const o=(r==null?void 0:r.size)||ti.defaultSize,h=(r==null?void 0:r.color)||DC();super(e,s,o,{color:h});U(this,"id");U(this,"hold",null);U(this,"progressBar");U(this,"travelPath",[]);U(this,"pathProgression",0);ti.identifier+=1,this.id=ti.identifier,this.progressBar=new GC(o,-o,o/2),this.progressBar.reset(),this.addChild(this.progressBar)}moveTo({x:e,y:s},r,o){if(o==="start"){const u=ss.getClosestUnobstractedCell(new at(this.x,this.y)),d=ss.getClosestUnobstractedCell(new at(e,s));this.travelPath=ss.findPath(u,d),this.travelPath.push([e,s]),this.pathProgression=Math.min(3,this.travelPath.length-1)}const[h,l]=this.travelPath[this.pathProgression];if(this._moveTo(new at(h,l),r)){if(this.pathProgression===this.travelPath.length-1)return"done";this.pathProgression=Math.min(this.pathProgression+3,this.travelPath.length-1)}return"continue"}_moveTo({x:e,y:s},r){const o=e-this.x,h=s-this.y,l=Math.sqrt(o*o+h*h);if(l===0)return!0;const u=o/l,d=h/l;let f=u*r,g=d*r;return Math.abs(f)>Math.abs(o)?this.x=e:this.x+=f,Math.abs(g)>Math.abs(h)?this.y=s:this.y+=g,Math.abs(e-this.x)===0&&Math.abs(s-this.y)===0}takeProduct(e){this.hold=e,e.setPos(0,-this.radius),this.addChild(this.hold),this.hold.scale=1}leaveProduct(e){if(!this.hold)throw new Error("Leave Product called but no product held");this.hold.scale=.5,this.removeChild(this.hold);const s=this.hold;return this.hold=null,e.putProduct(s),s}},U(ti,"SPEED",G(.6)),U(ti,"identifier",0),U(ti,"defaultSize",G(8)),ti);class Bi extends kt{constructor(e,s,r,o,h){super();U(this,"view");this.view=new Dt().rect(0,0,r,o).fill({color:(h==null?void 0:h.color)||"orange"}),this.view.position.x=e,this.view.position.y=s,this.view.width=r,this.view.height=o,this.view.zIndex=(h==null?void 0:h.zIndex)||0,h!=null&&h.interactive?(this.view.eventMode="static",this.view.cursor="pointer",this.view.on("pointerover",()=>{this.view.tint="lightgrey"}),this.view.on("pointerout",()=>{this.view.tint="white"}),this.view.on("pointerdown",()=>{this.view.tint="grey"}),this.view.on("pointerup",()=>{this.view.tint="lightgrey"})):this.view.eventMode="none"}get x(){return this.view.x}get y(){return this.view.y}get position(){return this.view.position}get width(){return this.view.width}get height(){return this.view.height}get centre(){return new at(this.view.x+this.view.width/2,this.view.y+this.view.height/2)}getView(){return[this.view]}}var es=(i=>(i[i.TOP=0]="TOP",i[i.BOTTOM=1]="BOTTOM",i[i.LEFT=2]="LEFT",i[i.RIGHT=3]="RIGHT",i))(es||{});const Ki=class Ki extends Bi{constructor(e,s,{color:r,interactive:o=!1}){super(e,s,Ki.SIZE,Ki.SIZE,{color:r,interactive:o});U(this,"color");U(this,"dockingPoints",[]);this.color=r;const h=Ki.SIZE/2,l=new at(e+h,s),u=new at(e+h,s+Ki.SIZE),d=new at(e,s+h),f=new at(e+Ki.SIZE,s+h);this.dockingPoints=[l,u,d,f]}get size(){return this.view.width}getDockingPoint(e){return this.dockingPoints[e]}};U(Ki,"SIZE",G(8));let Ee=Ki;class ji extends Ee{constructor(){super(...arguments);U(this,"hold",new Map);U(this,"occupants",new Set)}putProduct(e){const s=this.centre;e.setPos(s.x,s.y);const r=e.category;this.has(r)?this.hold.get(r).push(e):this.hold.set(r,[e])}getProduct(e){var r;const s=(r=this.hold.get(e))==null?void 0:r.pop();if(!s)throw new Error("Trying to get product from FrontStation but product not found!");return s}has(e){var s;return!!((s=this.hold.get(e))!=null&&s.length)}occupy(e){this.occupants.add(e)}vacate(e){this.occupants.delete(e)}}class zC extends Bl{constructor(e,s,r){super(0,0,G(3),{color:s});U(this,"category");U(this,"price");U(this,"priceView");this.category=e,this.price=r,this.price.normalize(),this.priceView=new gi({text:`${ce.MONEYSACK} ${this.price.toString(1)}`,anchor:.5,style:{fill:"white",fontSize:G(6),fontWeight:"bold",stroke:"black"}}),this.priceView.y=-this.radius*2,this.addChild(this.priceView)}setPos(e,s){this.x=e,this.y=s}get centre(){return new at(this.x,this.y)}get size(){return this.radius*2}}class $C extends Ee{constructor(e,s,{color:r,dockSide:o,toggleStationDetails:h}){super(e,s,{color:r});U(this,"isFree",!0);U(this,"dockSide");this.view.alpha=.5,this.dockSide=o,this.view.zIndex=-1,this.view.on("pointertap",h)}occupy(){this.isFree=!1}vacate(){this.isFree=!0}available(){return this.isFree}getDock(){return this.getDockingPoint(this.dockSide)}}var ki={},os={};Object.defineProperty(os,"__esModule",{value:!0});os.Collector=void 0;class YC{constructor(t){this.emit=(...e)=>{t.emitCollecting(this,e)}}}os.Collector=YC;var Po={};Object.defineProperty(Po,"__esModule",{value:!0});Po.CollectorArray=void 0;const XC=os;class qC extends XC.Collector{constructor(){super(...arguments),this.result=[]}handleResult(t){return this.result.push(t),!0}getResult(){return this.result}reset(){this.result.length=0}}Po.CollectorArray=qC;var Mo={};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.CollectorLast=void 0;const jC=os;class KC extends jC.Collector{handleResult(t){return this.result=t,!0}getResult(){return this.result}reset(){delete this.result}}Mo.CollectorLast=KC;var To={};Object.defineProperty(To,"__esModule",{value:!0});To.CollectorUntil0=void 0;const ZC=os;class QC extends ZC.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,this.result}getResult(){return this.result}reset(){this.result=!1}}To.CollectorUntil0=QC;var Io={};Object.defineProperty(Io,"__esModule",{value:!0});Io.CollectorWhile0=void 0;const JC=os;class tP extends JC.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,!this.result}getResult(){return this.result}reset(){this.result=!1}}Io.CollectorWhile0=tP;var ko={},Eo={};Object.defineProperty(Eo,"__esModule",{value:!0});Eo.SignalConnectionImpl=void 0;class eP{constructor(t,e){this.link=t,this.parentCleanup=e}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(t){this.link&&this.link.setEnabled(t)}get enabled(){return this.link!==null&&this.link.isEnabled()}}Eo.SignalConnectionImpl=eP;var Ro={};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.SignalLink=void 0;class Ol{constructor(t=null,e=null,s=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=t??this,this.next=e??this,this.order=s}isEnabled(){return this.enabled&&!this.newLink}setEnabled(t){this.enabled=t}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(t,e){let s=this.prev;for(;s!==this&&!(s.order<=e);)s=s.prev;const r=new Ol(s,s.next,e);return r.callback=t,s.next=r,r.next.prev=r,r}}Ro.SignalLink=Ol;Object.defineProperty(ko,"__esModule",{value:!0});ko.Signal=void 0;const iP=Eo,sP=Ro;class nP{constructor(){this.head=new sP.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(t,e=0){this.connectionsCount++;const s=this.head.insert(t,e);return this.emitDepth>0&&(this.hasNewLinks=!0,s.newLink=!0),new iP.SignalConnectionImpl(s,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(t){for(let e=this.head.next;e!==this.head;e=e.next)if(e.callback===t)return this.decrementConnectionCount(),e.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...t){this.emitDepth++;for(let e=this.head.next;e!==this.head;e=e.next)e.isEnabled()&&e.callback&&e.callback.apply(null,t);this.emitDepth--,this.unsetNewLink()}emitCollecting(t,e){this.emitDepth++;for(let s=this.head.next;s!==this.head;s=s.next)if(s.isEnabled()&&s.callback){const r=s.callback.apply(null,e);if(!t.handleResult(r))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let t=this.head.next;t!==this.head;t=t.next)t.newLink=!1;this.hasNewLinks=!1}}}ko.Signal=nP;var Bo={};Object.defineProperty(Bo,"__esModule",{value:!0});Bo.SignalConnections=void 0;class rP{constructor(){this.list=[]}add(t){this.list.push(t)}disconnectAll(){for(const t of this.list)t.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}}Bo.SignalConnections=rP;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.SignalConnections=i.Signal=i.CollectorWhile0=i.CollectorUntil0=i.CollectorLast=i.CollectorArray=i.Collector=void 0;var t=os;Object.defineProperty(i,"Collector",{enumerable:!0,get:function(){return t.Collector}});var e=Po;Object.defineProperty(i,"CollectorArray",{enumerable:!0,get:function(){return e.CollectorArray}});var s=Mo;Object.defineProperty(i,"CollectorLast",{enumerable:!0,get:function(){return s.CollectorLast}});var r=To;Object.defineProperty(i,"CollectorUntil0",{enumerable:!0,get:function(){return r.CollectorUntil0}});var o=Io;Object.defineProperty(i,"CollectorWhile0",{enumerable:!0,get:function(){return o.CollectorWhile0}});var h=ko;Object.defineProperty(i,"Signal",{enumerable:!0,get:function(){return h.Signal}});var l=Bo;Object.defineProperty(i,"SignalConnections",{enumerable:!0,get:function(){return l.SignalConnections}})})(ki);var oP=Object.defineProperty,aP=(i,t,e)=>t in i?oP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Yi=(i,t,e)=>(aP(i,typeof t!="symbol"?t+"":t,e),e);class hP{constructor(){Yi(this,"_isMouseIn"),Yi(this,"_isDown"),Yi(this,"onDown"),Yi(this,"onUp"),Yi(this,"onUpOut"),Yi(this,"onOut"),Yi(this,"onPress"),Yi(this,"onHover"),this.onPress=new ki.Signal,this.onDown=new ki.Signal,this.onUp=new ki.Signal,this.onHover=new ki.Signal,this.onOut=new ki.Signal,this.onUpOut=new ki.Signal}connectEvents(t){Cs.any?(t.on("pointerdown",this.processDown,this),t.on("pointerup",this.processUp,this),t.on("pointerupoutside",this.processUpOut,this),t.on("pointerout",this.processOut,this),t.on("pointertap",this.processPress,this),t.on("pointerover",this.processOver,this)):(t.on("mousedown",this.processDown,this),t.on("mouseup",this.processUp,this),t.on("mouseupoutside",this.processUpOut,this),t.on("mouseout",this.processOut,this),t.on("click",this.processPress,this),t.on("mouseover",this.processOver,this))}disconnectEvents(t){Cs.any?(t.off("pointerdown",this.processDown,this),t.off("pointerup",this.processUp,this),t.off("pointerupoutside",this.processUpOut,this),t.off("pointerout",this.processOut,this),t.off("pointertap",this.processPress,this),t.off("pointerover",this.processOver,this)):(t.off("mousedown",this.processDown,this),t.off("mouseup",this.processUp,this),t.off("mouseupoutside",this.processUpOut,this),t.off("mouseout",this.processOut,this),t.off("click",this.processPress,this),t.off("mouseover",this.processOver,this))}processDown(t){this._isDown=!0,this.onDown.emit(this,t),this.down(t)}processUp(t){this._isDown&&(this.onUp.emit(this,t),this.up(t)),this._isDown=!1}processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t),this.up(t),this.upOut(t)),this._isDown=!1}processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t),this.out(t))}processPress(t){this._isDown=!1,this.onPress.emit(this,t),this.press(t)}processOver(t){Cs.any||(this._isMouseIn=!0,this.onHover.emit(this,t),this.hover(t))}down(t){}up(t){}upOut(t){}out(t){}press(t){}hover(t){}get isDown(){return this._isDown}}var lP=Object.defineProperty,cP=(i,t,e)=>t in i?lP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,qi=(i,t,e)=>(cP(i,typeof t!="symbol"?t+"":t,e),e);class Lo extends hP{constructor(t){super(),qi(this,"_view"),t&&(this.view=t,this.enabled=!0)}set view(t){!!this._view&&this.disconnectEvents(this._view),this._view=t,this.connectEvents(this._view)}get view(){return this._view}set enabled(t){if(!this.view){console.error("Button view is not set. Please set it before enabling the button.");return}this.view.eventMode=t?"static":"auto",this.view.cursor=t?"pointer":"default",!t&&this.isDown&&this.processUp()}get enabled(){return this.view.eventMode==="static"}}class uP extends kt{constructor(t){super(),qi(this,"button"),qi(this,"onDown"),qi(this,"onUp"),qi(this,"onUpOut"),qi(this,"onOut"),qi(this,"onPress"),qi(this,"onHover"),this.button=new Lo(this),this.button.enabled=!0,t&&this.addChild(t),this.onPress=this.button.onPress,this.onDown=this.button.onDown,this.onUp=this.button.onUp,this.onHover=this.button.onHover,this.onOut=this.button.onOut,this.onUpOut=this.button.onUpOut}set enabled(t){this.button.enabled=t}get enabled(){return this.button.enabled}}function If(i){return typeof i=="string"?Ms.from(i):i}/*!
 * tweedle.js - v2.1.0
 * Compiled Wed, 05 Apr 2023 15:21:25 UTC
 *
 * tweedle.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
 */let Wn;typeof self>"u"&&typeof process<"u"&&process.hrtime?Wn=function(){const i=process.hrtime();return i[0]*1e3+i[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?Wn=self.performance.now.bind(self.performance):Date.now!==void 0?Wn=Date.now:Wn=function(){return new Date().getTime()};class Je{constructor(){Je.prototype.__init.call(this),Je.prototype.__init2.call(this),Je.prototype.__init3.call(this),Je.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return Je._shared||(Je._shared=new Je),Je._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=Wn}getAll(){return Object.keys(this._tweens).map(t=>this._tweens[t])}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,e=!1){if(t==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const s=Object.keys(this._tweens);if(s.length==0)return!1;for(let r=0;r<s.length;r++){const o=this._tweens[s[r]];o&&o.update(t,!0)==!1&&!e&&delete this._tweens[s[r]]}return!0}}const fo={Step:{None(i){return i<.5?0:1}},Linear:{None(i){return i}},Quadratic:{In(i){return i*i},Out(i){return i*(2-i)},InOut(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)}},Cubic:{In(i){return i*i*i},Out(i){return--i*i*i+1},InOut(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)}},Quartic:{In(i){return i*i*i*i},Out(i){return 1- --i*i*i*i},InOut(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)}},Quintic:{In(i){return i*i*i*i*i},Out(i){return--i*i*i*i*i+1},InOut(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)}},Sinusoidal:{In(i){return 1-Math.cos(i*Math.PI/2)},Out(i){return Math.sin(i*Math.PI/2)},InOut(i){return .5*(1-Math.cos(Math.PI*i))}},Exponential:{In(i){return i==0?0:Math.pow(1024,i-1)},Out(i){return i==1?1:1-Math.pow(2,-10*i)},InOut(i){return i==0?0:i==1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)}},Circular:{In(i){return 1-Math.sqrt(1-i*i)},Out(i){return Math.sqrt(1- --i*i)},InOut(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)}},Elastic:{In(i){return i==0?0:i==1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},Out(i){return i==0?0:i==1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},InOut(i){return i==0?0:i==1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)}},Back:{In(i){return i*i*((1.70158+1)*i-1.70158)},Out(i){return--i*i*((1.70158+1)*i+1.70158)+1},InOut(i){const t=2.5949095;return(i*=2)<1?.5*(i*i*((t+1)*i-t)):.5*((i-=2)*i*((t+1)*i+t)+2)}},Bounce:{In(i){return 1-fo.Bounce.Out(1-i)},Out(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},InOut(i){return i<.5?fo.Bounce.In(i*2)*.5:fo.Bounce.Out(i*2-1)*.5+.5}}},ot={Geom:{Linear(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),o=ot.Utils.Linear;return t<0?o(i[0],i[1],s):t>1?o(i[e],i[e-1],e-s):o(i[r],i[r+1>e?e:r+1],s-r)},Bezier(i,t){let e=0;const s=i.length-1,r=Math.pow,o=ot.Utils.Bernstein;for(let h=0;h<=s;h++)e+=o(s,h)*r(1-t,s-h)*r(t,h)*i[h];return e},QuadraticBezier(i,t){let e=0;const s=i.length-1;if(t==1)return i[s];const r=Math.pow,o=ot.Utils.Bernstein,h=s*t,l=Math.floor(h),u=(h-l)*.5+.5*(l%2),d=l-l%2,f=d+1,g=d+2;return e+=o(2,0)*r(1-u,2)*r(u,0)*i[d],e+=o(2,1)*r(1-u,1)*r(u,1)*i[f],e+=o(2,2)*r(1-u,0)*r(u,2)*i[g],e},CubicBezier(i,t){let e=0;const s=i.length-1;if(t==1)return i[s];const r=Math.pow,o=ot.Utils.Bernstein,h=s*t,l=Math.floor(h),u=(h-l)*(1/3)+1/3*(l%3),d=l-l%3,f=d+1,g=d+2,m=d+3;return e+=o(3,0)*r(1-u,3)*r(u,0)*i[d],e+=o(3,1)*r(1-u,2)*r(u,1)*i[f],e+=o(3,2)*r(1-u,1)*r(u,2)*i[g],e+=o(3,3)*r(1-u,0)*r(u,3)*i[m],e},CatmullRom(i,t){const e=i.length-1;let s=e*t,r=Math.floor(s);const o=ot.Utils.CatmullRom;return i[0]==i[e]?(t<0&&(r=Math.floor(s=e*(1+t))),o(i[(r-1+e)%e],i[r],i[(r+1)%e],i[(r+2)%e],s-r)):t<0?i[0]-(o(i[0],i[0],i[1],i[1],-s)-i[0]):t>1?i[e]-(o(i[e],i[e],i[e-1],i[e-1],s-e)-i[e]):o(i[r?r-1:0],i[r],i[e<r+1?e:r+1],i[e<r+2?e:r+2],s-r)}},Angle:{Radians(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),o=ot.Utils.WrapLinear;return t<0?o(i[0],i[1],s,2*Math.PI):t>1?o(i[e],i[e-1],e-s,2*Math.PI):o(i[r],i[r+1>e?e:r+1],s-r,2*Math.PI)},Degrees(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),o=ot.Utils.WrapLinear;return t<0?o(i[0],i[1],s,360):t>1?o(i[e],i[e-1],e-s,360):o(i[r],i[r+1>e?e:r+1],s-r,360)}},Color:{RGB(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),o=ot.Utils.RGBLinear;return t<0?o(i[0],i[1],s):t>1?o(i[e],i[e-1],e-s):o(i[r],i[r+1>e?e:r+1],s-r)},HSV(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),o=ot.Utils.HSVLinear;return t<0?o(i[0],i[1],s):t>1?o(i[e],i[e-1],e-s):o(i[r],i[r+1>e?e:r+1],s-r)},HCL(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),o=ot.Utils.HCLLinear;return t<0?o(i[0],i[1],s):t>1?o(i[e],i[e-1],e-s):o(i[r],i[r+1>e?e:r+1],s-r)}},Utils:{RGBsplit(i){const t=i>>24&255,e=i>>16&255,s=i>>8&255,r=i&255;return{a:t,r:e,g:s,b:r}},HSVsplit(i){const t=ot.Utils.RGBsplit(i);t.r/=255,t.g/=255,t.b/=255;const e=Math.max(t.r,t.g,t.b),s=Math.min(t.r,t.g,t.b);let r;const o=e,h=e-s,l=e==0?0:h/e;if(e==s)r=0;else{switch(e){case t.r:r=(t.g-t.b)/h+(t.g<t.b?6:0);break;case t.g:r=(t.b-t.r)/h+2;break;case t.b:r=(t.r-t.g)/h+4;break}r/=6}return{a:t.a,h:r,s:l,v:o}},HSVJoin(i){let t,e,s;const r=Math.floor(i.h*6),o=i.h*6-r,h=i.v*(1-i.s),l=i.v*(1-o*i.s),u=i.v*(1-(1-o)*i.s);switch(r%6){case 0:t=i.v,e=u,s=h;break;case 1:t=l,e=i.v,s=h;break;case 2:t=h,e=i.v,s=u;break;case 3:t=h,e=l,s=i.v;break;case 4:t=u,e=h,s=i.v;break;case 5:t=i.v,e=h,s=l;break}return i.a<<24|t<<16|e<<8|s},HCLSplit(i){const s=.530454533953517,r=ot.Utils.RGBsplit(i),o={a:r.a,h:0,c:0,l:0};let h=0;const l=Math.min(r.r,Math.min(r.g,r.b)),u=Math.max(r.r,Math.max(r.g,r.b));let d=3/100;return o.c=u-l,o.c!=0&&(h=Math.atan2(r.g-r.b,r.r-r.g)/Math.PI,d*=l/u),d=Math.exp(d),o.h=(h/2-Math.min(h%1,-h%1)/6)%1,o.c*=d,o.l=ot.Utils.Linear(-l,u,d)/(s*2),o},HCLJoin(i){const s=.530454533953517,r={a:i.a,r:0,g:0,b:0};if(i.l!=0){let o=i.h;const h=i.c,l=i.l*s,u=Math.exp((1-h/(2*l))*(3/100)),d=(2*l-h)/(2*u-1),f=h/u,g=(o+Math.min(2*o%1/4,-2*o%1/8))*Math.PI*2;let m;o*=6,o<=.999?(m=Math.tan(g),r.r=1,r.g=m/(1+m)):o<=1.001?(r.r=1,r.g=1):o<=2?(m=Math.tan(g),r.r=(1+m)/m,r.g=1):o<=3?(m=Math.tan(g),r.g=1,r.b=1+m):o<=3.999?(m=Math.tan(g),r.g=1/(1+m),r.b=1):o<=4.001?(r.g=0,r.b=1):o<=5?(m=Math.tan(g),r.r=-1/m,r.b=1):(m=Math.tan(g),r.r=1,r.b=-m),r.r=r.r*f+d,r.g=r.g*f+d,r.b=r.b*f+d}return r.a<<24|r.r<<16|r.g<<8|r.b},WrapLinear(i,t,e,s){let r;return i=(i+s*Math.trunc(Math.abs(i/s)))%s,t=(t+s*Math.trunc(Math.abs(t/s)))%s,Math.abs(i-t)<=.5*s?r=ot.Utils.Linear(i,t,e):(i<t?r=ot.Utils.Linear(i+s,t,e):r=ot.Utils.Linear(i,t+s,e),r=r%s),r},RGBLinear(i,t,e){const s=ot.Utils.RGBsplit(i),r=ot.Utils.RGBsplit(t),o=ot.Utils.Linear(s.a,r.a,e),h=ot.Utils.Linear(s.r,r.r,e),l=ot.Utils.Linear(s.g,r.g,e),u=ot.Utils.Linear(s.b,r.b,e);return o<<24|h<<16|l<<8|u},HSVLinear(i,t,e){const s=ot.Utils.HSVsplit(i),r=ot.Utils.HSVsplit(t);let o;Math.abs(s.h-r.h)<=.5?o=ot.Utils.Linear(s.h,r.h,e):(s.h<r.h?o=ot.Utils.Linear(s.h+1,r.h,e):o=ot.Utils.Linear(s.h,r.h+1,e),o=o%1);const h=ot.Utils.Linear(s.s,r.s,e),l=ot.Utils.Linear(s.v,r.v,e),u=ot.Utils.Linear(s.a,r.a,e);return ot.Utils.HSVJoin({a:u,h:o,s:h,v:l})},HCLLinear(i,t,e){const s=ot.Utils.HCLSplit(i),r=ot.Utils.HCLSplit(t);let o;Math.abs(s.h-r.h)<=.5?o=ot.Utils.Linear(s.h,r.h,e):(s.h<r.h?o=ot.Utils.Linear(s.h+1,r.h,e):o=ot.Utils.Linear(s.h,r.h+1,e),o=o%1);const h=ot.Utils.Linear(s.c,r.c,e),l=ot.Utils.Linear(s.l,r.l,e),u=ot.Utils.Linear(s.a,r.a,e);return ot.Utils.HSVJoin({a:u,h:o,s:h,v:l})},Linear(i,t,e){return(t-i)*e+i},Bernstein(i,t){const e=ot.Utils.Factorial;return e(i)/e(t)/e(i-t)},Factorial:function(){const i=[1];return function(t){let e=1;if(i[t])return i[t];for(let s=t;s>1;s--)e*=s;return i[t]=e,e}}(),CatmullRom(i,t,e,s,r){const o=(e-i)*.5,h=(s-t)*.5,l=r*r,u=r*l;return(2*t-2*e+o+h)*u+(-3*t+3*e-2*o-h)*l+o*r+t}}};class Oo{static __initStatic(){this._nextId=0}static nextId(){return Oo._nextId++}}Oo.__initStatic();const ro={safetyCheckFunction:i=>!0,easingFunction:fo.Linear.None,yoyoEasingFunction:void 0,interpolationFunction:ot.Geom.Linear};class It{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=ro.safetyCheckFunction}__init15(){this._easingFunction=ro.easingFunction}__init16(){this._yoyoEasingFunction=ro.yoyoEasingFunction}__init17(){this._interpolationFunction=ro.interpolationFunction}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=Oo.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:Je.shared}set _group(t){this._groupRef=t}constructor(t,e){It.prototype.__init.call(this),It.prototype.__init2.call(this),It.prototype.__init3.call(this),It.prototype.__init4.call(this),It.prototype.__init5.call(this),It.prototype.__init6.call(this),It.prototype.__init7.call(this),It.prototype.__init8.call(this),It.prototype.__init9.call(this),It.prototype.__init10.call(this),It.prototype.__init11.call(this),It.prototype.__init12.call(this),It.prototype.__init13.call(this),It.prototype.__init14.call(this),It.prototype.__init15.call(this),It.prototype.__init16.call(this),It.prototype.__init17.call(this),It.prototype.__init18.call(this),It.prototype.__init19.call(this),It.prototype.__init20.call(this),It.prototype.__init21.call(this),It.prototype.__init22.call(this),this._object=t,this._group=e}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,e){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,e)}return e!==void 0&&(this._duration=e),this}dynamicTo(t,e){return this._valuesEnd=t,e!==void 0&&(this._duration=e),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying?this:(t!=null&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,e,s,r,o){for(const h in s){const l=t[h],u=Array.isArray(l),d=!Number.isNaN(Number(l)),f=u?"array":typeof l,g=f=="object",m=typeof s[h]=="object",y=!u&&Array.isArray(s[h]);f=="undefined"||f=="function"||s[h]==null||!u&&!d&&!g||((g||u||m)&&l&&!y?(typeof e[h]>"u"&&(e[h]=u?[]:{}),typeof r[h]>"u"&&(r[h]=u?[]:{}),this._setupProperties(l,e[h],s[h],r[h],o)):((typeof e[h]>"u"||o)&&(e[h]=l),(typeof r[h]>"u"||o)&&(y?r[h]=s[h].slice().reverse()[0]:r[h]=e[h]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let e=[];if(t||(e=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=e;for(let s=0,r=this._chainedTweens.length;s<r;s++)this._chainedTweens[s].start()}return this}skip(t,e=!1){return this.resume(),this.update(t*this._duration-(e?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let e=0,s=this._chainedTweens.length;e<s;e++)this._chainedTweens[e].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,e=!1){const s=this._internalUpdate(t);return!s&&!e&&this._group.remove(this),s}_internalUpdate(t){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;t*=this._timescale;let e;this._elapsedTime+=t;const s=this._duration,r=this._startTime+this._elapsedTime;if(r>s&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&r>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),e=r/this._duration,this._duration==0&&(r>=0?e=1:e=0),e=Math.min(1,e),e=Math.max(0,e);let o=Number.isFinite(r)?r%this._duration:r;Number.isNaN(o)&&(o=0);const h=Math.floor(r/this._duration);let l;if(this._reversed&&this._yoyoEasingFunction?l=this._yoyoEasingFunction(e):l=this._easingFunction(e),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,l),this._onUpdateCallback&&(e!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,e,this),e==1){if(this._repeat-this._repeatCount>0){const u=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+h),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||o<=0)&&this._onUpdateCallback(this._object,e,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let d=1;Number.isFinite(h)?d=this._repeatCount-u:Number.isFinite(this._repeat)&&(d=this._repeat-u);for(let f=0;f<d;f++)this._onRepeatCallback(this._object,u+1+f,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return o>0&&Number.isFinite(this._repeat)&&this._internalUpdate(o),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let u=0,d=this._chainedTweens.length;u<d;u++)this._chainedTweens[u].start(),o>0&&this._chainedTweens[u].update(o);return this._isPlaying=!1,!1}return!0}_updateProperties(t,e,s,r){for(const o in s){if(e[o]==null)continue;const h=e[o];let l=s[o];const u=Array.isArray(t[o]),d=Array.isArray(l);!u&&d?this._reversed?t[o]=this._interpolationFunction(l.concat([h]),r):t[o]=this._interpolationFunction([h].concat(l),r):typeof l=="object"&&l?this._updateProperties(t[o],h,l,r):(l=this._handleRelativeValue(h,l),typeof l=="number"&&(typeof h=="number"||typeof h=="string")&&(t[o]=Number(h)+(l-Number(h))*r,typeof h=="string"&&(t[o]=String(t[o]))))}}_handleRelativeValue(t,e){return typeof e!="string"?e:e.charAt(0)=="+"||e.charAt(0)=="-"?t+Number(e):Number(e)}_swapEndStartRepeatValues(t,e){for(const s in t){const r=!Array.isArray(t[s])&&Array.isArray(e[s]);if(typeof t[s]=="object")this._swapEndStartRepeatValues(t[s],e[s]);else{const o=t[s];if(typeof e[s]=="string")t[s]=Number(t[s])+Number(e[s]),e[s]=o;else if(r){const h=e[s].slice().reverse();t[s]=h[0],e[s]=h}else t[s]=e[s],e[s]=o}}}_moveForwardStartRepeatValues(t,e){for(const s in t)typeof e[s]=="object"?this._moveForwardStartRepeatValues(t[s],e[s]):typeof e[s]=="string"&&(t[s]=Number(t[s])+Number(e[s]))}}function kf(i,t,e=0,s=!0){let r=t.scale.x,o=t.scale.y;if(!i)throw new Error("Parent is not defined");const h=i.width-e*2,l=i.height-e*2,u=h-Math.round(t.width),d=l-Math.round(t.height);if(u<0&&(r=h/(t.width/r)),d<0&&(o=l/(t.height/o)),r<=0||o<=0){t.scale.set(0);return}if(s||t.scale.x===t.scale.y){const f=Math.min(r,o);t.scale.set(f,f)}else{const f=t.scale.x/t.scale.y;u<d?t.scale.set(r,r/f):t.scale.set(o*f,o)}}function dP(i){return typeof i=="string"||typeof i=="number"?new gi({text:String(i)}):i}var fP=Object.defineProperty,pP=(i,t,e)=>t in i?fP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,he=(i,t,e)=>(pP(i,typeof t!="symbol"?t+"":t,e),e);class gP extends uP{constructor(t){super(),he(this,"animations"),he(this,"originalInnerViewState"),he(this,"defaultDuration",100),he(this,"options"),he(this,"_padding"),he(this,"_offset"),he(this,"_textOffset"),he(this,"iconOffset"),he(this,"innerView",new kt),he(this,"_views",{}),he(this,"state"),he(this,"anchor"),he(this,"_defaultTextScale",{x:1,y:1}),he(this,"_defaultIconScale",{x:1,y:1}),he(this,"_defaultTextAnchor",{x:.5,y:.5}),he(this,"_defaultIconAnchor",{x:.5,y:.5}),this.options=t??{};const{defaultView:e,hoverView:s,pressedView:r,disabledView:o,text:h,padding:l,offset:u,textOffset:d,iconOffset:f,defaultTextScale:g,defaultIconScale:m,defaultTextAnchor:y,defaultIconAnchor:b,scale:S,anchor:v,anchorX:M,anchorY:k,icon:I,animations:R}=t??{};this.addChild(this.innerView),this.anchor=new ge({_onUpdate:()=>this.updateAnchor()}),this.anchor.set(M??v??0,k??v??0),this.padding=l??0,this.offset=u,this.textOffset=d,this.iconOffset=f,this.defaultTextScale=g,this.defaultIconScale=m,this.defaultTextAnchor=y,this.defaultIconAnchor=b,this.scale.set(S??1),R&&(this.animations=R,Qs.shared.add(()=>Je.shared.update())),this.setState("default"),this.defaultView=e,this.hoverView=s,this.pressedView=r,this.disabledView=o,this.text=h,this.iconView=I,this.initStateControl()}set text(t){if(!t||t===0){this.removeView("textView");return}if(!this._views.textView){this.createTextView(t);return}this._views.textView.text=t.toString()}get text(){var t;return(t=this._views.textView)==null?void 0:t.text}set enabled(t){this.button.enabled=t,this.setState(t?"default":"disabled")}get enabled(){return this.button.enabled}setState(t,e=!1){if(!e&&this.state===t)return;const s=this.getStateView(this.state);s&&(s.visible=!1),this.state=t;const r=this.getStateView(t);r&&(this.setOffset(r,t,this.offset),r.visible=!0),this.updateAnchor(),this.playAnimations(t)}createTextView(t){var e;if(this._views.textView=dP(t),((e=this.options)==null?void 0:e.defaultTextScale)===void 0){const{x:s,y:r}=this._views.textView.scale;this._defaultTextScale={x:s,y:r}}this.innerView.addChild(this._views.textView),this.adjustTextView(this.state)}setOffset(t,e,s){const r=s?s[e]:{x:0,y:0},o=s==null?void 0:s.default;r?(t.x+=r.x??0,t.y+=r.y??0):o?(t.x+=o.x??0,t.y+=o.y??0):(s.x||s.y)&&(t.x+=s.x??0,t.y+=s.y??0)}getStateView(t){if(this._views)switch(t){case"hover":return this._views.hoverView??this._views.defaultView??void 0;case"pressed":return this._views.pressedView??this._views.hoverView??this._views.defaultView??void 0;case"disabled":return this._views.disabledView??this._views.defaultView??void 0;case"default":return this._views.defaultView??void 0;default:return}}adjustTextView(t){var o;if(!this.text)return;const e=this.getStateView(this.state),{x:s,y:r}=this._defaultTextAnchor;e&&((o=this.options)!=null&&o.ignoreRefitting||this._views.textView.scale.set(this._defaultTextScale.x,this._defaultTextScale.y),kf(e,this._views.textView,this.padding,!1),this._views.textView.x=e.x+e.width/2,this._views.textView.y=e.y+e.height/2),this._views.textView.anchor.set(s,r),this.setOffset(this._views.textView,t,this.textOffset)}adjustIconView(t){var o;if(!this._views.iconView)return;const e=this.getStateView(t);if(!e)return;(o=this.options)!=null&&o.ignoreRefitting||this._views.iconView.scale.set(this._defaultIconScale.x,this._defaultIconScale.y);const{x:s,y:r}=this._defaultIconAnchor;kf(e,this._views.iconView,this.padding,!1),"anchor"in this._views.iconView?this._views.iconView.anchor.set(s,r):this._views.iconView.pivot.set(s*(this._views.iconView.width/this._views.iconView.scale.x),r*(this._views.iconView.height/this._views.iconView.scale.y)),this._views.iconView.x=e.x+e.width/2,this._views.iconView.y=e.y+e.height/2,this.setOffset(this._views.iconView,t,this.iconOffset)}updateAnchor(){if(!this._views)return;const t=this.anchor.x??0,e=this.anchor.y??0;if([this._views.defaultView,this._views.hoverView,this._views.pressedView,this._views.disabledView].forEach(r=>{var o;r&&((o=r.anchor)==null||o.set(0),r.x=-r.width*t,r.y=-r.height*e)}),this._views.defaultView){const{x:r,y:o,width:h,height:l}=this._views.defaultView;this.hitArea=new ie(r,o,h,l)}this.adjustIconView(this.state),this.adjustTextView(this.state)}set defaultView(t){this.updateView("defaultView",t)}get defaultView(){return this._views.defaultView}set hoverView(t){this.updateView("hoverView",t),this._views.hoverView&&this.state!=="hover"&&(this._views.hoverView.visible=!1)}get hoverView(){return this._views.hoverView}set pressedView(t){this.updateView("pressedView",t),this._views.pressedView&&(this._views.pressedView.visible=!1)}get pressedView(){return this._views.pressedView}set disabledView(t){this.updateView("disabledView",t),this._views.disabledView&&(this._views.disabledView.visible=!1)}get disabledView(){return this._views.disabledView}updateView(t,e){var s;e!==void 0&&(this.removeView(t),e!==null&&((s=this.options)!=null&&s.nineSliceSprite&&(typeof e=="string"?this._views[t]=new FC({texture:ft.from(e),leftWidth:this.options.nineSliceSprite[0],topHeight:this.options.nineSliceSprite[1],rightWidth:this.options.nineSliceSprite[2],bottomHeight:this.options.nineSliceSprite[3]}):console.warn("NineSliceSprite can not be used with views set as Container.")),this._views[t]||(this._views[t]=If(e)),this.setOffset(this._views[t],this.state,this.offset),this._views[t].parent||this.innerView.addChild(this._views[t]),this.updateAnchor(),this._views.iconView&&this.innerView.addChild(this._views.iconView),this._views.textView&&this.innerView.addChild(this._views.textView),this.setState(this.state,!0)))}removeView(t){this._views[t]&&(this.innerView.removeChild(this._views[t]),this._views[t]=null)}set textView(t){t!==void 0&&(this.removeView("textView"),t!==null&&this.createTextView(t))}get textView(){return this._views.textView}set iconView(t){var e;if(t!==void 0&&(this.removeView("iconView"),t!==null)){if(this._views.iconView=If(t),((e=this.options)==null?void 0:e.defaultIconScale)===void 0){const{x:s,y:r}=this._views.iconView.scale;this._defaultIconScale={x:s,y:r}}this._views.iconView.parent||this.innerView.addChild(this._views.iconView),this.setState(this.state,!0)}}get iconView(){return this._views.iconView}playAnimations(t){var s;if(!this.animations)return;if(t==="default"&&!this.originalInnerViewState){this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}};const r=(s=this.animations)==null?void 0:s.default;if(r){this.innerView.x=r.props.x??this.originalInnerViewState.x,this.innerView.y=r.props.y??this.originalInnerViewState.y,this.innerView.width=r.props.width??this.originalInnerViewState.width,this.innerView.height=r.props.height??this.originalInnerViewState.height,this.innerView.scale.x=r.props.scale.x??this.originalInnerViewState.scale.x,this.innerView.scale.y=r.props.scale.y??this.originalInnerViewState.scale.y;return}}const e=this.animations[t]??this.animations.default;if(e){const r=e;this.defaultDuration=r.duration,new It(this.innerView).to(r.props,r.duration).start();return}new It(this.innerView).to(this.originalInnerViewState,this.defaultDuration).start()}initStateControl(){this.onDown.connect(()=>{this.setState("pressed")}),this.onUp.connect(()=>{Cs.any?this.setState("default"):this.setState("hover")}),this.onUpOut.connect(()=>{this.setState("default")}),this.onOut.connect(()=>{this.button.isDown||this.setState("default")}),this.onPress.connect(()=>{Cs.any?this.setState("default"):this.setState("hover")}),this.onHover.connect(()=>{this.button.isDown||(Cs.any?this.setState("default"):this.setState("hover"))})}set padding(t){this._padding=t,this.adjustTextView(this.state),this.adjustIconView(this.state)}get padding(){return this._padding}set offset(t){this._offset=t,this.updateAnchor()}get offset(){return this._offset}set textOffset(t){this._textOffset=t,this.adjustTextView(this.state)}get textOffset(){return this._textOffset}set defaultTextScale(t){if(t===void 0)return;this.options.defaultTextScale=t;const e=typeof t=="number";this._defaultTextScale.x=e?t:t.x??1,this._defaultTextScale.y=e?t:t.y??1,this.adjustTextView(this.state)}get defaultTextScale(){return this.defaultTextScale}set defaultIconScale(t){if(t===void 0)return;this.options.defaultIconScale=t;const e=typeof t=="number";this._defaultIconScale.x=e?t:t.x??1,this._defaultIconScale.y=e?t:t.y??1,this.adjustIconView(this.state)}get defaultIconScale(){return this.defaultIconScale}set defaultTextAnchor(t){if(t===void 0)return;this.options.defaultTextAnchor=t;const e=typeof t=="number";this._defaultTextAnchor.x=e?t:t.x??1,this._defaultTextAnchor.y=e?t:t.y??1,this.adjustTextView(this.state)}get defaultTextAnchor(){return this.defaultTextAnchor}set defaultIconAnchor(t){if(t===void 0)return;this.options.defaultIconAnchor=t;const e=typeof t=="number";this._defaultIconAnchor.x=e?t:t.x??1,this._defaultIconAnchor.y=e?t:t.y??1,this.adjustIconView(this.state)}get defaultIconAnchor(){return this.defaultIconAnchor}set width(t){var e;(e=this.options)!=null&&e.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.width=t),this._views.hoverView&&(this._views.hoverView.width=t),this._views.pressedView&&(this._views.pressedView.width=t),this._views.disabledView&&(this._views.disabledView.width=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.width=t}get width(){return super.width}set height(t){var e;(e=this.options)!=null&&e.nineSliceSprite?(this._views.defaultView&&(this._views.defaultView.height=t),this._views.hoverView&&(this._views.hoverView.height=t),this._views.pressedView&&(this._views.pressedView.height=t),this._views.disabledView&&(this._views.disabledView.height=t),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.height=t}get height(){return super.height}setSize(t,e){var s;(s=this.options)!=null&&s.nineSliceSprite?(this._views.defaultView&&this._views.defaultView.setSize(t,e),this._views.hoverView&&this._views.hoverView.setSize(t,e),this._views.pressedView&&this._views.pressedView.setSize(t,e),this._views.disabledView&&this._views.disabledView.setSize(t,e),this.adjustTextView(this.state),this.adjustIconView(this.state),this.updateAnchor()):super.setSize(t,e)}}var _P=Object.defineProperty,mP=(i,t,e)=>t in i?_P(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,oo=(i,t,e)=>(mP(i,typeof t!="symbol"?t+"":t,e),e);class xP extends kt{constructor(t){var e;super(),oo(this,"options"),oo(this,"view"),oo(this,"_type"),oo(this,"children",[]),t&&this.init(t),(e=t==null?void 0:t.items)==null||e.forEach(s=>this.addChild(s)),this.on("added",()=>this.arrangeChildren()),this.on("childAdded",()=>this.arrangeChildren())}init(t){this.options=t,t!=null&&t.type&&(this.type=t.type),t!=null&&t.children&&t.children.forEach(e=>this.addChild(e))}set type(t){this._type=t,this.arrangeChildren()}get type(){return this._type}set elementsMargin(t){if(!this.options)throw new Error("List has not been initiated!");this.options.elementsMargin=t,this.arrangeChildren()}get elementsMargin(){var t;return((t=this.options)==null?void 0:t.elementsMargin)??0}set padding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.padding=t,this.options.vertPadding=t,this.options.horPadding=t,this.options.leftPadding=t,this.options.rightPadding=t,this.options.topPadding=t,this.options.bottomPadding=t,this.arrangeChildren()}get padding(){var t;return((t=this.options)==null?void 0:t.padding)??0}set vertPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.vertPadding=t,this.options.topPadding=t,this.options.bottomPadding=t,this.arrangeChildren()}get vertPadding(){var t;return((t=this.options)==null?void 0:t.vertPadding)??this.padding??0}set horPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.horPadding=t,this.options.leftPadding=t,this.options.rightPadding=t,this.arrangeChildren()}get horPadding(){var t;return((t=this.options)==null?void 0:t.horPadding)??this.padding??0}set leftPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.leftPadding=t,this.arrangeChildren()}get leftPadding(){var t;return((t=this.options)==null?void 0:t.leftPadding)??this.horPadding}set rightPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.rightPadding=t,this.arrangeChildren()}get rightPadding(){var t;return((t=this.options)==null?void 0:t.rightPadding)??this.horPadding}set topPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.topPadding=t,this.arrangeChildren()}get topPadding(){var t;return((t=this.options)==null?void 0:t.topPadding)??this.vertPadding}set bottomPadding(t){if(!this.options)throw new Error("List has not been initiated!");this.options.bottomPadding=t,this.arrangeChildren()}get bottomPadding(){var t;return((t=this.options)==null?void 0:t.bottomPadding)??this.vertPadding}arrangeChildren(){var h,l;let t=0,e=this.leftPadding,s=this.topPadding;const r=((h=this.options)==null?void 0:h.elementsMargin)??0;let o=(l=this.parent)==null?void 0:l.width;this.rightPadding&&(o-=this.rightPadding),this.children.forEach((u,d)=>{switch(this.type){case"vertical":u.y=s,u.x=e,s+=r+u.height;break;case"horizontal":u.x=e,u.y=s,e+=r+u.width;break;default:u.x=e,u.y=s,u.x+u.width>o&&d>0&&(s+=r+t,e=this.leftPadding,u.x=e,u.y=s,t=0),t=Math.max(t,u.height),e+=r+u.width;break}})}removeItem(t){const e=this.children[t];e&&(this.removeChild(e),this.arrangeChildren())}}var yP=Object.defineProperty,wP=(i,t,e)=>t in i?yP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ln=(i,t,e)=>(wP(i,typeof t!="symbol"?t+"":t,e),e);class bP{constructor(t={}){Ln(this,"x"),Ln(this,"ax"),Ln(this,"dx"),Ln(this,"tx"),Ln(this,"_options"),this.x=0,this.ax=0,this.dx=0,this.tx=0,this._options=t,this._options.max=t.max||160,this._options.damp=t.damp||.8,this._options.springiness=t.springiness||.1}update(){this.ax=(this.tx-this.x)*this._options.springiness,this.dx+=this.ax,this.dx*=this._options.damp,this.dx<-this._options.max?this.dx=-this._options.max:this.dx>this._options.max&&(this.dx=this._options.max),this.x+=this.dx}reset(){this.x=0,this.ax=0,this.dx=0,this.tx=0}get max(){return this._options.max}set max(t){this._options.max=t}get damp(){return this._options.damp}set damp(t){this._options.damp=t}get springiness(){return this._options.springiness}set springiness(t){this._options.springiness=t}}var vP=Object.defineProperty,AP=(i,t,e)=>t in i?vP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ks=(i,t,e)=>(AP(i,typeof t!="symbol"?t+"":t,e),e);class SP{constructor(){Ks(this,"done"),Ks(this,"to"),Ks(this,"_spring"),Ks(this,"_pos"),Ks(this,"_speed"),Ks(this,"_correctSpeed"),this._spring=new bP,this._pos=0,this.to=0}start(t,e,s){this._speed=t,this._pos=e,this.to=s,this.done=!1,this._spring.x=this._pos,this._spring.tx=this.to;const r=this.to-this._pos,o=Math.abs(r)/r,h=Math.abs(this._speed)/this._speed;o!==h?this._correctSpeed=!0:this._correctSpeed=!1}update(){if(this._correctSpeed)this._speed*=.6,Math.abs(this._speed)<2&&(this._correctSpeed=!1),this._pos+=this._speed,this._spring.x=this._pos;else{const t=this.to-this._pos;Math.abs(t)<.05?(this._pos=this.to,this.done=!0):(this._spring.tx=this.to,this._spring.update(),this._pos=this._spring.x)}return this._pos}cancel(){}}var CP=Object.defineProperty,PP=(i,t,e)=>t in i?CP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,be=(i,t,e)=>(PP(i,typeof t!="symbol"?t+"":t,e),e);class Ef{constructor(t={}){be(this,"position",0),be(this,"constrain",!0),be(this,"min",0),be(this,"max",0),be(this,"maxSpeed",400),be(this,"_ease"),be(this,"_offset",0),be(this,"_prev",0),be(this,"_speed",0),be(this,"_hasStopped"),be(this,"_targetSpeed",0),be(this,"_speedChecker",0),be(this,"_grab",0),be(this,"_activeEase"),this.constrain=t.constrain??!0,this.maxSpeed=t.maxSpeed??400,this._ease=t.ease??new SP}set value(t){this._speed=0,this.position=t}get value(){return this.position}grab(t){this._grab=t,this._offset=this.position-t,this._speedChecker=0,this._targetSpeed=this._speed=0,this._hasStopped=!1}hold(t){this._speedChecker++,this.position=t+this._offset,this._speedChecker>1&&(this._targetSpeed=this.position-this._prev),this._speed+=(this._targetSpeed-this._speed)/2,this._speed>this.maxSpeed?this._speed=this.maxSpeed:this._speed<-this.maxSpeed&&(this._speed=-this.maxSpeed),this._prev=this.position,this.constrain&&(this._activeEase=null,this.position>this.min?this.position-=(this.position-this.min)/1.5:this.position<this.max&&(this.position+=(this.max-this.position)/1.5))}slide(t=!1){this._hasStopped||(this.constrain?this._updateConstrain(t):this._updateDefault())}get moveAmount(){return-(this.position-this._offset-this._grab)}_updateDefault(){this._speed*=.9,this.position+=this._speed,(this._speed<0?this._speed*-1:this._speed)<.01&&(this._hasStopped=!0)}_updateConstrain(t=!1){const e=this.max;t?(this.value>0&&(this.value=0),this.value>0&&(this.value=0),this.value<this.max&&(this.value=this.max),this.value<this.max&&(this.value=this.max)):this.position>this.min||this.position<e||this._activeEase?(this._activeEase||(this._activeEase=this._ease,this.position>this.min?this._activeEase.start(this._speed,this.position,this.min):this._activeEase.start(this._speed,this.position,e)),this.position=this._activeEase.update(),this._activeEase.done&&(this.position=this._activeEase.to,this._speed=0,this._activeEase=null)):this._updateDefault()}}var MP=Object.defineProperty,TP=(i,t,e)=>t in i?MP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Xi=(i,t,e)=>(TP(i,typeof t!="symbol"?t+"":t,e),e);class IP{constructor(t){Xi(this,"xAxis"),Xi(this,"yAxis"),Xi(this,"_isDown"),Xi(this,"_globalPosition"),Xi(this,"_frame"),Xi(this,"_bounds"),Xi(this,"_dirty"),Xi(this,"disableEasing",!1),this.xAxis=new Ef({ease:t.xEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.yAxis=new Ef({ease:t.yEase,maxSpeed:t.maxSpeed,constrain:t.constrain}),this.disableEasing=t.disableEasing??!1,this._frame=new ie,this._bounds=new ie,this._globalPosition=new at}pointerDown(t){this._globalPosition=t,this.xAxis.grab(t.x),this.yAxis.grab(t.y),this._isDown=!0}pointerUp(){this._isDown=!1}pointerMove(t){this._globalPosition=t}update(){this._dirty&&(this._dirty=!1,this.xAxis.min=this._bounds.left,this.xAxis.min=this._bounds.right-this._frame.width,this.xAxis.min=this._bounds.top,this.xAxis.min=this._bounds.bottom-this._frame.height),this._isDown?(this.xAxis.hold(this._globalPosition.x),this.yAxis.hold(this._globalPosition.y)):(this.xAxis.slide(this.disableEasing),this.yAxis.slide(this.disableEasing))}resize(t,e){this._frame.x=0,this._frame.width=t,this._frame.y=0,this._frame.height=e,this._dirty=!0}setBounds(t,e,s,r){this._bounds.x=t,this._bounds.width=e-t,this._bounds.y=s,this._bounds.height=r-s,this._dirty=!0}get x(){return this.xAxis.value}get y(){return this.yAxis.value}}var kP=Object.defineProperty,EP=(i,t,e)=>t in i?kP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ct=(i,t,e)=>(EP(i,typeof t!="symbol"?t+"":t,e),e);class gg extends kt{constructor(t){super(),Ct(this,"background"),Ct(this,"borderMask"),Ct(this,"lastWidth"),Ct(this,"lastHeight"),Ct(this,"__width",0),Ct(this,"__height",0),Ct(this,"_dimensionChanged",!1),Ct(this,"list"),Ct(this,"_trackpad"),Ct(this,"isDragging",0),Ct(this,"interactiveStorage",[]),Ct(this,"visibleItems",[]),Ct(this,"pressedChild"),Ct(this,"ticker",Qs.shared),Ct(this,"options"),Ct(this,"stopRenderHiddenItemsTimeout"),Ct(this,"onMouseScrollBinding",this.onMouseScroll.bind(this)),Ct(this,"dragStarTouchPoint"),Ct(this,"isOver",!1),Ct(this,"proximityRange"),Ct(this,"proximityStatusCache",[]),Ct(this,"lastScrollX"),Ct(this,"lastScrollY"),Ct(this,"proximityCheckFrameCounter",0),Ct(this,"onProximityChange",new ki.Signal),Ct(this,"onScroll",new ki.Signal),t&&this.init(t),this.ticker.add(this.update,this)}init(t){this.options=t,this.setBackground(t.background),this.__width=t.width|this.background.width,this.__height=t.height|this.background.height,this.proximityRange=t.proximityRange??0,this.list||(this.list=new xP,super.addChild(this.list)),this.list.init({type:t.type,elementsMargin:t.elementsMargin,padding:t.padding,vertPadding:t.vertPadding,horPadding:t.horPadding,topPadding:t.topPadding,bottomPadding:t.bottomPadding,leftPadding:t.leftPadding,rightPadding:t.rightPadding}),this.addItems(t.items),this.hasBounds&&(this.addMask(),this.makeScrollable()),this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0,this.options.globalScroll=t.globalScroll??!0,this.options.shiftScroll=t.shiftScroll??!1,this.resize()}get hasBounds(){return!!this.__width||!!this.__height}addItems(t){t!=null&&t.length&&t.forEach(e=>this.addItem(e))}removeItems(){this.proximityStatusCache.length=0,this.list.removeChildren()}addItem(...t){if(t.length>1)t.forEach(e=>this.addItem(e));else{const e=t[0];(!e.width||!e.height)&&console.error("ScrollBox item should have size"),e.eventMode="static",this.list.addChild(e),this.proximityStatusCache.push(!1),this.options.disableDynamicRendering||(e.renderable=this.isItemVisible(e))}return this.resize(),t[0]}removeItem(t){this.list.removeItem(t),this.proximityStatusCache.splice(t,1),this.resize()}isItemVisible(t,e=0){const s=this.options.type==="vertical"||!this.options.type;let r=!1;const o=this.list;if(s){const h=t.y+o.y;h+t.height>=-e&&h<=this.options.height+e&&(r=!0)}else{const h=t.x+o.x;h+t.width>=-e&&h<=this.options.width+e&&(r=!0)}return r}get items(){var t;return((t=this.list)==null?void 0:t.children)??[]}setBackground(t){this.background&&this.removeChild(this.background),this.options.background=t,this.background=new Dt,this.addChildAt(this.background,0),this.resize()}addMask(){this.borderMask||(this.borderMask=new Dt,super.addChild(this.borderMask),this.mask=this.borderMask),this.resize()}makeScrollable(){this._trackpad||(this._trackpad=new IP({disableEasing:this.options.disableEasing})),this.on("pointerdown",t=>{this.renderAllItems(),this.isDragging=1,this.dragStarTouchPoint=this.worldTransform.applyInverse(t.global),this._trackpad.pointerDown(this.dragStarTouchPoint);const e=this.list.worldTransform.applyInverse(t.global);this.visibleItems.forEach(s=>{s.x<e.x&&s.x+s.width>e.x&&s.y<e.y&&s.y+s.height>e.y&&(this.pressedChild=s)})}),this.on("pointerup",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreItemsInteractivity(),this.pressedChild=null,this.stopRenderHiddenItems()}),this.on("pointerover",()=>{this.isOver=!0}),this.on("pointerout",()=>{this.isOver=!1}),this.on("pointerupoutside",()=>{this.isDragging=0,this._trackpad.pointerUp(),this.restoreItemsInteractivity(),this.pressedChild=null,this.stopRenderHiddenItems()}),this.on("globalpointermove",t=>{var r;if(!this.isDragging)return;const e=this.options.type!=="horizontal",s=this.worldTransform.applyInverse(t.global);if(this.dragStarTouchPoint){const o=this.options.dragTrashHold??10;if(this.options.type==="horizontal"){const h=s.x-this.dragStarTouchPoint.x;Math.abs(h)>o&&(this.isDragging=2)}else{const h=s.y-this.dragStarTouchPoint.y;Math.abs(h)>o&&(this.isDragging=2)}}this.dragStarTouchPoint&&this.isDragging!==2||(this._trackpad.pointerMove(s),this.pressedChild&&(this.revertClick(this.pressedChild),this.pressedChild=null),(r=this.onScroll)==null||r.emit(e?this.scrollY:this.scrollX))}),document.addEventListener("wheel",this.onMouseScrollBinding,!0)}setInteractive(t){this.eventMode=t?"static":"auto"}get listHeight(){return this.list.height+this.list.topPadding+this.list.bottomPadding}get listWidth(){return this.list.width+this.list.leftPadding+this.list.rightPadding}resize(t=!1){if(this.hasBounds){if(this.renderAllItems(),this.borderMask&&(t||this._dimensionChanged||this.lastWidth!==this.listWidth||this.lastHeight!==this.listHeight)){this.options.width||(this.__width+=this.listWidth),this.options.height||(this.__height+=this.listHeight),this.borderMask.clear().roundRect(0,0,this.__width,this.__height,this.options.radius|0).fill(16711935).stroke(0),this.borderMask.eventMode="none";const e=this.options.background;this.background.clear().roundRect(0,0,this.__width,this.__height,this.options.radius|0).fill({color:e??0,alpha:e?1:1e-7}),this.options.type==="horizontal"?this.setInteractive(this.listWidth>this.__width):this.setInteractive(this.listHeight>this.__height),this.lastWidth=this.listWidth,this.lastHeight=this.listHeight}if(this._trackpad){const e=this.borderMask.width-this.list.width-this.list.leftPadding-this.list.rightPadding,s=this.borderMask.height-this.list.height-this.list.topPadding-this.list.bottomPadding;this.options.type==="vertical"?this._trackpad.yAxis.max=-Math.abs(s):this.options.type==="horizontal"?this._trackpad.xAxis.max=-Math.abs(e):(this._trackpad.yAxis.max=-Math.abs(s),this._trackpad.xAxis.max=-Math.abs(e))}this._dimensionChanged?(this.list.arrangeChildren(),this.stopRenderHiddenItems(),this._dimensionChanged=!1):this.updateVisibleItems(),this.lastScrollX=null,this.lastScrollY=null}}onMouseScroll(t){var s,r;if(!this.isOver&&!this.options.globalScroll)return;this.renderAllItems();const e=this.options.shiftScroll?typeof t.deltaX<"u"||typeof t.deltaY<"u":typeof t.deltaX<"u";if(this.options.type==="horizontal"&&e){const o=this.options.shiftScroll?t.deltaX:t.deltaY,h=this.list.x-o;if(this.listWidth<this.__width)this._trackpad.xAxis.value=0;else{const l=this.__width-this.listWidth,u=0;this._trackpad.xAxis.value=Math.min(u,Math.max(l,h))}(s=this.onScroll)==null||s.emit(this._trackpad.xAxis.value)}else if(typeof t.deltaY<"u"){const o=this.list.y-t.deltaY;if(this.listHeight<this.__height)this._trackpad.yAxis.value=0;else{const h=this.__height-this.listHeight,l=0;this._trackpad.yAxis.value=Math.min(l,Math.max(h,o))}(r=this.onScroll)==null||r.emit(this._trackpad.yAxis.value)}this.stopRenderHiddenItems()}scrollBottom(){this.interactive?this.scrollTo(this.list.children.length-1):this.scrollTop()}scrollTop(){this.renderAllItems(),this._trackpad.xAxis.value=0,this._trackpad.yAxis.value=0,this.stopRenderHiddenItems()}renderAllItems(){clearTimeout(this.stopRenderHiddenItemsTimeout),this.stopRenderHiddenItemsTimeout=null,!this.options.disableDynamicRendering&&this.items.forEach(t=>{t.renderable=!0})}stopRenderHiddenItems(){this.options.disableDynamicRendering||(this.stopRenderHiddenItemsTimeout&&(clearTimeout(this.stopRenderHiddenItemsTimeout),this.stopRenderHiddenItemsTimeout=null),this.stopRenderHiddenItemsTimeout=setTimeout(()=>this.updateVisibleItems(),2e3))}updateVisibleItems(){this.visibleItems.length=0,this.items.forEach(t=>{t.renderable=this.isItemVisible(t),this.visibleItems.push(t)})}scrollTo(t){if(!this.interactive)return;const e=this.list.children[t];e&&(this.renderAllItems(),this._trackpad.xAxis.value=this.options.type==="horizontal"?this.__width-e.x-e.width-this.list.rightPadding:0,this._trackpad.yAxis.value=!this.options.type||this.options.type==="vertical"?this.__height-e.y-e.height-this.list.bottomPadding:0,this.stopRenderHiddenItems())}scrollToPosition({x:t,y:e}){t===void 0&&e===void 0||(this.renderAllItems(),t!==void 0&&(this.scrollX=-t),e!==void 0&&(this.scrollY=-e),this.stopRenderHiddenItems())}get height(){return this.__height}set height(t){this.__height=t,this._dimensionChanged=!0,this.resize(),this.scrollTop()}get width(){return this.__width}set width(t){this.__width=t,this._dimensionChanged=!0,this.resize(),this.scrollTop()}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e=e??t,this.__width=t,this.__height=e,this._dimensionChanged=!0,this.resize(),this.scrollTop()}getSize(t){return t=t||{width:0,height:0},t.width=this.__width,t.height=this.__height,t}get scrollX(){return this._trackpad.xAxis.value}set scrollX(t){this._trackpad.xAxis.value=t}get scrollY(){return this._trackpad.yAxis.value}set scrollY(t){this._trackpad.yAxis.value=t}update(){if(!this.list)return;this._trackpad.update();const t=this.options.type==="horizontal"?"x":"y";this.list[t]!==this._trackpad[t]&&(this.list[t]=this._trackpad[t]),!this.options.disableProximityCheck&&(this._trackpad.x!==this.lastScrollX||this._trackpad.y!==this.lastScrollY)&&(this.proximityCheckFrameCounter++,this.proximityCheckFrameCounter>=(this.options.proximityDebounce??10)&&(this.items.forEach((e,s)=>{const r=this.isItemVisible(e,this.proximityRange),o=this.proximityStatusCache[s];r!==o&&(this.proximityStatusCache[s]=r,this.onProximityChange.emit({item:e,index:s,inRange:r}))}),this.lastScrollX=this._trackpad.x,this.lastScrollY=this._trackpad.y,this.proximityCheckFrameCounter=0))}destroy(t){this.ticker.remove(this.update,this),document.removeEventListener("wheel",this.onMouseScrollBinding,!0),this.background.destroy(),this.list.destroy(),super.destroy(t)}restoreItemsInteractivity(){this.interactiveStorage.forEach(t=>{t.item.eventMode=t.eventMode}),this.interactiveStorage.length=0}revertClick(t){t.eventMode!=="auto"&&(Cs.any?t.emit("pointerupoutside",null):t.emit("mouseupoutside",null),this.interactiveStorage.push({item:t,eventMode:t.eventMode}),t.eventMode="auto"),t instanceof kt&&t.children&&t.children.forEach(e=>this.revertClick(e))}get scrollHeight(){return this.list.height}get scrollWidth(){return this.list.width}}class RP extends kt{constructor(e,s,r,o,h,l,u){super({x:e,y:s});U(this,"levelText");U(this,"upgradePriceText");U(this,"upgradePriceTextDisabled");U(this,"productPriceText");U(this,"durationText");U(this,"bgBoard");U(this,"bgAnchor");U(this,"upgradeButton");U(this,"buttonViewEnabled");U(this,"buttonViewDisabled");U(this,"levelProgress");this.createBackground(),this.fillInfo(r,h,l),this.addUpgradeButton(u,o),this.addProgressBar(),this.zIndex=100}setUpgradable(e){if(!this.upgradeButton)throw new Error("Upgrade button is not defined!");this.upgradeButton.enabled=e,this.upgradeButton.view.visible=e}addProgressBar(){const e=this.getBgPosition(),s=e.w*.85,r=e.h*.15,o=e.x+e.w/2-s/2,h=e.y+e.h*.25;this.levelProgress=new HC(o,h,s,r,r*.3),this.addChild(this.levelProgress),this.levelProgress.visible=!1}addUpgradeButton(e,s){const r=Ee.SIZE*.35,o=this.getBgPosition(),h="green",l=5,u=o.w*.75;let d=o.x+o.w/2-u/2,f=o.y+o.h*.65;this.buttonViewEnabled=new Dt().roundRect(d,f,u,o.h*.2,l).fill({color:h}),this.upgradePriceText=new Qi(`${s}`,{x:d+this.buttonViewEnabled.width/2,y:f+this.buttonViewEnabled.height/2,prefix:ce.MONEYSACK+" ",fontSize:r,fill:"white"}),this.buttonViewDisabled=new Dt().roundRect(d,f,u,o.h*.2,l).fill({color:"grey"}),this.buttonViewDisabled.eventMode="none",this.upgradePriceTextDisabled=new Qi(`${s}`,{x:d+this.buttonViewEnabled.width/2,y:f+this.buttonViewEnabled.height/2,prefix:ce.MONEYSACK+" ",fontSize:r,fill:"white"}),this.upgradePriceTextDisabled.text.eventMode="none",this.buttonViewEnabled.addChild(this.upgradePriceText.text),this.buttonViewDisabled.addChild(this.upgradePriceTextDisabled.text),this.upgradeButton=new Lo(this.buttonViewEnabled),this.upgradeButton.enabled=!1;let g,m=!1;this.upgradeButton.onPress.connect(e),this.upgradeButton.onDown.connect(()=>{this.upgradeButton.view.scale=.98,m=!0,setTimeout(()=>{m&&!g&&(g=setInterval(e,100))},400)}),this.upgradeButton.onUp.connect(()=>{this.upgradeButton.view.scale=1,m=!1,clearInterval(g),g=void 0}),this.addChild(this.buttonViewDisabled),this.addChild(this.upgradeButton.view)}fillInfo(e,s,r){const o=Ee.SIZE*.35,h=this.getBgPosition();this.levelText=new Qi(`${e}`,{x:h.x+h.w/2,y:h.y+h.h*.15,prefix:"Level ",fontSize:o,fill:"black"}),this.productPriceText=new Qi(`${s.toString(0)}`,{x:h.x+h.w*.7,y:h.y+h.h*.55,prefix:`${ce.MONEYSACK}`,fontSize:o,fill:"black"}),r/=1e3,this.durationText=new Qi(r.toString()+"s",{x:h.x+h.w*.25,y:h.y+h.h*.55,prefix:`${ce.CLOCK} `,fontSize:o,fill:"black"}),this.addChild(this.levelText.text),this.addChild(this.productPriceText.text),this.addChild(this.durationText.text)}createBackground(){const e=Ee.SIZE,s="BlanchedAlmond",r=this.getBgPosition();this.bgBoard=new Dt().roundRect(r.x,r.y,r.w,r.h).fill({color:s}),this.bgBoard.eventMode="passive",this.bgAnchor=new Dt().star(e/2,-e/2,3,e/2,e/4,Math.PI).fill({color:s}),this.bgAnchor.eventMode="none",this.addChild(this.bgAnchor,this.bgBoard)}getBgPosition(){const e=Ee.SIZE,s=e*4,r=e*3;let o=e/2-s/2;this.x+o<Zt.left&&(o=this.toLocal(new at(G(3),0)).x),this.x+o+s>Zt.width&&(o=this.toLocal(new at(G(97),0)).x-s);let h=-r-e/2;return{x:o,y:h,w:s,h:r}}update(e,s,r,o){this.updateLevel(e),this.updateLevelProgressView(e),this.updateProductPrice(s),this.updateUpgradePrice(r),this.updateDuration(o)}updateLevel(e){var s;(s=this.levelText)==null||s.update(e.toString())}updateLevelProgressView(e){var l;let s=0;const r=is.DOUBLES_PRICE_AT.findIndex(u=>u>e);r>0&&(s=is.DOUBLES_PRICE_AT[r-1]),this.levelProgress.visible=!0;const o=is.DOUBLES_PRICE_AT[r]-s,h=e-s;if(h<0)throw new Error("Progress can't be below zero");(l=this.levelProgress)==null||l.update(h/o)}updateProductPrice(e){var s;(s=this.productPriceText)==null||s.update(e.toString(1))}updateUpgradePrice(e){var s,r;(s=this.upgradePriceText)==null||s.update(e.toString(1)),(r=this.upgradePriceTextDisabled)==null||r.update(e.toString(1))}updateDuration(e){var r;const s=e/1e3;(r=this.durationText)==null||r.update(s.toString()+"s")}contains(e){var s,r;return!!((s=this.bgBoard)!=null&&s.containsPoint(this.bgBoard.toLocal(e))||(r=this.bgAnchor)!=null&&r.containsPoint(this.bgAnchor.toLocal(e)))}}const fi=class fi extends Ee{constructor(e,s,r){super(e,s,{color:r.color,interactive:!0});U(this,"LEVEL",0);U(this,"productPrice");U(this,"upgradePrice");U(this,"category");U(this,"workDuration");U(this,"isUnlocked",!1);U(this,"slots",[]);U(this,"slotGrowDirection");U(this,"infoPopup");U(this,"upgradableMarker");this.category=r.category,this.productPrice=mt.from(r.productPrice),this.workDuration=r.workDuration,this.upgradePrice=mt.from(r.upgradePrice),this.infoPopup=new RP(e,s,this.LEVEL,this.upgradePrice,this.productPrice,this.workDuration,()=>this.upgrade()),this.infoPopup.visible=!1,Qn.push({job:"add",child:this.infoPopup,obstruct:!1}),this.view.alpha=.5,this.view.on("pointertap",()=>{this.infoPopup.visible=!0}),this.slotGrowDirection=r.slotGrowDirection,this.view.on("pointerover",()=>this.view.scale=1.07),this.view.on("pointerout",()=>this.view.scale=1),this.upgradableMarker=new Dt().circle(0,0,Ee.SIZE*.25).fill({color:"red"}),this.upgradableMarker.eventMode="none",this.upgradableMarker.visible=!1,this.view.addChild(this.upgradableMarker)}canUpgrade(e){const s=mt.from(this.upgradePrice);return nn(!s.negative,"upgradePrice cannot be negative"),s.substract(e),s.negative||s.isZero()}setUpgradable(e){this.upgradableMarker.visible=e,this.infoPopup.setUpgradable(e)}upgrade(e=!1){if(!(!e&&!this.canUpgrade(Pt.bcoins))){if(this.isUnlocked=!0,this.view.alpha=1,this.LEVEL+=1,e||Pt.bcoins.substract(this.upgradePrice),this.productPrice.multiply(1.08),fi.DOUBLES_PRICE_AT.includes(this.LEVEL)&&this.productPrice.multiply(2),this.upgradePrice.multiply(1.2),fi.ADD_SLOTS_AT.includes(this.LEVEL)){const s=this.addSlot();s&&Qn.push({job:"add",child:s.view,obstruct:!0})}this.updateInfo(),e||sn.update(`${ce.MONEYSACK} ${Pt.bcoins}`)}}updateInfo(){this.infoPopup.update(this.LEVEL,this.productPrice,this.upgradePrice,this.workDuration)}getSlot(){if(!this.isUnlocked)return;let e;for(let s=0;s<this.slots.length;s++)if(this.slots[s].available()){e=this.slots[s];break}return e}addSlot(){const e=this.slots.length;if(e===fi.MAX_SLOTS)return;const s=e===0?this.position:this.slots[e-1].position,r=this.slotGrowDirection==="bottom",o=s.x+(r?0:fi.SIZE+G(1)),h=s.y+(r?fi.SIZE+G(1):0),l=new $C(o,h,{color:this.color,dockSide:r?es.RIGHT:es.TOP,toggleStationDetails:()=>{this.infoPopup.visible=!0}});return this.slots.push(l),l}createProduct(){return new zC(this.category,this.color,this.productPrice)}contains(e){const s=this.view.containsPoint(this.view.toLocal(e)),r=this.slots.some(h=>h.view.containsPoint(h.view.toLocal(e))),o=this.infoPopup.contains(e);return!!(s||r||o)}};U(fi,"MAX_SLOTS",3),U(fi,"DOUBLES_PRICE_AT",[10,25,50,75,100,150,200,250,300]),U(fi,"ADD_SLOTS_AT",[1,25,75,150]);let is=fi;class _g extends Li{doWork(t,e){const s={w:this,job:t,st:Date.now()};let o=("product"in t?"FD":"FTO")==="FD"?"pick":"customer";const h=t,l=t;let u,d="start";const f=({deltaTime:g})=>{const m=Li.SPEED*g;switch(o){case"pick":d=this.moveTo(h.from.getDockingPoint(es.TOP),m,d),d==="done"&&(d="start",e.stage.removeChild(h.product),this.takeProduct(h.product),o="deliver");break;case"deliver":if(d=this.moveTo(h.to.getDockingPoint(es.BOTTOM),m,d),d==="done"){d="start";const b=this.leaveProduct(h.to);e.stage.addChild(b),Pt.bcoins.add(b.price),sn.update(`${ce.MONEYSACK} ${Pt.bcoins}`),o="done"}break;case"customer":if(d=this.moveTo(l.from.getDockingPoint(es.BOTTOM),m,d),d==="done"){d="start",o="takeOrder",u=Date.now();const b=Kt.filter(v=>v.isUnlocked),S=b[Jn(0,b.length-1)].category;l.customer.chooseProduct(S)}break;case"takeOrder":const y=l.customer.makeOrder(u);y.completion===1?(y.orders.forEach(b=>{uo.push({type:b,customer:l.customer,at:l.from})}),this.progressBar.reset(),o="done"):this.progressBar.update(y.completion);break;case"done":e.ticker.remove(f,s),Yn.push(this);break;default:throw new Error("Work fell in default case!")}};e.ticker.add(f,s)}}class Nn extends Li{doWork({type:t,customer:e,at:s},r){const o={w:this,type:t,st:Date.now()},h=Kt[t],{workDuration:l}=h,u=h.getSlot();if(!u)return!1;u.occupy();let d="station",f=-1,g=0,m,y="start";const b=({deltaTime:S})=>{const v=Li.SPEED*S;switch(d){case"station":y=this.moveTo(u.getDock(),v,y),y==="done"&&(d="work",y="start",f=Date.now());break;case"work":if(g=Date.now()-f,g>=l){d="deliver",this.progressBar.reset(),u.vacate();const M=h.createProduct();this.takeProduct(M),m=cl[Jn(0,cl.length-1)]}else this.progressBar.update(g/l);break;case"deliver":if(y=this.moveTo(m.getDockingPoint(es.BOTTOM),v,y),y==="done"){y="start";const M=this.leaveProduct(m);r.stage.addChild(M),ul.push({from:m,to:s,product:M,customer:e}),d="done"}break;case"done":r.ticker.remove(b,o),$n.push(this);break;default:throw new Error("Work fell in default case!")}};return r.ticker.add(b,o),!0}}class Ii extends Li{constructor(e,s,r){super(e,s,r);U(this,"orderQuantityRemaining",-1);U(this,"choosenProductType",-1);U(this,"quantityView");U(this,"makeOrderTime",1e3);this.quantityView=new gi({anchor:.5,text:this.orderQuantityRemaining,style:{fill:"white",fontWeight:"bold",fontSize:"30vw",padding:5,stroke:"black"}}),this.quantityView.visible=!1,this.quantityView.position.set(-this.radius,-this.radius),this.addChild(this.quantityView)}chooseProduct(e){this.choosenProductType=e}isProductChoosen(){return this.choosenProductType!==-1}takeProduct(e){super.takeProduct(e),this.isProductChoosen()&&(this.quantityView.text=this.orderQuantityRemaining,this.quantityView.visible=!0,e.priceView.visible=!1)}makeOrder(e){let r=(Date.now()-e)/this.makeOrderTime;r=r>1?1:r;let o=[];if(r===1){if(!this.isProductChoosen())throw new Error("product type not choosen yet but making order");this.orderQuantityRemaining=Jn(1,3),o=Array(this.orderQuantityRemaining).fill(this.choosenProductType);const l=Kt[this.choosenProductType].createProduct();this.takeProduct(l)}return{completion:r,orders:o}}recieveProduct(e){if(e.category===this.choosenProductType){if(this.orderQuantityRemaining===0)throw new Error("Recieve called but quantity needed is zero");this.orderQuantityRemaining-=1,this.quantityView.text=this.orderQuantityRemaining,this.isOrderCompleted()&&(this.quantityView.visible=!1)}else throw new Error("Recieve called with type mismatch")}isOrderCompleted(){if(this.orderQuantityRemaining!==0)return!1;if(!this.hold)throw new Error("OrderComplete true but no product held");return this.removeChild(this.hold),!0}doWork(e,s,r,o="waitArea"){const h={s:e,c:this,st:Date.now()};o="waitArea";let l="start";e.occupy(this);const u=({deltaTime:d})=>{const f=Li.SPEED*d;switch(o){case"waitArea":if(l=this.moveTo(e.getDockingPoint(es.TOP),f,l),l==="done"){if(l="start",Kt.filter(b=>b.isUnlocked).length===0)break;dl.push({from:e,customer:this}),o="wait"}break;case"wait":if(!this.isProductChoosen())return;const g=this.choosenProductType;if(e.has(g)){const y=e.getProduct(g);this.recieveProduct(y),r.stage.removeChild(y)}this.isOrderCompleted()&&(o="leave",e.vacate(this),s(r));break;case"leave":const m=new at(Jn(0,Zt.width-this.radius),-50);l=this.moveTo(m,f,l),l==="done"&&(l="start",o="done");break;case"done":r.ticker.remove(u,h),r.stage.removeChild(this);break}};r.ticker.add(u,h)}}class Ht{constructor(t,e,s,r){U(this,"element");U(this,"type");U(this,"price");U(this,"quantity");this.element=t,this.type=r,this.price=e,this.quantity=s}makeUpgrade(t,e=!1){if(e||(Pt.bcoins.substract(this.price),sn.update(`${ce.MONEYSACK} ${Pt.bcoins}`)),this.element instanceof Ee){const r=this.element;this.type==="speed"?r.workDuration/=this.quantity:r.productPrice.multiply(this.quantity),r.updateInfo()}else{if(this.type==="customer"){Ll(t,!1);return}const[r,o]=this.type.split("-");if(r!=="worker")throw new Error("Incorrect format");if(o==="speed"){Li.SPEED*=this.quantity;return}if(["back","front"].includes(o))gl(t,o,!1);else throw new Error("Incorrect format")}}}class BP extends Dt{constructor(e,s,r,o,h){super();U(this,"key");U(this,"upgradeButton");U(this,"upgradeItem");this.key=e,this.roundRect(0,0,s,r,8).fill("lightgrey"),this.upgradeItem=o;let l="";if(o.element instanceof Ee){l="x";const d=new Bi(G(2),st(1),st(4),st(4),{color:o.element.color});d.view.eventMode="none",this.addChild(d.view)}if(o.element instanceof Li){l=o.type.includes("speed")?"x":"+";const d=new Li(G(5.5),st(3),{color:o.element.color});d.eventMode="none",this.addChild(d)}const u=new gi({text:"untitled",style:{fontSize:G(4)}});u.position.set(G(15),st(2)),u.scale=.7,u.text=`${l}${o.quantity}  ${o.type}`,this.addChild(u),this.upgradeButton=this.addUpgradeButton({x:G(47),y:st(.5),w:G(20),h:st(5),radius:5,upgradePrice:o.price,color:"green",fontSize:G(3)},h),this.addChild(this.upgradeButton)}refreshUpgradableStatus(e){const s=mt.from(this.upgradeItem.price);nn(!s.negative,"upgradePrice cannot be negative"),s.substract(e);const r=s.negative||s.isZero();return this.upgradeButton.enabled=r,r}onLoadUpgrade(e){this.upgradeItem.makeUpgrade(e,!0)}addUpgradeButton({x:e,y:s,w:r,h:o,radius:h=5,upgradePrice:l,fontSize:u,color:d},f){const g=new Dt().roundRect(0,0,r,o,h).fill({color:d}),m=new Dt().roundRect(0,0,r,o,h).fill({color:"grey"}),y=new Qi(`${l}`,{prefix:ce.MONEYSACK+" ",fontSize:u,fill:"white"}),b=new gP({defaultView:g,disabledView:m,text:y.text});return b.enabled=!1,b.onPress.connect(f),b.position.set(e,s),b}}class LP extends kt{constructor(){super();U(this,"screenOverlayBg");U(this,"list");U(this,"closeButton");U(this,"upgradableMarker");U(this,"upgradeButton");this.list=new gg({width:G(75),height:st(60),background:"lightyellow",type:"vertical",radius:G(5),topPadding:st(10),bottomPadding:st(2),leftPadding:G(3),elementsMargin:st(.5),disableEasing:!0,globalScroll:!1}),this.list.x=G(50)-this.list.width/2,this.list.y=st(50)-this.list.height/2,this.closeButton=new Lo(new gi({text:"X",style:{fill:"darkgrey",fontSize:G(5)}})),this.closeButton.view.position.set(G(70.8),st(1.2)),this.closeButton.view.scale=.6,this.closeButton.onPress.connect(()=>this.hide());const e=new gi({text:"UPGRADES",style:{fontSize:G(6),fontWeight:"bolder"}});e.position.set(G(20),st(3));const s=new Dt().roundRect(0,0,G(75),st(9),G(5)).fill("lightyellow");e.eventMode="none",s.eventMode="none",this.list.addChild(s,this.closeButton.view,e),this.screenOverlayBg=new Bi(0,0,G(100),st(100),{color:"black",interactive:!0}),this.screenOverlayBg.view.alpha=.5,this.screenOverlayBg.view.cursor="default",this.screenOverlayBg.view.on("pointertap",this.hide.bind(this)),this.upgradableMarker=new Dt().circle(0,0,Ee.SIZE*.25).fill({color:"red"}),this.upgradableMarker.eventMode="none",this.upgradableMarker.visible=!1,this.addChild(this.screenOverlayBg.view,this.list),this.zIndex=10,this.visible=!1}show(){this.visible=!0}hide(){this.visible=!1}toggleVisibility(){this.visible=!this.visible}setup(e,s,r){this.upgradeButton=e,this.upgradeButton.view.addChild(this.upgradableMarker),s.forEach((o,h)=>this.addItem(h,o,r))}onLoad(e,s){e.forEach(r=>{const o=this.list.items.findIndex(l=>l.key===r);this.list.items[o].onLoadUpgrade(s),this.removeUpgradeWithKey(r)})}setAvailableUpgradesMarker(e){this.upgradableMarker.visible=e}addItem(e,s,r){const o=this.list.width*.92,h=this.list.height/10,l=()=>{s.makeUpgrade(r),Pt.upgrades.push(e),this.removeUpgradeWithKey(e)},u=new BP(e,o,h,s,l.bind(this));this.list.addItem(u)}removeUpgradeWithKey(e){const s=this.list.items.findIndex(r=>r.key===e);this.list.removeItem(s)}}var mg={},Fo={},xo={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */xo.exports;(function(i,t){(function(){var e,s="4.17.21",r=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",l="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",d=500,f="__lodash_placeholder__",g=1,m=2,y=4,b=1,S=2,v=1,M=2,k=4,I=8,R=16,D=32,K=64,H=128,Y=256,V=512,W=30,Et="...",$e=800,it=16,J=1,Mt=2,Ft=3,Xt=1/0,Ye=9007199254740991,tt=17976931348623157e292,et=NaN,Be=4294967295,vt=Be-1,ni=Be>>>1,as=[["ary",H],["bind",v],["bindKey",M],["curry",I],["curryRight",R],["flip",V],["partial",D],["partialRight",K],["rearg",Y]],Le="[object Arguments]",ri="[object Array]",er="[object AsyncFunction]",oi="[object Boolean]",Xe="[object Date]",ir="[object DOMException]",hs="[object Error]",_i="[object Function]",ls="[object GeneratorFunction]",ue="[object Map]",ve="[object Number]",mi="[object Null]",se="[object Object]",ai="[object Promise]",Wo="[object Proxy]",Fi="[object RegExp]",Ae="[object Set]",ks="[object String]",sr="[object Symbol]",xg="[object Undefined]",dn="[object WeakMap]",yg="[object WeakSet]",fn="[object ArrayBuffer]",Es="[object DataView]",No="[object Float32Array]",Go="[object Float64Array]",Ho="[object Int8Array]",zo="[object Int16Array]",$o="[object Int32Array]",Yo="[object Uint8Array]",Xo="[object Uint8ClampedArray]",qo="[object Uint16Array]",jo="[object Uint32Array]",wg=/\b__p \+= '';/g,bg=/\b(__p \+=) '' \+/g,vg=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Fl=/&(?:amp|lt|gt|quot|#39);/g,Ul=/[&<>"']/g,Ag=RegExp(Fl.source),Sg=RegExp(Ul.source),Cg=/<%-([\s\S]+?)%>/g,Pg=/<%([\s\S]+?)%>/g,Vl=/<%=([\s\S]+?)%>/g,Mg=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tg=/^\w*$/,Ig=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ko=/[\\^$.*+?()[\]{}|]/g,kg=RegExp(Ko.source),Zo=/^\s+/,Eg=/\s/,Rg=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Bg=/\{\n\/\* \[wrapped with (.+)\] \*/,Lg=/,? & /,Og=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Fg=/[()=,{}\[\]\/\s]/,Ug=/\\(\\)?/g,Vg=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Dl=/\w*$/,Dg=/^[-+]0x[0-9a-f]+$/i,Wg=/^0b[01]+$/i,Ng=/^\[object .+?Constructor\]$/,Gg=/^0o[0-7]+$/i,Hg=/^(?:0|[1-9]\d*)$/,zg=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,nr=/($^)/,$g=/['\n\r\u2028\u2029\\]/g,rr="\\ud800-\\udfff",Yg="\\u0300-\\u036f",Xg="\\ufe20-\\ufe2f",qg="\\u20d0-\\u20ff",Wl=Yg+Xg+qg,Nl="\\u2700-\\u27bf",Gl="a-z\\xdf-\\xf6\\xf8-\\xff",jg="\\xac\\xb1\\xd7\\xf7",Kg="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Zg="\\u2000-\\u206f",Qg=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Hl="A-Z\\xc0-\\xd6\\xd8-\\xde",zl="\\ufe0e\\ufe0f",$l=jg+Kg+Zg+Qg,Qo="[']",Jg="["+rr+"]",Yl="["+$l+"]",or="["+Wl+"]",Xl="\\d+",t_="["+Nl+"]",ql="["+Gl+"]",jl="[^"+rr+$l+Xl+Nl+Gl+Hl+"]",Jo="\\ud83c[\\udffb-\\udfff]",e_="(?:"+or+"|"+Jo+")",Kl="[^"+rr+"]",ta="(?:\\ud83c[\\udde6-\\uddff]){2}",ea="[\\ud800-\\udbff][\\udc00-\\udfff]",Rs="["+Hl+"]",Zl="\\u200d",Ql="(?:"+ql+"|"+jl+")",i_="(?:"+Rs+"|"+jl+")",Jl="(?:"+Qo+"(?:d|ll|m|re|s|t|ve))?",tc="(?:"+Qo+"(?:D|LL|M|RE|S|T|VE))?",ec=e_+"?",ic="["+zl+"]?",s_="(?:"+Zl+"(?:"+[Kl,ta,ea].join("|")+")"+ic+ec+")*",n_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",r_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",sc=ic+ec+s_,o_="(?:"+[t_,ta,ea].join("|")+")"+sc,a_="(?:"+[Kl+or+"?",or,ta,ea,Jg].join("|")+")",h_=RegExp(Qo,"g"),l_=RegExp(or,"g"),ia=RegExp(Jo+"(?="+Jo+")|"+a_+sc,"g"),c_=RegExp([Rs+"?"+ql+"+"+Jl+"(?="+[Yl,Rs,"$"].join("|")+")",i_+"+"+tc+"(?="+[Yl,Rs+Ql,"$"].join("|")+")",Rs+"?"+Ql+"+"+Jl,Rs+"+"+tc,r_,n_,Xl,o_].join("|"),"g"),u_=RegExp("["+Zl+rr+Wl+zl+"]"),d_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,f_=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],p_=-1,Tt={};Tt[No]=Tt[Go]=Tt[Ho]=Tt[zo]=Tt[$o]=Tt[Yo]=Tt[Xo]=Tt[qo]=Tt[jo]=!0,Tt[Le]=Tt[ri]=Tt[fn]=Tt[oi]=Tt[Es]=Tt[Xe]=Tt[hs]=Tt[_i]=Tt[ue]=Tt[ve]=Tt[se]=Tt[Fi]=Tt[Ae]=Tt[ks]=Tt[dn]=!1;var St={};St[Le]=St[ri]=St[fn]=St[Es]=St[oi]=St[Xe]=St[No]=St[Go]=St[Ho]=St[zo]=St[$o]=St[ue]=St[ve]=St[se]=St[Fi]=St[Ae]=St[ks]=St[sr]=St[Yo]=St[Xo]=St[qo]=St[jo]=!0,St[hs]=St[_i]=St[dn]=!1;var g_={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},__={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},m_={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},x_={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},y_=parseFloat,w_=parseInt,nc=typeof In=="object"&&In&&In.Object===Object&&In,b_=typeof self=="object"&&self&&self.Object===Object&&self,ne=nc||b_||Function("return this")(),sa=t&&!t.nodeType&&t,cs=sa&&!0&&i&&!i.nodeType&&i,rc=cs&&cs.exports===sa,na=rc&&nc.process,Oe=function(){try{var P=cs&&cs.require&&cs.require("util").types;return P||na&&na.binding&&na.binding("util")}catch{}}(),oc=Oe&&Oe.isArrayBuffer,ac=Oe&&Oe.isDate,hc=Oe&&Oe.isMap,lc=Oe&&Oe.isRegExp,cc=Oe&&Oe.isSet,uc=Oe&&Oe.isTypedArray;function Se(P,B,E){switch(E.length){case 0:return P.call(B);case 1:return P.call(B,E[0]);case 2:return P.call(B,E[0],E[1]);case 3:return P.call(B,E[0],E[1],E[2])}return P.apply(B,E)}function v_(P,B,E,z){for(var nt=-1,_t=P==null?0:P.length;++nt<_t;){var qt=P[nt];B(z,qt,E(qt),P)}return z}function Fe(P,B){for(var E=-1,z=P==null?0:P.length;++E<z&&B(P[E],E,P)!==!1;);return P}function A_(P,B){for(var E=P==null?0:P.length;E--&&B(P[E],E,P)!==!1;);return P}function dc(P,B){for(var E=-1,z=P==null?0:P.length;++E<z;)if(!B(P[E],E,P))return!1;return!0}function Ui(P,B){for(var E=-1,z=P==null?0:P.length,nt=0,_t=[];++E<z;){var qt=P[E];B(qt,E,P)&&(_t[nt++]=qt)}return _t}function ar(P,B){var E=P==null?0:P.length;return!!E&&Bs(P,B,0)>-1}function ra(P,B,E){for(var z=-1,nt=P==null?0:P.length;++z<nt;)if(E(B,P[z]))return!0;return!1}function Rt(P,B){for(var E=-1,z=P==null?0:P.length,nt=Array(z);++E<z;)nt[E]=B(P[E],E,P);return nt}function Vi(P,B){for(var E=-1,z=B.length,nt=P.length;++E<z;)P[nt+E]=B[E];return P}function oa(P,B,E,z){var nt=-1,_t=P==null?0:P.length;for(z&&_t&&(E=P[++nt]);++nt<_t;)E=B(E,P[nt],nt,P);return E}function S_(P,B,E,z){var nt=P==null?0:P.length;for(z&&nt&&(E=P[--nt]);nt--;)E=B(E,P[nt],nt,P);return E}function aa(P,B){for(var E=-1,z=P==null?0:P.length;++E<z;)if(B(P[E],E,P))return!0;return!1}var C_=ha("length");function P_(P){return P.split("")}function M_(P){return P.match(Og)||[]}function fc(P,B,E){var z;return E(P,function(nt,_t,qt){if(B(nt,_t,qt))return z=_t,!1}),z}function hr(P,B,E,z){for(var nt=P.length,_t=E+(z?1:-1);z?_t--:++_t<nt;)if(B(P[_t],_t,P))return _t;return-1}function Bs(P,B,E){return B===B?D_(P,B,E):hr(P,pc,E)}function T_(P,B,E,z){for(var nt=E-1,_t=P.length;++nt<_t;)if(z(P[nt],B))return nt;return-1}function pc(P){return P!==P}function gc(P,B){var E=P==null?0:P.length;return E?ca(P,B)/E:et}function ha(P){return function(B){return B==null?e:B[P]}}function la(P){return function(B){return P==null?e:P[B]}}function _c(P,B,E,z,nt){return nt(P,function(_t,qt,At){E=z?(z=!1,_t):B(E,_t,qt,At)}),E}function I_(P,B){var E=P.length;for(P.sort(B);E--;)P[E]=P[E].value;return P}function ca(P,B){for(var E,z=-1,nt=P.length;++z<nt;){var _t=B(P[z]);_t!==e&&(E=E===e?_t:E+_t)}return E}function ua(P,B){for(var E=-1,z=Array(P);++E<P;)z[E]=B(E);return z}function k_(P,B){return Rt(B,function(E){return[E,P[E]]})}function mc(P){return P&&P.slice(0,bc(P)+1).replace(Zo,"")}function Ce(P){return function(B){return P(B)}}function da(P,B){return Rt(B,function(E){return P[E]})}function pn(P,B){return P.has(B)}function xc(P,B){for(var E=-1,z=P.length;++E<z&&Bs(B,P[E],0)>-1;);return E}function yc(P,B){for(var E=P.length;E--&&Bs(B,P[E],0)>-1;);return E}function E_(P,B){for(var E=P.length,z=0;E--;)P[E]===B&&++z;return z}var R_=la(g_),B_=la(__);function L_(P){return"\\"+x_[P]}function O_(P,B){return P==null?e:P[B]}function Ls(P){return u_.test(P)}function F_(P){return d_.test(P)}function U_(P){for(var B,E=[];!(B=P.next()).done;)E.push(B.value);return E}function fa(P){var B=-1,E=Array(P.size);return P.forEach(function(z,nt){E[++B]=[nt,z]}),E}function wc(P,B){return function(E){return P(B(E))}}function Di(P,B){for(var E=-1,z=P.length,nt=0,_t=[];++E<z;){var qt=P[E];(qt===B||qt===f)&&(P[E]=f,_t[nt++]=E)}return _t}function lr(P){var B=-1,E=Array(P.size);return P.forEach(function(z){E[++B]=z}),E}function V_(P){var B=-1,E=Array(P.size);return P.forEach(function(z){E[++B]=[z,z]}),E}function D_(P,B,E){for(var z=E-1,nt=P.length;++z<nt;)if(P[z]===B)return z;return-1}function W_(P,B,E){for(var z=E+1;z--;)if(P[z]===B)return z;return z}function Os(P){return Ls(P)?G_(P):C_(P)}function qe(P){return Ls(P)?H_(P):P_(P)}function bc(P){for(var B=P.length;B--&&Eg.test(P.charAt(B)););return B}var N_=la(m_);function G_(P){for(var B=ia.lastIndex=0;ia.test(P);)++B;return B}function H_(P){return P.match(ia)||[]}function z_(P){return P.match(c_)||[]}var $_=function P(B){B=B==null?ne:Fs.defaults(ne.Object(),B,Fs.pick(ne,f_));var E=B.Array,z=B.Date,nt=B.Error,_t=B.Function,qt=B.Math,At=B.Object,pa=B.RegExp,Y_=B.String,Ue=B.TypeError,cr=E.prototype,X_=_t.prototype,Us=At.prototype,ur=B["__core-js_shared__"],dr=X_.toString,bt=Us.hasOwnProperty,q_=0,vc=function(){var n=/[^.]+$/.exec(ur&&ur.keys&&ur.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),fr=Us.toString,j_=dr.call(At),K_=ne._,Z_=pa("^"+dr.call(bt).replace(Ko,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),pr=rc?B.Buffer:e,Wi=B.Symbol,gr=B.Uint8Array,Ac=pr?pr.allocUnsafe:e,_r=wc(At.getPrototypeOf,At),Sc=At.create,Cc=Us.propertyIsEnumerable,mr=cr.splice,Pc=Wi?Wi.isConcatSpreadable:e,gn=Wi?Wi.iterator:e,us=Wi?Wi.toStringTag:e,xr=function(){try{var n=_s(At,"defineProperty");return n({},"",{}),n}catch{}}(),Q_=B.clearTimeout!==ne.clearTimeout&&B.clearTimeout,J_=z&&z.now!==ne.Date.now&&z.now,tm=B.setTimeout!==ne.setTimeout&&B.setTimeout,yr=qt.ceil,wr=qt.floor,ga=At.getOwnPropertySymbols,em=pr?pr.isBuffer:e,Mc=B.isFinite,im=cr.join,sm=wc(At.keys,At),jt=qt.max,oe=qt.min,nm=z.now,rm=B.parseInt,Tc=qt.random,om=cr.reverse,_a=_s(B,"DataView"),_n=_s(B,"Map"),ma=_s(B,"Promise"),Vs=_s(B,"Set"),mn=_s(B,"WeakMap"),xn=_s(At,"create"),br=mn&&new mn,Ds={},am=ms(_a),hm=ms(_n),lm=ms(ma),cm=ms(Vs),um=ms(mn),vr=Wi?Wi.prototype:e,yn=vr?vr.valueOf:e,Ic=vr?vr.toString:e;function x(n){if(Ut(n)&&!rt(n)&&!(n instanceof dt)){if(n instanceof Ve)return n;if(bt.call(n,"__wrapped__"))return ku(n)}return new Ve(n)}var Ws=function(){function n(){}return function(a){if(!Bt(a))return{};if(Sc)return Sc(a);n.prototype=a;var c=new n;return n.prototype=e,c}}();function Ar(){}function Ve(n,a){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!a,this.__index__=0,this.__values__=e}x.templateSettings={escape:Cg,evaluate:Pg,interpolate:Vl,variable:"",imports:{_:x}},x.prototype=Ar.prototype,x.prototype.constructor=x,Ve.prototype=Ws(Ar.prototype),Ve.prototype.constructor=Ve;function dt(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Be,this.__views__=[]}function dm(){var n=new dt(this.__wrapped__);return n.__actions__=me(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=me(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=me(this.__views__),n}function fm(){if(this.__filtered__){var n=new dt(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function pm(){var n=this.__wrapped__.value(),a=this.__dir__,c=rt(n),p=a<0,_=c?n.length:0,w=P0(0,_,this.__views__),A=w.start,C=w.end,T=C-A,L=p?C:A-1,O=this.__iteratees__,F=O.length,N=0,$=oe(T,this.__takeCount__);if(!c||!p&&_==T&&$==T)return Jc(n,this.__actions__);var Z=[];t:for(;T--&&N<$;){L+=a;for(var lt=-1,Q=n[L];++lt<F;){var ut=O[lt],pt=ut.iteratee,Te=ut.type,pe=pt(Q);if(Te==Mt)Q=pe;else if(!pe){if(Te==J)continue t;break t}}Z[N++]=Q}return Z}dt.prototype=Ws(Ar.prototype),dt.prototype.constructor=dt;function ds(n){var a=-1,c=n==null?0:n.length;for(this.clear();++a<c;){var p=n[a];this.set(p[0],p[1])}}function gm(){this.__data__=xn?xn(null):{},this.size=0}function _m(n){var a=this.has(n)&&delete this.__data__[n];return this.size-=a?1:0,a}function mm(n){var a=this.__data__;if(xn){var c=a[n];return c===u?e:c}return bt.call(a,n)?a[n]:e}function xm(n){var a=this.__data__;return xn?a[n]!==e:bt.call(a,n)}function ym(n,a){var c=this.__data__;return this.size+=this.has(n)?0:1,c[n]=xn&&a===e?u:a,this}ds.prototype.clear=gm,ds.prototype.delete=_m,ds.prototype.get=mm,ds.prototype.has=xm,ds.prototype.set=ym;function xi(n){var a=-1,c=n==null?0:n.length;for(this.clear();++a<c;){var p=n[a];this.set(p[0],p[1])}}function wm(){this.__data__=[],this.size=0}function bm(n){var a=this.__data__,c=Sr(a,n);if(c<0)return!1;var p=a.length-1;return c==p?a.pop():mr.call(a,c,1),--this.size,!0}function vm(n){var a=this.__data__,c=Sr(a,n);return c<0?e:a[c][1]}function Am(n){return Sr(this.__data__,n)>-1}function Sm(n,a){var c=this.__data__,p=Sr(c,n);return p<0?(++this.size,c.push([n,a])):c[p][1]=a,this}xi.prototype.clear=wm,xi.prototype.delete=bm,xi.prototype.get=vm,xi.prototype.has=Am,xi.prototype.set=Sm;function yi(n){var a=-1,c=n==null?0:n.length;for(this.clear();++a<c;){var p=n[a];this.set(p[0],p[1])}}function Cm(){this.size=0,this.__data__={hash:new ds,map:new(_n||xi),string:new ds}}function Pm(n){var a=Fr(this,n).delete(n);return this.size-=a?1:0,a}function Mm(n){return Fr(this,n).get(n)}function Tm(n){return Fr(this,n).has(n)}function Im(n,a){var c=Fr(this,n),p=c.size;return c.set(n,a),this.size+=c.size==p?0:1,this}yi.prototype.clear=Cm,yi.prototype.delete=Pm,yi.prototype.get=Mm,yi.prototype.has=Tm,yi.prototype.set=Im;function fs(n){var a=-1,c=n==null?0:n.length;for(this.__data__=new yi;++a<c;)this.add(n[a])}function km(n){return this.__data__.set(n,u),this}function Em(n){return this.__data__.has(n)}fs.prototype.add=fs.prototype.push=km,fs.prototype.has=Em;function je(n){var a=this.__data__=new xi(n);this.size=a.size}function Rm(){this.__data__=new xi,this.size=0}function Bm(n){var a=this.__data__,c=a.delete(n);return this.size=a.size,c}function Lm(n){return this.__data__.get(n)}function Om(n){return this.__data__.has(n)}function Fm(n,a){var c=this.__data__;if(c instanceof xi){var p=c.__data__;if(!_n||p.length<r-1)return p.push([n,a]),this.size=++c.size,this;c=this.__data__=new yi(p)}return c.set(n,a),this.size=c.size,this}je.prototype.clear=Rm,je.prototype.delete=Bm,je.prototype.get=Lm,je.prototype.has=Om,je.prototype.set=Fm;function kc(n,a){var c=rt(n),p=!c&&xs(n),_=!c&&!p&&$i(n),w=!c&&!p&&!_&&zs(n),A=c||p||_||w,C=A?ua(n.length,Y_):[],T=C.length;for(var L in n)(a||bt.call(n,L))&&!(A&&(L=="length"||_&&(L=="offset"||L=="parent")||w&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||Ai(L,T)))&&C.push(L);return C}function Ec(n){var a=n.length;return a?n[Ta(0,a-1)]:e}function Um(n,a){return Ur(me(n),ps(a,0,n.length))}function Vm(n){return Ur(me(n))}function xa(n,a,c){(c!==e&&!Ke(n[a],c)||c===e&&!(a in n))&&wi(n,a,c)}function wn(n,a,c){var p=n[a];(!(bt.call(n,a)&&Ke(p,c))||c===e&&!(a in n))&&wi(n,a,c)}function Sr(n,a){for(var c=n.length;c--;)if(Ke(n[c][0],a))return c;return-1}function Dm(n,a,c,p){return Ni(n,function(_,w,A){a(p,_,c(_),A)}),p}function Rc(n,a){return n&&li(a,Jt(a),n)}function Wm(n,a){return n&&li(a,ye(a),n)}function wi(n,a,c){a=="__proto__"&&xr?xr(n,a,{configurable:!0,enumerable:!0,value:c,writable:!0}):n[a]=c}function ya(n,a){for(var c=-1,p=a.length,_=E(p),w=n==null;++c<p;)_[c]=w?e:Ja(n,a[c]);return _}function ps(n,a,c){return n===n&&(c!==e&&(n=n<=c?n:c),a!==e&&(n=n>=a?n:a)),n}function De(n,a,c,p,_,w){var A,C=a&g,T=a&m,L=a&y;if(c&&(A=_?c(n,p,_,w):c(n)),A!==e)return A;if(!Bt(n))return n;var O=rt(n);if(O){if(A=T0(n),!C)return me(n,A)}else{var F=ae(n),N=F==_i||F==ls;if($i(n))return iu(n,C);if(F==se||F==Le||N&&!_){if(A=T||N?{}:bu(n),!C)return T?m0(n,Wm(A,n)):_0(n,Rc(A,n))}else{if(!St[F])return _?n:{};A=I0(n,F,C)}}w||(w=new je);var $=w.get(n);if($)return $;w.set(n,A),Ku(n)?n.forEach(function(Q){A.add(De(Q,a,c,Q,n,w))}):qu(n)&&n.forEach(function(Q,ut){A.set(ut,De(Q,a,c,ut,n,w))});var Z=L?T?Da:Va:T?ye:Jt,lt=O?e:Z(n);return Fe(lt||n,function(Q,ut){lt&&(ut=Q,Q=n[ut]),wn(A,ut,De(Q,a,c,ut,n,w))}),A}function Nm(n){var a=Jt(n);return function(c){return Bc(c,n,a)}}function Bc(n,a,c){var p=c.length;if(n==null)return!p;for(n=At(n);p--;){var _=c[p],w=a[_],A=n[_];if(A===e&&!(_ in n)||!w(A))return!1}return!0}function Lc(n,a,c){if(typeof n!="function")throw new Ue(h);return Mn(function(){n.apply(e,c)},a)}function bn(n,a,c,p){var _=-1,w=ar,A=!0,C=n.length,T=[],L=a.length;if(!C)return T;c&&(a=Rt(a,Ce(c))),p?(w=ra,A=!1):a.length>=r&&(w=pn,A=!1,a=new fs(a));t:for(;++_<C;){var O=n[_],F=c==null?O:c(O);if(O=p||O!==0?O:0,A&&F===F){for(var N=L;N--;)if(a[N]===F)continue t;T.push(O)}else w(a,F,p)||T.push(O)}return T}var Ni=au(hi),Oc=au(ba,!0);function Gm(n,a){var c=!0;return Ni(n,function(p,_,w){return c=!!a(p,_,w),c}),c}function Cr(n,a,c){for(var p=-1,_=n.length;++p<_;){var w=n[p],A=a(w);if(A!=null&&(C===e?A===A&&!Me(A):c(A,C)))var C=A,T=w}return T}function Hm(n,a,c,p){var _=n.length;for(c=ht(c),c<0&&(c=-c>_?0:_+c),p=p===e||p>_?_:ht(p),p<0&&(p+=_),p=c>p?0:Qu(p);c<p;)n[c++]=a;return n}function Fc(n,a){var c=[];return Ni(n,function(p,_,w){a(p,_,w)&&c.push(p)}),c}function re(n,a,c,p,_){var w=-1,A=n.length;for(c||(c=E0),_||(_=[]);++w<A;){var C=n[w];a>0&&c(C)?a>1?re(C,a-1,c,p,_):Vi(_,C):p||(_[_.length]=C)}return _}var wa=hu(),Uc=hu(!0);function hi(n,a){return n&&wa(n,a,Jt)}function ba(n,a){return n&&Uc(n,a,Jt)}function Pr(n,a){return Ui(a,function(c){return Si(n[c])})}function gs(n,a){a=Hi(a,n);for(var c=0,p=a.length;n!=null&&c<p;)n=n[ci(a[c++])];return c&&c==p?n:e}function Vc(n,a,c){var p=a(n);return rt(n)?p:Vi(p,c(n))}function de(n){return n==null?n===e?xg:mi:us&&us in At(n)?C0(n):V0(n)}function va(n,a){return n>a}function zm(n,a){return n!=null&&bt.call(n,a)}function $m(n,a){return n!=null&&a in At(n)}function Ym(n,a,c){return n>=oe(a,c)&&n<jt(a,c)}function Aa(n,a,c){for(var p=c?ra:ar,_=n[0].length,w=n.length,A=w,C=E(w),T=1/0,L=[];A--;){var O=n[A];A&&a&&(O=Rt(O,Ce(a))),T=oe(O.length,T),C[A]=!c&&(a||_>=120&&O.length>=120)?new fs(A&&O):e}O=n[0];var F=-1,N=C[0];t:for(;++F<_&&L.length<T;){var $=O[F],Z=a?a($):$;if($=c||$!==0?$:0,!(N?pn(N,Z):p(L,Z,c))){for(A=w;--A;){var lt=C[A];if(!(lt?pn(lt,Z):p(n[A],Z,c)))continue t}N&&N.push(Z),L.push($)}}return L}function Xm(n,a,c,p){return hi(n,function(_,w,A){a(p,c(_),w,A)}),p}function vn(n,a,c){a=Hi(a,n),n=Cu(n,a);var p=n==null?n:n[ci(Ne(a))];return p==null?e:Se(p,n,c)}function Dc(n){return Ut(n)&&de(n)==Le}function qm(n){return Ut(n)&&de(n)==fn}function jm(n){return Ut(n)&&de(n)==Xe}function An(n,a,c,p,_){return n===a?!0:n==null||a==null||!Ut(n)&&!Ut(a)?n!==n&&a!==a:Km(n,a,c,p,An,_)}function Km(n,a,c,p,_,w){var A=rt(n),C=rt(a),T=A?ri:ae(n),L=C?ri:ae(a);T=T==Le?se:T,L=L==Le?se:L;var O=T==se,F=L==se,N=T==L;if(N&&$i(n)){if(!$i(a))return!1;A=!0,O=!1}if(N&&!O)return w||(w=new je),A||zs(n)?xu(n,a,c,p,_,w):A0(n,a,T,c,p,_,w);if(!(c&b)){var $=O&&bt.call(n,"__wrapped__"),Z=F&&bt.call(a,"__wrapped__");if($||Z){var lt=$?n.value():n,Q=Z?a.value():a;return w||(w=new je),_(lt,Q,c,p,w)}}return N?(w||(w=new je),S0(n,a,c,p,_,w)):!1}function Zm(n){return Ut(n)&&ae(n)==ue}function Sa(n,a,c,p){var _=c.length,w=_,A=!p;if(n==null)return!w;for(n=At(n);_--;){var C=c[_];if(A&&C[2]?C[1]!==n[C[0]]:!(C[0]in n))return!1}for(;++_<w;){C=c[_];var T=C[0],L=n[T],O=C[1];if(A&&C[2]){if(L===e&&!(T in n))return!1}else{var F=new je;if(p)var N=p(L,O,T,n,a,F);if(!(N===e?An(O,L,b|S,p,F):N))return!1}}return!0}function Wc(n){if(!Bt(n)||B0(n))return!1;var a=Si(n)?Z_:Ng;return a.test(ms(n))}function Qm(n){return Ut(n)&&de(n)==Fi}function Jm(n){return Ut(n)&&ae(n)==Ae}function t0(n){return Ut(n)&&Hr(n.length)&&!!Tt[de(n)]}function Nc(n){return typeof n=="function"?n:n==null?we:typeof n=="object"?rt(n)?zc(n[0],n[1]):Hc(n):ld(n)}function Ca(n){if(!Pn(n))return sm(n);var a=[];for(var c in At(n))bt.call(n,c)&&c!="constructor"&&a.push(c);return a}function e0(n){if(!Bt(n))return U0(n);var a=Pn(n),c=[];for(var p in n)p=="constructor"&&(a||!bt.call(n,p))||c.push(p);return c}function Pa(n,a){return n<a}function Gc(n,a){var c=-1,p=xe(n)?E(n.length):[];return Ni(n,function(_,w,A){p[++c]=a(_,w,A)}),p}function Hc(n){var a=Na(n);return a.length==1&&a[0][2]?Au(a[0][0],a[0][1]):function(c){return c===n||Sa(c,n,a)}}function zc(n,a){return Ha(n)&&vu(a)?Au(ci(n),a):function(c){var p=Ja(c,n);return p===e&&p===a?th(c,n):An(a,p,b|S)}}function Mr(n,a,c,p,_){n!==a&&wa(a,function(w,A){if(_||(_=new je),Bt(w))i0(n,a,A,c,Mr,p,_);else{var C=p?p($a(n,A),w,A+"",n,a,_):e;C===e&&(C=w),xa(n,A,C)}},ye)}function i0(n,a,c,p,_,w,A){var C=$a(n,c),T=$a(a,c),L=A.get(T);if(L){xa(n,c,L);return}var O=w?w(C,T,c+"",n,a,A):e,F=O===e;if(F){var N=rt(T),$=!N&&$i(T),Z=!N&&!$&&zs(T);O=T,N||$||Z?rt(C)?O=C:Nt(C)?O=me(C):$?(F=!1,O=iu(T,!0)):Z?(F=!1,O=su(T,!0)):O=[]:Tn(T)||xs(T)?(O=C,xs(C)?O=Ju(C):(!Bt(C)||Si(C))&&(O=bu(T))):F=!1}F&&(A.set(T,O),_(O,T,p,w,A),A.delete(T)),xa(n,c,O)}function $c(n,a){var c=n.length;if(c)return a+=a<0?c:0,Ai(a,c)?n[a]:e}function Yc(n,a,c){a.length?a=Rt(a,function(w){return rt(w)?function(A){return gs(A,w.length===1?w[0]:w)}:w}):a=[we];var p=-1;a=Rt(a,Ce(j()));var _=Gc(n,function(w,A,C){var T=Rt(a,function(L){return L(w)});return{criteria:T,index:++p,value:w}});return I_(_,function(w,A){return g0(w,A,c)})}function s0(n,a){return Xc(n,a,function(c,p){return th(n,p)})}function Xc(n,a,c){for(var p=-1,_=a.length,w={};++p<_;){var A=a[p],C=gs(n,A);c(C,A)&&Sn(w,Hi(A,n),C)}return w}function n0(n){return function(a){return gs(a,n)}}function Ma(n,a,c,p){var _=p?T_:Bs,w=-1,A=a.length,C=n;for(n===a&&(a=me(a)),c&&(C=Rt(n,Ce(c)));++w<A;)for(var T=0,L=a[w],O=c?c(L):L;(T=_(C,O,T,p))>-1;)C!==n&&mr.call(C,T,1),mr.call(n,T,1);return n}function qc(n,a){for(var c=n?a.length:0,p=c-1;c--;){var _=a[c];if(c==p||_!==w){var w=_;Ai(_)?mr.call(n,_,1):Ea(n,_)}}return n}function Ta(n,a){return n+wr(Tc()*(a-n+1))}function r0(n,a,c,p){for(var _=-1,w=jt(yr((a-n)/(c||1)),0),A=E(w);w--;)A[p?w:++_]=n,n+=c;return A}function Ia(n,a){var c="";if(!n||a<1||a>Ye)return c;do a%2&&(c+=n),a=wr(a/2),a&&(n+=n);while(a);return c}function ct(n,a){return Ya(Su(n,a,we),n+"")}function o0(n){return Ec($s(n))}function a0(n,a){var c=$s(n);return Ur(c,ps(a,0,c.length))}function Sn(n,a,c,p){if(!Bt(n))return n;a=Hi(a,n);for(var _=-1,w=a.length,A=w-1,C=n;C!=null&&++_<w;){var T=ci(a[_]),L=c;if(T==="__proto__"||T==="constructor"||T==="prototype")return n;if(_!=A){var O=C[T];L=p?p(O,T,C):e,L===e&&(L=Bt(O)?O:Ai(a[_+1])?[]:{})}wn(C,T,L),C=C[T]}return n}var jc=br?function(n,a){return br.set(n,a),n}:we,h0=xr?function(n,a){return xr(n,"toString",{configurable:!0,enumerable:!1,value:ih(a),writable:!0})}:we;function l0(n){return Ur($s(n))}function We(n,a,c){var p=-1,_=n.length;a<0&&(a=-a>_?0:_+a),c=c>_?_:c,c<0&&(c+=_),_=a>c?0:c-a>>>0,a>>>=0;for(var w=E(_);++p<_;)w[p]=n[p+a];return w}function c0(n,a){var c;return Ni(n,function(p,_,w){return c=a(p,_,w),!c}),!!c}function Tr(n,a,c){var p=0,_=n==null?p:n.length;if(typeof a=="number"&&a===a&&_<=ni){for(;p<_;){var w=p+_>>>1,A=n[w];A!==null&&!Me(A)&&(c?A<=a:A<a)?p=w+1:_=w}return _}return ka(n,a,we,c)}function ka(n,a,c,p){var _=0,w=n==null?0:n.length;if(w===0)return 0;a=c(a);for(var A=a!==a,C=a===null,T=Me(a),L=a===e;_<w;){var O=wr((_+w)/2),F=c(n[O]),N=F!==e,$=F===null,Z=F===F,lt=Me(F);if(A)var Q=p||Z;else L?Q=Z&&(p||N):C?Q=Z&&N&&(p||!$):T?Q=Z&&N&&!$&&(p||!lt):$||lt?Q=!1:Q=p?F<=a:F<a;Q?_=O+1:w=O}return oe(w,vt)}function Kc(n,a){for(var c=-1,p=n.length,_=0,w=[];++c<p;){var A=n[c],C=a?a(A):A;if(!c||!Ke(C,T)){var T=C;w[_++]=A===0?0:A}}return w}function Zc(n){return typeof n=="number"?n:Me(n)?et:+n}function Pe(n){if(typeof n=="string")return n;if(rt(n))return Rt(n,Pe)+"";if(Me(n))return Ic?Ic.call(n):"";var a=n+"";return a=="0"&&1/n==-Xt?"-0":a}function Gi(n,a,c){var p=-1,_=ar,w=n.length,A=!0,C=[],T=C;if(c)A=!1,_=ra;else if(w>=r){var L=a?null:b0(n);if(L)return lr(L);A=!1,_=pn,T=new fs}else T=a?[]:C;t:for(;++p<w;){var O=n[p],F=a?a(O):O;if(O=c||O!==0?O:0,A&&F===F){for(var N=T.length;N--;)if(T[N]===F)continue t;a&&T.push(F),C.push(O)}else _(T,F,c)||(T!==C&&T.push(F),C.push(O))}return C}function Ea(n,a){return a=Hi(a,n),n=Cu(n,a),n==null||delete n[ci(Ne(a))]}function Qc(n,a,c,p){return Sn(n,a,c(gs(n,a)),p)}function Ir(n,a,c,p){for(var _=n.length,w=p?_:-1;(p?w--:++w<_)&&a(n[w],w,n););return c?We(n,p?0:w,p?w+1:_):We(n,p?w+1:0,p?_:w)}function Jc(n,a){var c=n;return c instanceof dt&&(c=c.value()),oa(a,function(p,_){return _.func.apply(_.thisArg,Vi([p],_.args))},c)}function Ra(n,a,c){var p=n.length;if(p<2)return p?Gi(n[0]):[];for(var _=-1,w=E(p);++_<p;)for(var A=n[_],C=-1;++C<p;)C!=_&&(w[_]=bn(w[_]||A,n[C],a,c));return Gi(re(w,1),a,c)}function tu(n,a,c){for(var p=-1,_=n.length,w=a.length,A={};++p<_;){var C=p<w?a[p]:e;c(A,n[p],C)}return A}function Ba(n){return Nt(n)?n:[]}function La(n){return typeof n=="function"?n:we}function Hi(n,a){return rt(n)?n:Ha(n,a)?[n]:Iu(wt(n))}var u0=ct;function zi(n,a,c){var p=n.length;return c=c===e?p:c,!a&&c>=p?n:We(n,a,c)}var eu=Q_||function(n){return ne.clearTimeout(n)};function iu(n,a){if(a)return n.slice();var c=n.length,p=Ac?Ac(c):new n.constructor(c);return n.copy(p),p}function Oa(n){var a=new n.constructor(n.byteLength);return new gr(a).set(new gr(n)),a}function d0(n,a){var c=a?Oa(n.buffer):n.buffer;return new n.constructor(c,n.byteOffset,n.byteLength)}function f0(n){var a=new n.constructor(n.source,Dl.exec(n));return a.lastIndex=n.lastIndex,a}function p0(n){return yn?At(yn.call(n)):{}}function su(n,a){var c=a?Oa(n.buffer):n.buffer;return new n.constructor(c,n.byteOffset,n.length)}function nu(n,a){if(n!==a){var c=n!==e,p=n===null,_=n===n,w=Me(n),A=a!==e,C=a===null,T=a===a,L=Me(a);if(!C&&!L&&!w&&n>a||w&&A&&T&&!C&&!L||p&&A&&T||!c&&T||!_)return 1;if(!p&&!w&&!L&&n<a||L&&c&&_&&!p&&!w||C&&c&&_||!A&&_||!T)return-1}return 0}function g0(n,a,c){for(var p=-1,_=n.criteria,w=a.criteria,A=_.length,C=c.length;++p<A;){var T=nu(_[p],w[p]);if(T){if(p>=C)return T;var L=c[p];return T*(L=="desc"?-1:1)}}return n.index-a.index}function ru(n,a,c,p){for(var _=-1,w=n.length,A=c.length,C=-1,T=a.length,L=jt(w-A,0),O=E(T+L),F=!p;++C<T;)O[C]=a[C];for(;++_<A;)(F||_<w)&&(O[c[_]]=n[_]);for(;L--;)O[C++]=n[_++];return O}function ou(n,a,c,p){for(var _=-1,w=n.length,A=-1,C=c.length,T=-1,L=a.length,O=jt(w-C,0),F=E(O+L),N=!p;++_<O;)F[_]=n[_];for(var $=_;++T<L;)F[$+T]=a[T];for(;++A<C;)(N||_<w)&&(F[$+c[A]]=n[_++]);return F}function me(n,a){var c=-1,p=n.length;for(a||(a=E(p));++c<p;)a[c]=n[c];return a}function li(n,a,c,p){var _=!c;c||(c={});for(var w=-1,A=a.length;++w<A;){var C=a[w],T=p?p(c[C],n[C],C,c,n):e;T===e&&(T=n[C]),_?wi(c,C,T):wn(c,C,T)}return c}function _0(n,a){return li(n,Ga(n),a)}function m0(n,a){return li(n,yu(n),a)}function kr(n,a){return function(c,p){var _=rt(c)?v_:Dm,w=a?a():{};return _(c,n,j(p,2),w)}}function Ns(n){return ct(function(a,c){var p=-1,_=c.length,w=_>1?c[_-1]:e,A=_>2?c[2]:e;for(w=n.length>3&&typeof w=="function"?(_--,w):e,A&&fe(c[0],c[1],A)&&(w=_<3?e:w,_=1),a=At(a);++p<_;){var C=c[p];C&&n(a,C,p,w)}return a})}function au(n,a){return function(c,p){if(c==null)return c;if(!xe(c))return n(c,p);for(var _=c.length,w=a?_:-1,A=At(c);(a?w--:++w<_)&&p(A[w],w,A)!==!1;);return c}}function hu(n){return function(a,c,p){for(var _=-1,w=At(a),A=p(a),C=A.length;C--;){var T=A[n?C:++_];if(c(w[T],T,w)===!1)break}return a}}function x0(n,a,c){var p=a&v,_=Cn(n);function w(){var A=this&&this!==ne&&this instanceof w?_:n;return A.apply(p?c:this,arguments)}return w}function lu(n){return function(a){a=wt(a);var c=Ls(a)?qe(a):e,p=c?c[0]:a.charAt(0),_=c?zi(c,1).join(""):a.slice(1);return p[n]()+_}}function Gs(n){return function(a){return oa(ad(od(a).replace(h_,"")),n,"")}}function Cn(n){return function(){var a=arguments;switch(a.length){case 0:return new n;case 1:return new n(a[0]);case 2:return new n(a[0],a[1]);case 3:return new n(a[0],a[1],a[2]);case 4:return new n(a[0],a[1],a[2],a[3]);case 5:return new n(a[0],a[1],a[2],a[3],a[4]);case 6:return new n(a[0],a[1],a[2],a[3],a[4],a[5]);case 7:return new n(a[0],a[1],a[2],a[3],a[4],a[5],a[6])}var c=Ws(n.prototype),p=n.apply(c,a);return Bt(p)?p:c}}function y0(n,a,c){var p=Cn(n);function _(){for(var w=arguments.length,A=E(w),C=w,T=Hs(_);C--;)A[C]=arguments[C];var L=w<3&&A[0]!==T&&A[w-1]!==T?[]:Di(A,T);if(w-=L.length,w<c)return pu(n,a,Er,_.placeholder,e,A,L,e,e,c-w);var O=this&&this!==ne&&this instanceof _?p:n;return Se(O,this,A)}return _}function cu(n){return function(a,c,p){var _=At(a);if(!xe(a)){var w=j(c,3);a=Jt(a),c=function(C){return w(_[C],C,_)}}var A=n(a,c,p);return A>-1?_[w?a[A]:A]:e}}function uu(n){return vi(function(a){var c=a.length,p=c,_=Ve.prototype.thru;for(n&&a.reverse();p--;){var w=a[p];if(typeof w!="function")throw new Ue(h);if(_&&!A&&Or(w)=="wrapper")var A=new Ve([],!0)}for(p=A?p:c;++p<c;){w=a[p];var C=Or(w),T=C=="wrapper"?Wa(w):e;T&&za(T[0])&&T[1]==(H|I|D|Y)&&!T[4].length&&T[9]==1?A=A[Or(T[0])].apply(A,T[3]):A=w.length==1&&za(w)?A[C]():A.thru(w)}return function(){var L=arguments,O=L[0];if(A&&L.length==1&&rt(O))return A.plant(O).value();for(var F=0,N=c?a[F].apply(this,L):O;++F<c;)N=a[F].call(this,N);return N}})}function Er(n,a,c,p,_,w,A,C,T,L){var O=a&H,F=a&v,N=a&M,$=a&(I|R),Z=a&V,lt=N?e:Cn(n);function Q(){for(var ut=arguments.length,pt=E(ut),Te=ut;Te--;)pt[Te]=arguments[Te];if($)var pe=Hs(Q),Ie=E_(pt,pe);if(p&&(pt=ru(pt,p,_,$)),w&&(pt=ou(pt,w,A,$)),ut-=Ie,$&&ut<L){var Gt=Di(pt,pe);return pu(n,a,Er,Q.placeholder,c,pt,Gt,C,T,L-ut)}var Ze=F?c:this,Pi=N?Ze[n]:n;return ut=pt.length,C?pt=D0(pt,C):Z&&ut>1&&pt.reverse(),O&&T<ut&&(pt.length=T),this&&this!==ne&&this instanceof Q&&(Pi=lt||Cn(Pi)),Pi.apply(Ze,pt)}return Q}function du(n,a){return function(c,p){return Xm(c,n,a(p),{})}}function Rr(n,a){return function(c,p){var _;if(c===e&&p===e)return a;if(c!==e&&(_=c),p!==e){if(_===e)return p;typeof c=="string"||typeof p=="string"?(c=Pe(c),p=Pe(p)):(c=Zc(c),p=Zc(p)),_=n(c,p)}return _}}function Fa(n){return vi(function(a){return a=Rt(a,Ce(j())),ct(function(c){var p=this;return n(a,function(_){return Se(_,p,c)})})})}function Br(n,a){a=a===e?" ":Pe(a);var c=a.length;if(c<2)return c?Ia(a,n):a;var p=Ia(a,yr(n/Os(a)));return Ls(a)?zi(qe(p),0,n).join(""):p.slice(0,n)}function w0(n,a,c,p){var _=a&v,w=Cn(n);function A(){for(var C=-1,T=arguments.length,L=-1,O=p.length,F=E(O+T),N=this&&this!==ne&&this instanceof A?w:n;++L<O;)F[L]=p[L];for(;T--;)F[L++]=arguments[++C];return Se(N,_?c:this,F)}return A}function fu(n){return function(a,c,p){return p&&typeof p!="number"&&fe(a,c,p)&&(c=p=e),a=Ci(a),c===e?(c=a,a=0):c=Ci(c),p=p===e?a<c?1:-1:Ci(p),r0(a,c,p,n)}}function Lr(n){return function(a,c){return typeof a=="string"&&typeof c=="string"||(a=Ge(a),c=Ge(c)),n(a,c)}}function pu(n,a,c,p,_,w,A,C,T,L){var O=a&I,F=O?A:e,N=O?e:A,$=O?w:e,Z=O?e:w;a|=O?D:K,a&=~(O?K:D),a&k||(a&=~(v|M));var lt=[n,a,_,$,F,Z,N,C,T,L],Q=c.apply(e,lt);return za(n)&&Pu(Q,lt),Q.placeholder=p,Mu(Q,n,a)}function Ua(n){var a=qt[n];return function(c,p){if(c=Ge(c),p=p==null?0:oe(ht(p),292),p&&Mc(c)){var _=(wt(c)+"e").split("e"),w=a(_[0]+"e"+(+_[1]+p));return _=(wt(w)+"e").split("e"),+(_[0]+"e"+(+_[1]-p))}return a(c)}}var b0=Vs&&1/lr(new Vs([,-0]))[1]==Xt?function(n){return new Vs(n)}:rh;function gu(n){return function(a){var c=ae(a);return c==ue?fa(a):c==Ae?V_(a):k_(a,n(a))}}function bi(n,a,c,p,_,w,A,C){var T=a&M;if(!T&&typeof n!="function")throw new Ue(h);var L=p?p.length:0;if(L||(a&=~(D|K),p=_=e),A=A===e?A:jt(ht(A),0),C=C===e?C:ht(C),L-=_?_.length:0,a&K){var O=p,F=_;p=_=e}var N=T?e:Wa(n),$=[n,a,c,p,_,O,F,w,A,C];if(N&&F0($,N),n=$[0],a=$[1],c=$[2],p=$[3],_=$[4],C=$[9]=$[9]===e?T?0:n.length:jt($[9]-L,0),!C&&a&(I|R)&&(a&=~(I|R)),!a||a==v)var Z=x0(n,a,c);else a==I||a==R?Z=y0(n,a,C):(a==D||a==(v|D))&&!_.length?Z=w0(n,a,c,p):Z=Er.apply(e,$);var lt=N?jc:Pu;return Mu(lt(Z,$),n,a)}function _u(n,a,c,p){return n===e||Ke(n,Us[c])&&!bt.call(p,c)?a:n}function mu(n,a,c,p,_,w){return Bt(n)&&Bt(a)&&(w.set(a,n),Mr(n,a,e,mu,w),w.delete(a)),n}function v0(n){return Tn(n)?e:n}function xu(n,a,c,p,_,w){var A=c&b,C=n.length,T=a.length;if(C!=T&&!(A&&T>C))return!1;var L=w.get(n),O=w.get(a);if(L&&O)return L==a&&O==n;var F=-1,N=!0,$=c&S?new fs:e;for(w.set(n,a),w.set(a,n);++F<C;){var Z=n[F],lt=a[F];if(p)var Q=A?p(lt,Z,F,a,n,w):p(Z,lt,F,n,a,w);if(Q!==e){if(Q)continue;N=!1;break}if($){if(!aa(a,function(ut,pt){if(!pn($,pt)&&(Z===ut||_(Z,ut,c,p,w)))return $.push(pt)})){N=!1;break}}else if(!(Z===lt||_(Z,lt,c,p,w))){N=!1;break}}return w.delete(n),w.delete(a),N}function A0(n,a,c,p,_,w,A){switch(c){case Es:if(n.byteLength!=a.byteLength||n.byteOffset!=a.byteOffset)return!1;n=n.buffer,a=a.buffer;case fn:return!(n.byteLength!=a.byteLength||!w(new gr(n),new gr(a)));case oi:case Xe:case ve:return Ke(+n,+a);case hs:return n.name==a.name&&n.message==a.message;case Fi:case ks:return n==a+"";case ue:var C=fa;case Ae:var T=p&b;if(C||(C=lr),n.size!=a.size&&!T)return!1;var L=A.get(n);if(L)return L==a;p|=S,A.set(n,a);var O=xu(C(n),C(a),p,_,w,A);return A.delete(n),O;case sr:if(yn)return yn.call(n)==yn.call(a)}return!1}function S0(n,a,c,p,_,w){var A=c&b,C=Va(n),T=C.length,L=Va(a),O=L.length;if(T!=O&&!A)return!1;for(var F=T;F--;){var N=C[F];if(!(A?N in a:bt.call(a,N)))return!1}var $=w.get(n),Z=w.get(a);if($&&Z)return $==a&&Z==n;var lt=!0;w.set(n,a),w.set(a,n);for(var Q=A;++F<T;){N=C[F];var ut=n[N],pt=a[N];if(p)var Te=A?p(pt,ut,N,a,n,w):p(ut,pt,N,n,a,w);if(!(Te===e?ut===pt||_(ut,pt,c,p,w):Te)){lt=!1;break}Q||(Q=N=="constructor")}if(lt&&!Q){var pe=n.constructor,Ie=a.constructor;pe!=Ie&&"constructor"in n&&"constructor"in a&&!(typeof pe=="function"&&pe instanceof pe&&typeof Ie=="function"&&Ie instanceof Ie)&&(lt=!1)}return w.delete(n),w.delete(a),lt}function vi(n){return Ya(Su(n,e,Bu),n+"")}function Va(n){return Vc(n,Jt,Ga)}function Da(n){return Vc(n,ye,yu)}var Wa=br?function(n){return br.get(n)}:rh;function Or(n){for(var a=n.name+"",c=Ds[a],p=bt.call(Ds,a)?c.length:0;p--;){var _=c[p],w=_.func;if(w==null||w==n)return _.name}return a}function Hs(n){var a=bt.call(x,"placeholder")?x:n;return a.placeholder}function j(){var n=x.iteratee||sh;return n=n===sh?Nc:n,arguments.length?n(arguments[0],arguments[1]):n}function Fr(n,a){var c=n.__data__;return R0(a)?c[typeof a=="string"?"string":"hash"]:c.map}function Na(n){for(var a=Jt(n),c=a.length;c--;){var p=a[c],_=n[p];a[c]=[p,_,vu(_)]}return a}function _s(n,a){var c=O_(n,a);return Wc(c)?c:e}function C0(n){var a=bt.call(n,us),c=n[us];try{n[us]=e;var p=!0}catch{}var _=fr.call(n);return p&&(a?n[us]=c:delete n[us]),_}var Ga=ga?function(n){return n==null?[]:(n=At(n),Ui(ga(n),function(a){return Cc.call(n,a)}))}:oh,yu=ga?function(n){for(var a=[];n;)Vi(a,Ga(n)),n=_r(n);return a}:oh,ae=de;(_a&&ae(new _a(new ArrayBuffer(1)))!=Es||_n&&ae(new _n)!=ue||ma&&ae(ma.resolve())!=ai||Vs&&ae(new Vs)!=Ae||mn&&ae(new mn)!=dn)&&(ae=function(n){var a=de(n),c=a==se?n.constructor:e,p=c?ms(c):"";if(p)switch(p){case am:return Es;case hm:return ue;case lm:return ai;case cm:return Ae;case um:return dn}return a});function P0(n,a,c){for(var p=-1,_=c.length;++p<_;){var w=c[p],A=w.size;switch(w.type){case"drop":n+=A;break;case"dropRight":a-=A;break;case"take":a=oe(a,n+A);break;case"takeRight":n=jt(n,a-A);break}}return{start:n,end:a}}function M0(n){var a=n.match(Bg);return a?a[1].split(Lg):[]}function wu(n,a,c){a=Hi(a,n);for(var p=-1,_=a.length,w=!1;++p<_;){var A=ci(a[p]);if(!(w=n!=null&&c(n,A)))break;n=n[A]}return w||++p!=_?w:(_=n==null?0:n.length,!!_&&Hr(_)&&Ai(A,_)&&(rt(n)||xs(n)))}function T0(n){var a=n.length,c=new n.constructor(a);return a&&typeof n[0]=="string"&&bt.call(n,"index")&&(c.index=n.index,c.input=n.input),c}function bu(n){return typeof n.constructor=="function"&&!Pn(n)?Ws(_r(n)):{}}function I0(n,a,c){var p=n.constructor;switch(a){case fn:return Oa(n);case oi:case Xe:return new p(+n);case Es:return d0(n,c);case No:case Go:case Ho:case zo:case $o:case Yo:case Xo:case qo:case jo:return su(n,c);case ue:return new p;case ve:case ks:return new p(n);case Fi:return f0(n);case Ae:return new p;case sr:return p0(n)}}function k0(n,a){var c=a.length;if(!c)return n;var p=c-1;return a[p]=(c>1?"& ":"")+a[p],a=a.join(c>2?", ":" "),n.replace(Rg,`{
/* [wrapped with `+a+`] */
`)}function E0(n){return rt(n)||xs(n)||!!(Pc&&n&&n[Pc])}function Ai(n,a){var c=typeof n;return a=a??Ye,!!a&&(c=="number"||c!="symbol"&&Hg.test(n))&&n>-1&&n%1==0&&n<a}function fe(n,a,c){if(!Bt(c))return!1;var p=typeof a;return(p=="number"?xe(c)&&Ai(a,c.length):p=="string"&&a in c)?Ke(c[a],n):!1}function Ha(n,a){if(rt(n))return!1;var c=typeof n;return c=="number"||c=="symbol"||c=="boolean"||n==null||Me(n)?!0:Tg.test(n)||!Mg.test(n)||a!=null&&n in At(a)}function R0(n){var a=typeof n;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?n!=="__proto__":n===null}function za(n){var a=Or(n),c=x[a];if(typeof c!="function"||!(a in dt.prototype))return!1;if(n===c)return!0;var p=Wa(c);return!!p&&n===p[0]}function B0(n){return!!vc&&vc in n}var L0=ur?Si:ah;function Pn(n){var a=n&&n.constructor,c=typeof a=="function"&&a.prototype||Us;return n===c}function vu(n){return n===n&&!Bt(n)}function Au(n,a){return function(c){return c==null?!1:c[n]===a&&(a!==e||n in At(c))}}function O0(n){var a=Nr(n,function(p){return c.size===d&&c.clear(),p}),c=a.cache;return a}function F0(n,a){var c=n[1],p=a[1],_=c|p,w=_<(v|M|H),A=p==H&&c==I||p==H&&c==Y&&n[7].length<=a[8]||p==(H|Y)&&a[7].length<=a[8]&&c==I;if(!(w||A))return n;p&v&&(n[2]=a[2],_|=c&v?0:k);var C=a[3];if(C){var T=n[3];n[3]=T?ru(T,C,a[4]):C,n[4]=T?Di(n[3],f):a[4]}return C=a[5],C&&(T=n[5],n[5]=T?ou(T,C,a[6]):C,n[6]=T?Di(n[5],f):a[6]),C=a[7],C&&(n[7]=C),p&H&&(n[8]=n[8]==null?a[8]:oe(n[8],a[8])),n[9]==null&&(n[9]=a[9]),n[0]=a[0],n[1]=_,n}function U0(n){var a=[];if(n!=null)for(var c in At(n))a.push(c);return a}function V0(n){return fr.call(n)}function Su(n,a,c){return a=jt(a===e?n.length-1:a,0),function(){for(var p=arguments,_=-1,w=jt(p.length-a,0),A=E(w);++_<w;)A[_]=p[a+_];_=-1;for(var C=E(a+1);++_<a;)C[_]=p[_];return C[a]=c(A),Se(n,this,C)}}function Cu(n,a){return a.length<2?n:gs(n,We(a,0,-1))}function D0(n,a){for(var c=n.length,p=oe(a.length,c),_=me(n);p--;){var w=a[p];n[p]=Ai(w,c)?_[w]:e}return n}function $a(n,a){if(!(a==="constructor"&&typeof n[a]=="function")&&a!="__proto__")return n[a]}var Pu=Tu(jc),Mn=tm||function(n,a){return ne.setTimeout(n,a)},Ya=Tu(h0);function Mu(n,a,c){var p=a+"";return Ya(n,k0(p,W0(M0(p),c)))}function Tu(n){var a=0,c=0;return function(){var p=nm(),_=it-(p-c);if(c=p,_>0){if(++a>=$e)return arguments[0]}else a=0;return n.apply(e,arguments)}}function Ur(n,a){var c=-1,p=n.length,_=p-1;for(a=a===e?p:a;++c<a;){var w=Ta(c,_),A=n[w];n[w]=n[c],n[c]=A}return n.length=a,n}var Iu=O0(function(n){var a=[];return n.charCodeAt(0)===46&&a.push(""),n.replace(Ig,function(c,p,_,w){a.push(_?w.replace(Ug,"$1"):p||c)}),a});function ci(n){if(typeof n=="string"||Me(n))return n;var a=n+"";return a=="0"&&1/n==-Xt?"-0":a}function ms(n){if(n!=null){try{return dr.call(n)}catch{}try{return n+""}catch{}}return""}function W0(n,a){return Fe(as,function(c){var p="_."+c[0];a&c[1]&&!ar(n,p)&&n.push(p)}),n.sort()}function ku(n){if(n instanceof dt)return n.clone();var a=new Ve(n.__wrapped__,n.__chain__);return a.__actions__=me(n.__actions__),a.__index__=n.__index__,a.__values__=n.__values__,a}function N0(n,a,c){(c?fe(n,a,c):a===e)?a=1:a=jt(ht(a),0);var p=n==null?0:n.length;if(!p||a<1)return[];for(var _=0,w=0,A=E(yr(p/a));_<p;)A[w++]=We(n,_,_+=a);return A}function G0(n){for(var a=-1,c=n==null?0:n.length,p=0,_=[];++a<c;){var w=n[a];w&&(_[p++]=w)}return _}function H0(){var n=arguments.length;if(!n)return[];for(var a=E(n-1),c=arguments[0],p=n;p--;)a[p-1]=arguments[p];return Vi(rt(c)?me(c):[c],re(a,1))}var z0=ct(function(n,a){return Nt(n)?bn(n,re(a,1,Nt,!0)):[]}),$0=ct(function(n,a){var c=Ne(a);return Nt(c)&&(c=e),Nt(n)?bn(n,re(a,1,Nt,!0),j(c,2)):[]}),Y0=ct(function(n,a){var c=Ne(a);return Nt(c)&&(c=e),Nt(n)?bn(n,re(a,1,Nt,!0),e,c):[]});function X0(n,a,c){var p=n==null?0:n.length;return p?(a=c||a===e?1:ht(a),We(n,a<0?0:a,p)):[]}function q0(n,a,c){var p=n==null?0:n.length;return p?(a=c||a===e?1:ht(a),a=p-a,We(n,0,a<0?0:a)):[]}function j0(n,a){return n&&n.length?Ir(n,j(a,3),!0,!0):[]}function K0(n,a){return n&&n.length?Ir(n,j(a,3),!0):[]}function Z0(n,a,c,p){var _=n==null?0:n.length;return _?(c&&typeof c!="number"&&fe(n,a,c)&&(c=0,p=_),Hm(n,a,c,p)):[]}function Eu(n,a,c){var p=n==null?0:n.length;if(!p)return-1;var _=c==null?0:ht(c);return _<0&&(_=jt(p+_,0)),hr(n,j(a,3),_)}function Ru(n,a,c){var p=n==null?0:n.length;if(!p)return-1;var _=p-1;return c!==e&&(_=ht(c),_=c<0?jt(p+_,0):oe(_,p-1)),hr(n,j(a,3),_,!0)}function Bu(n){var a=n==null?0:n.length;return a?re(n,1):[]}function Q0(n){var a=n==null?0:n.length;return a?re(n,Xt):[]}function J0(n,a){var c=n==null?0:n.length;return c?(a=a===e?1:ht(a),re(n,a)):[]}function tx(n){for(var a=-1,c=n==null?0:n.length,p={};++a<c;){var _=n[a];p[_[0]]=_[1]}return p}function Lu(n){return n&&n.length?n[0]:e}function ex(n,a,c){var p=n==null?0:n.length;if(!p)return-1;var _=c==null?0:ht(c);return _<0&&(_=jt(p+_,0)),Bs(n,a,_)}function ix(n){var a=n==null?0:n.length;return a?We(n,0,-1):[]}var sx=ct(function(n){var a=Rt(n,Ba);return a.length&&a[0]===n[0]?Aa(a):[]}),nx=ct(function(n){var a=Ne(n),c=Rt(n,Ba);return a===Ne(c)?a=e:c.pop(),c.length&&c[0]===n[0]?Aa(c,j(a,2)):[]}),rx=ct(function(n){var a=Ne(n),c=Rt(n,Ba);return a=typeof a=="function"?a:e,a&&c.pop(),c.length&&c[0]===n[0]?Aa(c,e,a):[]});function ox(n,a){return n==null?"":im.call(n,a)}function Ne(n){var a=n==null?0:n.length;return a?n[a-1]:e}function ax(n,a,c){var p=n==null?0:n.length;if(!p)return-1;var _=p;return c!==e&&(_=ht(c),_=_<0?jt(p+_,0):oe(_,p-1)),a===a?W_(n,a,_):hr(n,pc,_,!0)}function hx(n,a){return n&&n.length?$c(n,ht(a)):e}var lx=ct(Ou);function Ou(n,a){return n&&n.length&&a&&a.length?Ma(n,a):n}function cx(n,a,c){return n&&n.length&&a&&a.length?Ma(n,a,j(c,2)):n}function ux(n,a,c){return n&&n.length&&a&&a.length?Ma(n,a,e,c):n}var dx=vi(function(n,a){var c=n==null?0:n.length,p=ya(n,a);return qc(n,Rt(a,function(_){return Ai(_,c)?+_:_}).sort(nu)),p});function fx(n,a){var c=[];if(!(n&&n.length))return c;var p=-1,_=[],w=n.length;for(a=j(a,3);++p<w;){var A=n[p];a(A,p,n)&&(c.push(A),_.push(p))}return qc(n,_),c}function Xa(n){return n==null?n:om.call(n)}function px(n,a,c){var p=n==null?0:n.length;return p?(c&&typeof c!="number"&&fe(n,a,c)?(a=0,c=p):(a=a==null?0:ht(a),c=c===e?p:ht(c)),We(n,a,c)):[]}function gx(n,a){return Tr(n,a)}function _x(n,a,c){return ka(n,a,j(c,2))}function mx(n,a){var c=n==null?0:n.length;if(c){var p=Tr(n,a);if(p<c&&Ke(n[p],a))return p}return-1}function xx(n,a){return Tr(n,a,!0)}function yx(n,a,c){return ka(n,a,j(c,2),!0)}function wx(n,a){var c=n==null?0:n.length;if(c){var p=Tr(n,a,!0)-1;if(Ke(n[p],a))return p}return-1}function bx(n){return n&&n.length?Kc(n):[]}function vx(n,a){return n&&n.length?Kc(n,j(a,2)):[]}function Ax(n){var a=n==null?0:n.length;return a?We(n,1,a):[]}function Sx(n,a,c){return n&&n.length?(a=c||a===e?1:ht(a),We(n,0,a<0?0:a)):[]}function Cx(n,a,c){var p=n==null?0:n.length;return p?(a=c||a===e?1:ht(a),a=p-a,We(n,a<0?0:a,p)):[]}function Px(n,a){return n&&n.length?Ir(n,j(a,3),!1,!0):[]}function Mx(n,a){return n&&n.length?Ir(n,j(a,3)):[]}var Tx=ct(function(n){return Gi(re(n,1,Nt,!0))}),Ix=ct(function(n){var a=Ne(n);return Nt(a)&&(a=e),Gi(re(n,1,Nt,!0),j(a,2))}),kx=ct(function(n){var a=Ne(n);return a=typeof a=="function"?a:e,Gi(re(n,1,Nt,!0),e,a)});function Ex(n){return n&&n.length?Gi(n):[]}function Rx(n,a){return n&&n.length?Gi(n,j(a,2)):[]}function Bx(n,a){return a=typeof a=="function"?a:e,n&&n.length?Gi(n,e,a):[]}function qa(n){if(!(n&&n.length))return[];var a=0;return n=Ui(n,function(c){if(Nt(c))return a=jt(c.length,a),!0}),ua(a,function(c){return Rt(n,ha(c))})}function Fu(n,a){if(!(n&&n.length))return[];var c=qa(n);return a==null?c:Rt(c,function(p){return Se(a,e,p)})}var Lx=ct(function(n,a){return Nt(n)?bn(n,a):[]}),Ox=ct(function(n){return Ra(Ui(n,Nt))}),Fx=ct(function(n){var a=Ne(n);return Nt(a)&&(a=e),Ra(Ui(n,Nt),j(a,2))}),Ux=ct(function(n){var a=Ne(n);return a=typeof a=="function"?a:e,Ra(Ui(n,Nt),e,a)}),Vx=ct(qa);function Dx(n,a){return tu(n||[],a||[],wn)}function Wx(n,a){return tu(n||[],a||[],Sn)}var Nx=ct(function(n){var a=n.length,c=a>1?n[a-1]:e;return c=typeof c=="function"?(n.pop(),c):e,Fu(n,c)});function Uu(n){var a=x(n);return a.__chain__=!0,a}function Gx(n,a){return a(n),n}function Vr(n,a){return a(n)}var Hx=vi(function(n){var a=n.length,c=a?n[0]:0,p=this.__wrapped__,_=function(w){return ya(w,n)};return a>1||this.__actions__.length||!(p instanceof dt)||!Ai(c)?this.thru(_):(p=p.slice(c,+c+(a?1:0)),p.__actions__.push({func:Vr,args:[_],thisArg:e}),new Ve(p,this.__chain__).thru(function(w){return a&&!w.length&&w.push(e),w}))});function zx(){return Uu(this)}function $x(){return new Ve(this.value(),this.__chain__)}function Yx(){this.__values__===e&&(this.__values__=Zu(this.value()));var n=this.__index__>=this.__values__.length,a=n?e:this.__values__[this.__index__++];return{done:n,value:a}}function Xx(){return this}function qx(n){for(var a,c=this;c instanceof Ar;){var p=ku(c);p.__index__=0,p.__values__=e,a?_.__wrapped__=p:a=p;var _=p;c=c.__wrapped__}return _.__wrapped__=n,a}function jx(){var n=this.__wrapped__;if(n instanceof dt){var a=n;return this.__actions__.length&&(a=new dt(this)),a=a.reverse(),a.__actions__.push({func:Vr,args:[Xa],thisArg:e}),new Ve(a,this.__chain__)}return this.thru(Xa)}function Kx(){return Jc(this.__wrapped__,this.__actions__)}var Zx=kr(function(n,a,c){bt.call(n,c)?++n[c]:wi(n,c,1)});function Qx(n,a,c){var p=rt(n)?dc:Gm;return c&&fe(n,a,c)&&(a=e),p(n,j(a,3))}function Jx(n,a){var c=rt(n)?Ui:Fc;return c(n,j(a,3))}var ty=cu(Eu),ey=cu(Ru);function iy(n,a){return re(Dr(n,a),1)}function sy(n,a){return re(Dr(n,a),Xt)}function ny(n,a,c){return c=c===e?1:ht(c),re(Dr(n,a),c)}function Vu(n,a){var c=rt(n)?Fe:Ni;return c(n,j(a,3))}function Du(n,a){var c=rt(n)?A_:Oc;return c(n,j(a,3))}var ry=kr(function(n,a,c){bt.call(n,c)?n[c].push(a):wi(n,c,[a])});function oy(n,a,c,p){n=xe(n)?n:$s(n),c=c&&!p?ht(c):0;var _=n.length;return c<0&&(c=jt(_+c,0)),zr(n)?c<=_&&n.indexOf(a,c)>-1:!!_&&Bs(n,a,c)>-1}var ay=ct(function(n,a,c){var p=-1,_=typeof a=="function",w=xe(n)?E(n.length):[];return Ni(n,function(A){w[++p]=_?Se(a,A,c):vn(A,a,c)}),w}),hy=kr(function(n,a,c){wi(n,c,a)});function Dr(n,a){var c=rt(n)?Rt:Gc;return c(n,j(a,3))}function ly(n,a,c,p){return n==null?[]:(rt(a)||(a=a==null?[]:[a]),c=p?e:c,rt(c)||(c=c==null?[]:[c]),Yc(n,a,c))}var cy=kr(function(n,a,c){n[c?0:1].push(a)},function(){return[[],[]]});function uy(n,a,c){var p=rt(n)?oa:_c,_=arguments.length<3;return p(n,j(a,4),c,_,Ni)}function dy(n,a,c){var p=rt(n)?S_:_c,_=arguments.length<3;return p(n,j(a,4),c,_,Oc)}function fy(n,a){var c=rt(n)?Ui:Fc;return c(n,Gr(j(a,3)))}function py(n){var a=rt(n)?Ec:o0;return a(n)}function gy(n,a,c){(c?fe(n,a,c):a===e)?a=1:a=ht(a);var p=rt(n)?Um:a0;return p(n,a)}function _y(n){var a=rt(n)?Vm:l0;return a(n)}function my(n){if(n==null)return 0;if(xe(n))return zr(n)?Os(n):n.length;var a=ae(n);return a==ue||a==Ae?n.size:Ca(n).length}function xy(n,a,c){var p=rt(n)?aa:c0;return c&&fe(n,a,c)&&(a=e),p(n,j(a,3))}var yy=ct(function(n,a){if(n==null)return[];var c=a.length;return c>1&&fe(n,a[0],a[1])?a=[]:c>2&&fe(a[0],a[1],a[2])&&(a=[a[0]]),Yc(n,re(a,1),[])}),Wr=J_||function(){return ne.Date.now()};function wy(n,a){if(typeof a!="function")throw new Ue(h);return n=ht(n),function(){if(--n<1)return a.apply(this,arguments)}}function Wu(n,a,c){return a=c?e:a,a=n&&a==null?n.length:a,bi(n,H,e,e,e,e,a)}function Nu(n,a){var c;if(typeof a!="function")throw new Ue(h);return n=ht(n),function(){return--n>0&&(c=a.apply(this,arguments)),n<=1&&(a=e),c}}var ja=ct(function(n,a,c){var p=v;if(c.length){var _=Di(c,Hs(ja));p|=D}return bi(n,p,a,c,_)}),Gu=ct(function(n,a,c){var p=v|M;if(c.length){var _=Di(c,Hs(Gu));p|=D}return bi(a,p,n,c,_)});function Hu(n,a,c){a=c?e:a;var p=bi(n,I,e,e,e,e,e,a);return p.placeholder=Hu.placeholder,p}function zu(n,a,c){a=c?e:a;var p=bi(n,R,e,e,e,e,e,a);return p.placeholder=zu.placeholder,p}function $u(n,a,c){var p,_,w,A,C,T,L=0,O=!1,F=!1,N=!0;if(typeof n!="function")throw new Ue(h);a=Ge(a)||0,Bt(c)&&(O=!!c.leading,F="maxWait"in c,w=F?jt(Ge(c.maxWait)||0,a):w,N="trailing"in c?!!c.trailing:N);function $(Gt){var Ze=p,Pi=_;return p=_=e,L=Gt,A=n.apply(Pi,Ze),A}function Z(Gt){return L=Gt,C=Mn(ut,a),O?$(Gt):A}function lt(Gt){var Ze=Gt-T,Pi=Gt-L,cd=a-Ze;return F?oe(cd,w-Pi):cd}function Q(Gt){var Ze=Gt-T,Pi=Gt-L;return T===e||Ze>=a||Ze<0||F&&Pi>=w}function ut(){var Gt=Wr();if(Q(Gt))return pt(Gt);C=Mn(ut,lt(Gt))}function pt(Gt){return C=e,N&&p?$(Gt):(p=_=e,A)}function Te(){C!==e&&eu(C),L=0,p=T=_=C=e}function pe(){return C===e?A:pt(Wr())}function Ie(){var Gt=Wr(),Ze=Q(Gt);if(p=arguments,_=this,T=Gt,Ze){if(C===e)return Z(T);if(F)return eu(C),C=Mn(ut,a),$(T)}return C===e&&(C=Mn(ut,a)),A}return Ie.cancel=Te,Ie.flush=pe,Ie}var by=ct(function(n,a){return Lc(n,1,a)}),vy=ct(function(n,a,c){return Lc(n,Ge(a)||0,c)});function Ay(n){return bi(n,V)}function Nr(n,a){if(typeof n!="function"||a!=null&&typeof a!="function")throw new Ue(h);var c=function(){var p=arguments,_=a?a.apply(this,p):p[0],w=c.cache;if(w.has(_))return w.get(_);var A=n.apply(this,p);return c.cache=w.set(_,A)||w,A};return c.cache=new(Nr.Cache||yi),c}Nr.Cache=yi;function Gr(n){if(typeof n!="function")throw new Ue(h);return function(){var a=arguments;switch(a.length){case 0:return!n.call(this);case 1:return!n.call(this,a[0]);case 2:return!n.call(this,a[0],a[1]);case 3:return!n.call(this,a[0],a[1],a[2])}return!n.apply(this,a)}}function Sy(n){return Nu(2,n)}var Cy=u0(function(n,a){a=a.length==1&&rt(a[0])?Rt(a[0],Ce(j())):Rt(re(a,1),Ce(j()));var c=a.length;return ct(function(p){for(var _=-1,w=oe(p.length,c);++_<w;)p[_]=a[_].call(this,p[_]);return Se(n,this,p)})}),Ka=ct(function(n,a){var c=Di(a,Hs(Ka));return bi(n,D,e,a,c)}),Yu=ct(function(n,a){var c=Di(a,Hs(Yu));return bi(n,K,e,a,c)}),Py=vi(function(n,a){return bi(n,Y,e,e,e,a)});function My(n,a){if(typeof n!="function")throw new Ue(h);return a=a===e?a:ht(a),ct(n,a)}function Ty(n,a){if(typeof n!="function")throw new Ue(h);return a=a==null?0:jt(ht(a),0),ct(function(c){var p=c[a],_=zi(c,0,a);return p&&Vi(_,p),Se(n,this,_)})}function Iy(n,a,c){var p=!0,_=!0;if(typeof n!="function")throw new Ue(h);return Bt(c)&&(p="leading"in c?!!c.leading:p,_="trailing"in c?!!c.trailing:_),$u(n,a,{leading:p,maxWait:a,trailing:_})}function ky(n){return Wu(n,1)}function Ey(n,a){return Ka(La(a),n)}function Ry(){if(!arguments.length)return[];var n=arguments[0];return rt(n)?n:[n]}function By(n){return De(n,y)}function Ly(n,a){return a=typeof a=="function"?a:e,De(n,y,a)}function Oy(n){return De(n,g|y)}function Fy(n,a){return a=typeof a=="function"?a:e,De(n,g|y,a)}function Uy(n,a){return a==null||Bc(n,a,Jt(a))}function Ke(n,a){return n===a||n!==n&&a!==a}var Vy=Lr(va),Dy=Lr(function(n,a){return n>=a}),xs=Dc(function(){return arguments}())?Dc:function(n){return Ut(n)&&bt.call(n,"callee")&&!Cc.call(n,"callee")},rt=E.isArray,Wy=oc?Ce(oc):qm;function xe(n){return n!=null&&Hr(n.length)&&!Si(n)}function Nt(n){return Ut(n)&&xe(n)}function Ny(n){return n===!0||n===!1||Ut(n)&&de(n)==oi}var $i=em||ah,Gy=ac?Ce(ac):jm;function Hy(n){return Ut(n)&&n.nodeType===1&&!Tn(n)}function zy(n){if(n==null)return!0;if(xe(n)&&(rt(n)||typeof n=="string"||typeof n.splice=="function"||$i(n)||zs(n)||xs(n)))return!n.length;var a=ae(n);if(a==ue||a==Ae)return!n.size;if(Pn(n))return!Ca(n).length;for(var c in n)if(bt.call(n,c))return!1;return!0}function $y(n,a){return An(n,a)}function Yy(n,a,c){c=typeof c=="function"?c:e;var p=c?c(n,a):e;return p===e?An(n,a,e,c):!!p}function Za(n){if(!Ut(n))return!1;var a=de(n);return a==hs||a==ir||typeof n.message=="string"&&typeof n.name=="string"&&!Tn(n)}function Xy(n){return typeof n=="number"&&Mc(n)}function Si(n){if(!Bt(n))return!1;var a=de(n);return a==_i||a==ls||a==er||a==Wo}function Xu(n){return typeof n=="number"&&n==ht(n)}function Hr(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=Ye}function Bt(n){var a=typeof n;return n!=null&&(a=="object"||a=="function")}function Ut(n){return n!=null&&typeof n=="object"}var qu=hc?Ce(hc):Zm;function qy(n,a){return n===a||Sa(n,a,Na(a))}function jy(n,a,c){return c=typeof c=="function"?c:e,Sa(n,a,Na(a),c)}function Ky(n){return ju(n)&&n!=+n}function Zy(n){if(L0(n))throw new nt(o);return Wc(n)}function Qy(n){return n===null}function Jy(n){return n==null}function ju(n){return typeof n=="number"||Ut(n)&&de(n)==ve}function Tn(n){if(!Ut(n)||de(n)!=se)return!1;var a=_r(n);if(a===null)return!0;var c=bt.call(a,"constructor")&&a.constructor;return typeof c=="function"&&c instanceof c&&dr.call(c)==j_}var Qa=lc?Ce(lc):Qm;function tw(n){return Xu(n)&&n>=-Ye&&n<=Ye}var Ku=cc?Ce(cc):Jm;function zr(n){return typeof n=="string"||!rt(n)&&Ut(n)&&de(n)==ks}function Me(n){return typeof n=="symbol"||Ut(n)&&de(n)==sr}var zs=uc?Ce(uc):t0;function ew(n){return n===e}function iw(n){return Ut(n)&&ae(n)==dn}function sw(n){return Ut(n)&&de(n)==yg}var nw=Lr(Pa),rw=Lr(function(n,a){return n<=a});function Zu(n){if(!n)return[];if(xe(n))return zr(n)?qe(n):me(n);if(gn&&n[gn])return U_(n[gn]());var a=ae(n),c=a==ue?fa:a==Ae?lr:$s;return c(n)}function Ci(n){if(!n)return n===0?n:0;if(n=Ge(n),n===Xt||n===-Xt){var a=n<0?-1:1;return a*tt}return n===n?n:0}function ht(n){var a=Ci(n),c=a%1;return a===a?c?a-c:a:0}function Qu(n){return n?ps(ht(n),0,Be):0}function Ge(n){if(typeof n=="number")return n;if(Me(n))return et;if(Bt(n)){var a=typeof n.valueOf=="function"?n.valueOf():n;n=Bt(a)?a+"":a}if(typeof n!="string")return n===0?n:+n;n=mc(n);var c=Wg.test(n);return c||Gg.test(n)?w_(n.slice(2),c?2:8):Dg.test(n)?et:+n}function Ju(n){return li(n,ye(n))}function ow(n){return n?ps(ht(n),-Ye,Ye):n===0?n:0}function wt(n){return n==null?"":Pe(n)}var aw=Ns(function(n,a){if(Pn(a)||xe(a)){li(a,Jt(a),n);return}for(var c in a)bt.call(a,c)&&wn(n,c,a[c])}),td=Ns(function(n,a){li(a,ye(a),n)}),$r=Ns(function(n,a,c,p){li(a,ye(a),n,p)}),hw=Ns(function(n,a,c,p){li(a,Jt(a),n,p)}),lw=vi(ya);function cw(n,a){var c=Ws(n);return a==null?c:Rc(c,a)}var uw=ct(function(n,a){n=At(n);var c=-1,p=a.length,_=p>2?a[2]:e;for(_&&fe(a[0],a[1],_)&&(p=1);++c<p;)for(var w=a[c],A=ye(w),C=-1,T=A.length;++C<T;){var L=A[C],O=n[L];(O===e||Ke(O,Us[L])&&!bt.call(n,L))&&(n[L]=w[L])}return n}),dw=ct(function(n){return n.push(e,mu),Se(ed,e,n)});function fw(n,a){return fc(n,j(a,3),hi)}function pw(n,a){return fc(n,j(a,3),ba)}function gw(n,a){return n==null?n:wa(n,j(a,3),ye)}function _w(n,a){return n==null?n:Uc(n,j(a,3),ye)}function mw(n,a){return n&&hi(n,j(a,3))}function xw(n,a){return n&&ba(n,j(a,3))}function yw(n){return n==null?[]:Pr(n,Jt(n))}function ww(n){return n==null?[]:Pr(n,ye(n))}function Ja(n,a,c){var p=n==null?e:gs(n,a);return p===e?c:p}function bw(n,a){return n!=null&&wu(n,a,zm)}function th(n,a){return n!=null&&wu(n,a,$m)}var vw=du(function(n,a,c){a!=null&&typeof a.toString!="function"&&(a=fr.call(a)),n[a]=c},ih(we)),Aw=du(function(n,a,c){a!=null&&typeof a.toString!="function"&&(a=fr.call(a)),bt.call(n,a)?n[a].push(c):n[a]=[c]},j),Sw=ct(vn);function Jt(n){return xe(n)?kc(n):Ca(n)}function ye(n){return xe(n)?kc(n,!0):e0(n)}function Cw(n,a){var c={};return a=j(a,3),hi(n,function(p,_,w){wi(c,a(p,_,w),p)}),c}function Pw(n,a){var c={};return a=j(a,3),hi(n,function(p,_,w){wi(c,_,a(p,_,w))}),c}var Mw=Ns(function(n,a,c){Mr(n,a,c)}),ed=Ns(function(n,a,c,p){Mr(n,a,c,p)}),Tw=vi(function(n,a){var c={};if(n==null)return c;var p=!1;a=Rt(a,function(w){return w=Hi(w,n),p||(p=w.length>1),w}),li(n,Da(n),c),p&&(c=De(c,g|m|y,v0));for(var _=a.length;_--;)Ea(c,a[_]);return c});function Iw(n,a){return id(n,Gr(j(a)))}var kw=vi(function(n,a){return n==null?{}:s0(n,a)});function id(n,a){if(n==null)return{};var c=Rt(Da(n),function(p){return[p]});return a=j(a),Xc(n,c,function(p,_){return a(p,_[0])})}function Ew(n,a,c){a=Hi(a,n);var p=-1,_=a.length;for(_||(_=1,n=e);++p<_;){var w=n==null?e:n[ci(a[p])];w===e&&(p=_,w=c),n=Si(w)?w.call(n):w}return n}function Rw(n,a,c){return n==null?n:Sn(n,a,c)}function Bw(n,a,c,p){return p=typeof p=="function"?p:e,n==null?n:Sn(n,a,c,p)}var sd=gu(Jt),nd=gu(ye);function Lw(n,a,c){var p=rt(n),_=p||$i(n)||zs(n);if(a=j(a,4),c==null){var w=n&&n.constructor;_?c=p?new w:[]:Bt(n)?c=Si(w)?Ws(_r(n)):{}:c={}}return(_?Fe:hi)(n,function(A,C,T){return a(c,A,C,T)}),c}function Ow(n,a){return n==null?!0:Ea(n,a)}function Fw(n,a,c){return n==null?n:Qc(n,a,La(c))}function Uw(n,a,c,p){return p=typeof p=="function"?p:e,n==null?n:Qc(n,a,La(c),p)}function $s(n){return n==null?[]:da(n,Jt(n))}function Vw(n){return n==null?[]:da(n,ye(n))}function Dw(n,a,c){return c===e&&(c=a,a=e),c!==e&&(c=Ge(c),c=c===c?c:0),a!==e&&(a=Ge(a),a=a===a?a:0),ps(Ge(n),a,c)}function Ww(n,a,c){return a=Ci(a),c===e?(c=a,a=0):c=Ci(c),n=Ge(n),Ym(n,a,c)}function Nw(n,a,c){if(c&&typeof c!="boolean"&&fe(n,a,c)&&(a=c=e),c===e&&(typeof a=="boolean"?(c=a,a=e):typeof n=="boolean"&&(c=n,n=e)),n===e&&a===e?(n=0,a=1):(n=Ci(n),a===e?(a=n,n=0):a=Ci(a)),n>a){var p=n;n=a,a=p}if(c||n%1||a%1){var _=Tc();return oe(n+_*(a-n+y_("1e-"+((_+"").length-1))),a)}return Ta(n,a)}var Gw=Gs(function(n,a,c){return a=a.toLowerCase(),n+(c?rd(a):a)});function rd(n){return eh(wt(n).toLowerCase())}function od(n){return n=wt(n),n&&n.replace(zg,R_).replace(l_,"")}function Hw(n,a,c){n=wt(n),a=Pe(a);var p=n.length;c=c===e?p:ps(ht(c),0,p);var _=c;return c-=a.length,c>=0&&n.slice(c,_)==a}function zw(n){return n=wt(n),n&&Sg.test(n)?n.replace(Ul,B_):n}function $w(n){return n=wt(n),n&&kg.test(n)?n.replace(Ko,"\\$&"):n}var Yw=Gs(function(n,a,c){return n+(c?"-":"")+a.toLowerCase()}),Xw=Gs(function(n,a,c){return n+(c?" ":"")+a.toLowerCase()}),qw=lu("toLowerCase");function jw(n,a,c){n=wt(n),a=ht(a);var p=a?Os(n):0;if(!a||p>=a)return n;var _=(a-p)/2;return Br(wr(_),c)+n+Br(yr(_),c)}function Kw(n,a,c){n=wt(n),a=ht(a);var p=a?Os(n):0;return a&&p<a?n+Br(a-p,c):n}function Zw(n,a,c){n=wt(n),a=ht(a);var p=a?Os(n):0;return a&&p<a?Br(a-p,c)+n:n}function Qw(n,a,c){return c||a==null?a=0:a&&(a=+a),rm(wt(n).replace(Zo,""),a||0)}function Jw(n,a,c){return(c?fe(n,a,c):a===e)?a=1:a=ht(a),Ia(wt(n),a)}function tb(){var n=arguments,a=wt(n[0]);return n.length<3?a:a.replace(n[1],n[2])}var eb=Gs(function(n,a,c){return n+(c?"_":"")+a.toLowerCase()});function ib(n,a,c){return c&&typeof c!="number"&&fe(n,a,c)&&(a=c=e),c=c===e?Be:c>>>0,c?(n=wt(n),n&&(typeof a=="string"||a!=null&&!Qa(a))&&(a=Pe(a),!a&&Ls(n))?zi(qe(n),0,c):n.split(a,c)):[]}var sb=Gs(function(n,a,c){return n+(c?" ":"")+eh(a)});function nb(n,a,c){return n=wt(n),c=c==null?0:ps(ht(c),0,n.length),a=Pe(a),n.slice(c,c+a.length)==a}function rb(n,a,c){var p=x.templateSettings;c&&fe(n,a,c)&&(a=e),n=wt(n),a=$r({},a,p,_u);var _=$r({},a.imports,p.imports,_u),w=Jt(_),A=da(_,w),C,T,L=0,O=a.interpolate||nr,F="__p += '",N=pa((a.escape||nr).source+"|"+O.source+"|"+(O===Vl?Vg:nr).source+"|"+(a.evaluate||nr).source+"|$","g"),$="//# sourceURL="+(bt.call(a,"sourceURL")?(a.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++p_+"]")+`
`;n.replace(N,function(Q,ut,pt,Te,pe,Ie){return pt||(pt=Te),F+=n.slice(L,Ie).replace($g,L_),ut&&(C=!0,F+=`' +
__e(`+ut+`) +
'`),pe&&(T=!0,F+=`';
`+pe+`;
__p += '`),pt&&(F+=`' +
((__t = (`+pt+`)) == null ? '' : __t) +
'`),L=Ie+Q.length,Q}),F+=`';
`;var Z=bt.call(a,"variable")&&a.variable;if(!Z)F=`with (obj) {
`+F+`
}
`;else if(Fg.test(Z))throw new nt(l);F=(T?F.replace(wg,""):F).replace(bg,"$1").replace(vg,"$1;"),F="function("+(Z||"obj")+`) {
`+(Z?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(C?", __e = _.escape":"")+(T?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+F+`return __p
}`;var lt=hd(function(){return _t(w,$+"return "+F).apply(e,A)});if(lt.source=F,Za(lt))throw lt;return lt}function ob(n){return wt(n).toLowerCase()}function ab(n){return wt(n).toUpperCase()}function hb(n,a,c){if(n=wt(n),n&&(c||a===e))return mc(n);if(!n||!(a=Pe(a)))return n;var p=qe(n),_=qe(a),w=xc(p,_),A=yc(p,_)+1;return zi(p,w,A).join("")}function lb(n,a,c){if(n=wt(n),n&&(c||a===e))return n.slice(0,bc(n)+1);if(!n||!(a=Pe(a)))return n;var p=qe(n),_=yc(p,qe(a))+1;return zi(p,0,_).join("")}function cb(n,a,c){if(n=wt(n),n&&(c||a===e))return n.replace(Zo,"");if(!n||!(a=Pe(a)))return n;var p=qe(n),_=xc(p,qe(a));return zi(p,_).join("")}function ub(n,a){var c=W,p=Et;if(Bt(a)){var _="separator"in a?a.separator:_;c="length"in a?ht(a.length):c,p="omission"in a?Pe(a.omission):p}n=wt(n);var w=n.length;if(Ls(n)){var A=qe(n);w=A.length}if(c>=w)return n;var C=c-Os(p);if(C<1)return p;var T=A?zi(A,0,C).join(""):n.slice(0,C);if(_===e)return T+p;if(A&&(C+=T.length-C),Qa(_)){if(n.slice(C).search(_)){var L,O=T;for(_.global||(_=pa(_.source,wt(Dl.exec(_))+"g")),_.lastIndex=0;L=_.exec(O);)var F=L.index;T=T.slice(0,F===e?C:F)}}else if(n.indexOf(Pe(_),C)!=C){var N=T.lastIndexOf(_);N>-1&&(T=T.slice(0,N))}return T+p}function db(n){return n=wt(n),n&&Ag.test(n)?n.replace(Fl,N_):n}var fb=Gs(function(n,a,c){return n+(c?" ":"")+a.toUpperCase()}),eh=lu("toUpperCase");function ad(n,a,c){return n=wt(n),a=c?e:a,a===e?F_(n)?z_(n):M_(n):n.match(a)||[]}var hd=ct(function(n,a){try{return Se(n,e,a)}catch(c){return Za(c)?c:new nt(c)}}),pb=vi(function(n,a){return Fe(a,function(c){c=ci(c),wi(n,c,ja(n[c],n))}),n});function gb(n){var a=n==null?0:n.length,c=j();return n=a?Rt(n,function(p){if(typeof p[1]!="function")throw new Ue(h);return[c(p[0]),p[1]]}):[],ct(function(p){for(var _=-1;++_<a;){var w=n[_];if(Se(w[0],this,p))return Se(w[1],this,p)}})}function _b(n){return Nm(De(n,g))}function ih(n){return function(){return n}}function mb(n,a){return n==null||n!==n?a:n}var xb=uu(),yb=uu(!0);function we(n){return n}function sh(n){return Nc(typeof n=="function"?n:De(n,g))}function wb(n){return Hc(De(n,g))}function bb(n,a){return zc(n,De(a,g))}var vb=ct(function(n,a){return function(c){return vn(c,n,a)}}),Ab=ct(function(n,a){return function(c){return vn(n,c,a)}});function nh(n,a,c){var p=Jt(a),_=Pr(a,p);c==null&&!(Bt(a)&&(_.length||!p.length))&&(c=a,a=n,n=this,_=Pr(a,Jt(a)));var w=!(Bt(c)&&"chain"in c)||!!c.chain,A=Si(n);return Fe(_,function(C){var T=a[C];n[C]=T,A&&(n.prototype[C]=function(){var L=this.__chain__;if(w||L){var O=n(this.__wrapped__),F=O.__actions__=me(this.__actions__);return F.push({func:T,args:arguments,thisArg:n}),O.__chain__=L,O}return T.apply(n,Vi([this.value()],arguments))})}),n}function Sb(){return ne._===this&&(ne._=K_),this}function rh(){}function Cb(n){return n=ht(n),ct(function(a){return $c(a,n)})}var Pb=Fa(Rt),Mb=Fa(dc),Tb=Fa(aa);function ld(n){return Ha(n)?ha(ci(n)):n0(n)}function Ib(n){return function(a){return n==null?e:gs(n,a)}}var kb=fu(),Eb=fu(!0);function oh(){return[]}function ah(){return!1}function Rb(){return{}}function Bb(){return""}function Lb(){return!0}function Ob(n,a){if(n=ht(n),n<1||n>Ye)return[];var c=Be,p=oe(n,Be);a=j(a),n-=Be;for(var _=ua(p,a);++c<n;)a(c);return _}function Fb(n){return rt(n)?Rt(n,ci):Me(n)?[n]:me(Iu(wt(n)))}function Ub(n){var a=++q_;return wt(n)+a}var Vb=Rr(function(n,a){return n+a},0),Db=Ua("ceil"),Wb=Rr(function(n,a){return n/a},1),Nb=Ua("floor");function Gb(n){return n&&n.length?Cr(n,we,va):e}function Hb(n,a){return n&&n.length?Cr(n,j(a,2),va):e}function zb(n){return gc(n,we)}function $b(n,a){return gc(n,j(a,2))}function Yb(n){return n&&n.length?Cr(n,we,Pa):e}function Xb(n,a){return n&&n.length?Cr(n,j(a,2),Pa):e}var qb=Rr(function(n,a){return n*a},1),jb=Ua("round"),Kb=Rr(function(n,a){return n-a},0);function Zb(n){return n&&n.length?ca(n,we):0}function Qb(n,a){return n&&n.length?ca(n,j(a,2)):0}return x.after=wy,x.ary=Wu,x.assign=aw,x.assignIn=td,x.assignInWith=$r,x.assignWith=hw,x.at=lw,x.before=Nu,x.bind=ja,x.bindAll=pb,x.bindKey=Gu,x.castArray=Ry,x.chain=Uu,x.chunk=N0,x.compact=G0,x.concat=H0,x.cond=gb,x.conforms=_b,x.constant=ih,x.countBy=Zx,x.create=cw,x.curry=Hu,x.curryRight=zu,x.debounce=$u,x.defaults=uw,x.defaultsDeep=dw,x.defer=by,x.delay=vy,x.difference=z0,x.differenceBy=$0,x.differenceWith=Y0,x.drop=X0,x.dropRight=q0,x.dropRightWhile=j0,x.dropWhile=K0,x.fill=Z0,x.filter=Jx,x.flatMap=iy,x.flatMapDeep=sy,x.flatMapDepth=ny,x.flatten=Bu,x.flattenDeep=Q0,x.flattenDepth=J0,x.flip=Ay,x.flow=xb,x.flowRight=yb,x.fromPairs=tx,x.functions=yw,x.functionsIn=ww,x.groupBy=ry,x.initial=ix,x.intersection=sx,x.intersectionBy=nx,x.intersectionWith=rx,x.invert=vw,x.invertBy=Aw,x.invokeMap=ay,x.iteratee=sh,x.keyBy=hy,x.keys=Jt,x.keysIn=ye,x.map=Dr,x.mapKeys=Cw,x.mapValues=Pw,x.matches=wb,x.matchesProperty=bb,x.memoize=Nr,x.merge=Mw,x.mergeWith=ed,x.method=vb,x.methodOf=Ab,x.mixin=nh,x.negate=Gr,x.nthArg=Cb,x.omit=Tw,x.omitBy=Iw,x.once=Sy,x.orderBy=ly,x.over=Pb,x.overArgs=Cy,x.overEvery=Mb,x.overSome=Tb,x.partial=Ka,x.partialRight=Yu,x.partition=cy,x.pick=kw,x.pickBy=id,x.property=ld,x.propertyOf=Ib,x.pull=lx,x.pullAll=Ou,x.pullAllBy=cx,x.pullAllWith=ux,x.pullAt=dx,x.range=kb,x.rangeRight=Eb,x.rearg=Py,x.reject=fy,x.remove=fx,x.rest=My,x.reverse=Xa,x.sampleSize=gy,x.set=Rw,x.setWith=Bw,x.shuffle=_y,x.slice=px,x.sortBy=yy,x.sortedUniq=bx,x.sortedUniqBy=vx,x.split=ib,x.spread=Ty,x.tail=Ax,x.take=Sx,x.takeRight=Cx,x.takeRightWhile=Px,x.takeWhile=Mx,x.tap=Gx,x.throttle=Iy,x.thru=Vr,x.toArray=Zu,x.toPairs=sd,x.toPairsIn=nd,x.toPath=Fb,x.toPlainObject=Ju,x.transform=Lw,x.unary=ky,x.union=Tx,x.unionBy=Ix,x.unionWith=kx,x.uniq=Ex,x.uniqBy=Rx,x.uniqWith=Bx,x.unset=Ow,x.unzip=qa,x.unzipWith=Fu,x.update=Fw,x.updateWith=Uw,x.values=$s,x.valuesIn=Vw,x.without=Lx,x.words=ad,x.wrap=Ey,x.xor=Ox,x.xorBy=Fx,x.xorWith=Ux,x.zip=Vx,x.zipObject=Dx,x.zipObjectDeep=Wx,x.zipWith=Nx,x.entries=sd,x.entriesIn=nd,x.extend=td,x.extendWith=$r,nh(x,x),x.add=Vb,x.attempt=hd,x.camelCase=Gw,x.capitalize=rd,x.ceil=Db,x.clamp=Dw,x.clone=By,x.cloneDeep=Oy,x.cloneDeepWith=Fy,x.cloneWith=Ly,x.conformsTo=Uy,x.deburr=od,x.defaultTo=mb,x.divide=Wb,x.endsWith=Hw,x.eq=Ke,x.escape=zw,x.escapeRegExp=$w,x.every=Qx,x.find=ty,x.findIndex=Eu,x.findKey=fw,x.findLast=ey,x.findLastIndex=Ru,x.findLastKey=pw,x.floor=Nb,x.forEach=Vu,x.forEachRight=Du,x.forIn=gw,x.forInRight=_w,x.forOwn=mw,x.forOwnRight=xw,x.get=Ja,x.gt=Vy,x.gte=Dy,x.has=bw,x.hasIn=th,x.head=Lu,x.identity=we,x.includes=oy,x.indexOf=ex,x.inRange=Ww,x.invoke=Sw,x.isArguments=xs,x.isArray=rt,x.isArrayBuffer=Wy,x.isArrayLike=xe,x.isArrayLikeObject=Nt,x.isBoolean=Ny,x.isBuffer=$i,x.isDate=Gy,x.isElement=Hy,x.isEmpty=zy,x.isEqual=$y,x.isEqualWith=Yy,x.isError=Za,x.isFinite=Xy,x.isFunction=Si,x.isInteger=Xu,x.isLength=Hr,x.isMap=qu,x.isMatch=qy,x.isMatchWith=jy,x.isNaN=Ky,x.isNative=Zy,x.isNil=Jy,x.isNull=Qy,x.isNumber=ju,x.isObject=Bt,x.isObjectLike=Ut,x.isPlainObject=Tn,x.isRegExp=Qa,x.isSafeInteger=tw,x.isSet=Ku,x.isString=zr,x.isSymbol=Me,x.isTypedArray=zs,x.isUndefined=ew,x.isWeakMap=iw,x.isWeakSet=sw,x.join=ox,x.kebabCase=Yw,x.last=Ne,x.lastIndexOf=ax,x.lowerCase=Xw,x.lowerFirst=qw,x.lt=nw,x.lte=rw,x.max=Gb,x.maxBy=Hb,x.mean=zb,x.meanBy=$b,x.min=Yb,x.minBy=Xb,x.stubArray=oh,x.stubFalse=ah,x.stubObject=Rb,x.stubString=Bb,x.stubTrue=Lb,x.multiply=qb,x.nth=hx,x.noConflict=Sb,x.noop=rh,x.now=Wr,x.pad=jw,x.padEnd=Kw,x.padStart=Zw,x.parseInt=Qw,x.random=Nw,x.reduce=uy,x.reduceRight=dy,x.repeat=Jw,x.replace=tb,x.result=Ew,x.round=jb,x.runInContext=P,x.sample=py,x.size=my,x.snakeCase=eb,x.some=xy,x.sortedIndex=gx,x.sortedIndexBy=_x,x.sortedIndexOf=mx,x.sortedLastIndex=xx,x.sortedLastIndexBy=yx,x.sortedLastIndexOf=wx,x.startCase=sb,x.startsWith=nb,x.subtract=Kb,x.sum=Zb,x.sumBy=Qb,x.template=rb,x.times=Ob,x.toFinite=Ci,x.toInteger=ht,x.toLength=Qu,x.toLower=ob,x.toNumber=Ge,x.toSafeInteger=ow,x.toString=wt,x.toUpper=ab,x.trim=hb,x.trimEnd=lb,x.trimStart=cb,x.truncate=ub,x.unescape=db,x.uniqueId=Ub,x.upperCase=fb,x.upperFirst=eh,x.each=Vu,x.eachRight=Du,x.first=Lu,nh(x,function(){var n={};return hi(x,function(a,c){bt.call(x.prototype,c)||(n[c]=a)}),n}(),{chain:!1}),x.VERSION=s,Fe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){x[n].placeholder=x}),Fe(["drop","take"],function(n,a){dt.prototype[n]=function(c){c=c===e?1:jt(ht(c),0);var p=this.__filtered__&&!a?new dt(this):this.clone();return p.__filtered__?p.__takeCount__=oe(c,p.__takeCount__):p.__views__.push({size:oe(c,Be),type:n+(p.__dir__<0?"Right":"")}),p},dt.prototype[n+"Right"]=function(c){return this.reverse()[n](c).reverse()}}),Fe(["filter","map","takeWhile"],function(n,a){var c=a+1,p=c==J||c==Ft;dt.prototype[n]=function(_){var w=this.clone();return w.__iteratees__.push({iteratee:j(_,3),type:c}),w.__filtered__=w.__filtered__||p,w}}),Fe(["head","last"],function(n,a){var c="take"+(a?"Right":"");dt.prototype[n]=function(){return this[c](1).value()[0]}}),Fe(["initial","tail"],function(n,a){var c="drop"+(a?"":"Right");dt.prototype[n]=function(){return this.__filtered__?new dt(this):this[c](1)}}),dt.prototype.compact=function(){return this.filter(we)},dt.prototype.find=function(n){return this.filter(n).head()},dt.prototype.findLast=function(n){return this.reverse().find(n)},dt.prototype.invokeMap=ct(function(n,a){return typeof n=="function"?new dt(this):this.map(function(c){return vn(c,n,a)})}),dt.prototype.reject=function(n){return this.filter(Gr(j(n)))},dt.prototype.slice=function(n,a){n=ht(n);var c=this;return c.__filtered__&&(n>0||a<0)?new dt(c):(n<0?c=c.takeRight(-n):n&&(c=c.drop(n)),a!==e&&(a=ht(a),c=a<0?c.dropRight(-a):c.take(a-n)),c)},dt.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},dt.prototype.toArray=function(){return this.take(Be)},hi(dt.prototype,function(n,a){var c=/^(?:filter|find|map|reject)|While$/.test(a),p=/^(?:head|last)$/.test(a),_=x[p?"take"+(a=="last"?"Right":""):a],w=p||/^find/.test(a);_&&(x.prototype[a]=function(){var A=this.__wrapped__,C=p?[1]:arguments,T=A instanceof dt,L=C[0],O=T||rt(A),F=function(ut){var pt=_.apply(x,Vi([ut],C));return p&&N?pt[0]:pt};O&&c&&typeof L=="function"&&L.length!=1&&(T=O=!1);var N=this.__chain__,$=!!this.__actions__.length,Z=w&&!N,lt=T&&!$;if(!w&&O){A=lt?A:new dt(this);var Q=n.apply(A,C);return Q.__actions__.push({func:Vr,args:[F],thisArg:e}),new Ve(Q,N)}return Z&&lt?n.apply(this,C):(Q=this.thru(F),Z?p?Q.value()[0]:Q.value():Q)})}),Fe(["pop","push","shift","sort","splice","unshift"],function(n){var a=cr[n],c=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",p=/^(?:pop|shift)$/.test(n);x.prototype[n]=function(){var _=arguments;if(p&&!this.__chain__){var w=this.value();return a.apply(rt(w)?w:[],_)}return this[c](function(A){return a.apply(rt(A)?A:[],_)})}}),hi(dt.prototype,function(n,a){var c=x[a];if(c){var p=c.name+"";bt.call(Ds,p)||(Ds[p]=[]),Ds[p].push({name:a,func:c})}}),Ds[Er(e,M).name]=[{name:"wrapper",func:e}],dt.prototype.clone=dm,dt.prototype.reverse=fm,dt.prototype.value=pm,x.prototype.at=Hx,x.prototype.chain=zx,x.prototype.commit=$x,x.prototype.next=Yx,x.prototype.plant=qx,x.prototype.reverse=jx,x.prototype.toJSON=x.prototype.valueOf=x.prototype.value=Kx,x.prototype.first=x.prototype.head,gn&&(x.prototype[gn]=Xx),x},Fs=$_();cs?((cs.exports=Fs)._=Fs,sa._=Fs):ne._=Fs}).call(In)})(xo,xo.exports);var OP=xo.exports,Uo={};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.backtrace=void 0;function FP(i,t,e){const s=[];let r=e?i:i.getParent();for(;r.getParent();)s.push([r.position.x,r.position.y]),r=r.getParent();return t&&s.push([r.position.x,r.position.y]),s.reverse()}Uo.backtrace=FP;var Vo={};Object.defineProperty(Vo,"__esModule",{value:!0});Vo.calculateHeuristic=void 0;function UP(i,t,e,s){const r=Math.abs(e.x-t.x),o=Math.abs(e.y-t.y);switch(i){case"Manhatten":case"Manhattan":return(r+o)*s;case"Euclidean":return Math.sqrt(r*r+o*o)*s;case"Chebyshev":return Math.max(r,o)*s;case"Octile":return(r+o-.58*Math.min(r,o))*s}}Vo.calculateHeuristic=UP;var tr={},Do={};Object.defineProperty(Do,"__esModule",{value:!0});Do.Node=void 0;class VP{constructor(t){this.id=t.id,this.position=t.position,this.hValue=0,this.gValue=0,this.fValue=0,this.parentNode=void 0,this.isOnClosedList=!1,this.isOnOpenList=!1,this.isWalkable=t.walkable||!0}calculateFValue(){this.fValue=this.gValue+this.hValue}setGValue(t){this.gValue=t,this.calculateFValue()}setHValue(t){this.hValue=t,this.calculateFValue()}setFGHValuesToZero(){this.fValue=this.gValue=this.hValue=0}getFValue(){return this.fValue}getGValue(){return this.gValue}getHValue(){return this.hValue}getParent(){return this.parentNode}getIsOnClosedList(){return this.isOnClosedList}getIsOnOpenList(){return this.isOnOpenList}getIsWalkable(){return this.isWalkable}setParent(t){this.parentNode=t}setIsOnClosedList(t){this.isOnClosedList=t}setIsOnOpenList(t){this.isOnOpenList=t}setIsWalkable(t){this.isWalkable=t}}Do.Node=VP;Object.defineProperty(tr,"__esModule",{value:!0});tr.Grid=void 0;const Rf=Do;let DP=class{constructor(t){t.width&&t.height?(this.width=t.width,this.height=t.height,this.numberOfFields=this.width*this.height):t.matrix&&(this.width=t.matrix[0].length,this.height=t.matrix.length,this.numberOfFields=this.width*this.height),this.gridNodes=this.buildGridWithNodes(t.matrix||void 0,this.width,this.height,t.densityOfObstacles||0)}buildGridWithNodes(t,e,s,r){const o=[];let h=0;for(let l=0;l<s;l++){o[l]=[];for(let u=0;u<e;u++)o[l][u]=new Rf.Node({id:h,position:{x:u,y:l}}),h++}if(t===void 0){for(let l=0;l<s;l++)for(let u=0;u<e;u++)Math.floor(Math.random()*10)+1>10-r?o[l][u].setIsWalkable(!1):o[l][u].setIsWalkable(!0);return o}for(let l=0;l<s;l++)for(let u=0;u<e;u++)o[l][u].setIsWalkable(!t[l][u]);return o}getNodeAt(t){return this.gridNodes[t.y][t.x]}isWalkableAt(t){return this.gridNodes[t.y][t.x].getIsWalkable()}isOnTheGrid(t){return t.x>=0&&t.x<this.width&&t.y>=0&&t.y<this.height}getSurroundingNodes(t,e){const s=[],r=t.x-1,o=t.x+1,h=t.y-1,l=t.y+1;for(let u=h;u<=l;u++)for(let d=r;d<=o;d++)(d!==t.x||u!==t.y)&&this.isOnTheGrid({x:d,y:u})&&this.isWalkableAt({x:d,y:u})&&(e||d==t.x||u==t.y)&&s.push(this.getNodeAt({x:d,y:u}));return s}setGrid(t){this.gridNodes=t}resetGrid(){for(let t=0;t<this.gridNodes.length;t++)for(let e=0;e<this.gridNodes[t].length;e++)this.gridNodes[t][e].setIsOnClosedList(!1),this.gridNodes[t][e].setIsOnOpenList(!1),this.gridNodes[t][e].setParent(void 0),this.gridNodes[t][e].setFGHValuesToZero()}getGridNodes(){return this.gridNodes}clone(){const t=[];let e=0;for(let s=0;s<this.height;s++){t[s]=[];for(let r=0;r<this.width;r++)t[s][r]=new Rf.Node({id:e,position:{x:r,y:s},walkable:this.gridNodes[s][r].getIsWalkable()}),e++}return t}};tr.Grid=DP;Object.defineProperty(Fo,"__esModule",{value:!0});Fo.AStarFinder=void 0;const Bf=OP,Lf=Uo,WP=Vo,NP=tr;class GP{constructor(t){this.grid=new NP.Grid({width:t.grid.width,height:t.grid.height,matrix:t.grid.matrix||void 0,densityOfObstacles:t.grid.densityOfObstacles||0}),this.closedList=[],this.openList=[],this.diagonalAllowed=t.diagonalAllowed!==void 0?t.diagonalAllowed:!0,this.heuristic=t.heuristic?t.heuristic:"Manhattan",this.includeStartNode=t.includeStartNode!==void 0?t.includeStartNode:!0,this.includeEndNode=t.includeEndNode!==void 0?t.includeEndNode:!0,this.allowPathAsCloseAsPossible=t.allowPathAsCloseAsPossible||!1,this.weight=t.weight||1}findPath(t,e){this.closedList=[],this.openList=[],this.grid.resetGrid();const s=this.grid.getNodeAt(t),r=this.grid.getNodeAt(e);if(!this.grid.isWalkableAt(e)||!this.grid.isWalkableAt(t))return[];s.setIsOnOpenList(!0),this.openList.push(s);for(let o=0;o<this.grid.height;o++)for(let h=0;h<this.grid.width;h++){let l=this.grid.getNodeAt({x:h,y:o});this.grid.isWalkableAt({x:h,y:o})?l.setHValue((0,WP.calculateHeuristic)(this.heuristic,l.position,r.position,this.weight)):(l.setFGHValuesToZero(),l.setIsOnClosedList(!0),this.closedList.push(l))}for(;this.openList.length!==0;){const o=(0,Bf.minBy)(this.openList,l=>l.getFValue());if(o.setIsOnOpenList(!1),(0,Bf.remove)(this.openList,o),o.setIsOnClosedList(!0),this.closedList.push(o),o===r)return(0,Lf.backtrace)(r,this.includeStartNode,this.includeEndNode);const h=this.grid.getSurroundingNodes(o.position,this.diagonalAllowed);for(let l in h){const u=h[l];if(u.getIsOnClosedList())continue;const d=o.getGValue()+(u.position.x!==o.position.x||u.position.y==o.position.y?this.weight:this.weight*1.41421);(!u.getIsOnOpenList()||d<u.getGValue())&&(u.setGValue(d),u.setParent(o),u.getIsOnOpenList()?u.setParent(o):(u.setIsOnOpenList(!0),this.openList.push(u)))}}return this.allowPathAsCloseAsPossible?(0,Lf.backtrace)(this.closedList[this.closedList.length-1],this.includeStartNode,!1):[]}setHeuristic(t){this.heuristic=t}setWeight(t){this.weight=t}getGridClone(){return this.grid.clone()}getGrid(){return this.grid}}Fo.AStarFinder=GP;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.Grid=i.AStarFinder=void 0;var t=Fo;Object.defineProperty(i,"AStarFinder",{enumerable:!0,get:function(){return t.AStarFinder}});var e=tr;Object.defineProperty(i,"Grid",{enumerable:!0,get:function(){return e.Grid}})})(mg);const Zi=class Zi extends Bl{constructor(e,s,r,o,h,l){super(e,s,r,{color:l.color});U(this,"obstructed");U(this,"highlighted");U(this,"world_x");U(this,"world_y");this.world_x=o,this.world_y=h,this.obstructed=(l==null?void 0:l.obstructed)||!1,this.highlighted=!1}toggleHighlight(){nn(this.color!=="red","Attempting to toggle highlight when cell is obstructed"),this.highlighted=!this.highlighted,this.color=this.highlighted?Zi.HIGHLIGHT_COLOR:Zi.NORMAL_COLOR}markObstructed(e){this.obstructed=e,e===!0?this.color="red":this.color=this.highlighted?Zi.HIGHLIGHT_COLOR:Zi.NORMAL_COLOR}get wx(){return this.world_x}get wy(){return this.world_y}};U(Zi,"NORMAL_COLOR","blue"),U(Zi,"HIGHLIGHT_COLOR","yellow");let _l=Zi;const Of=10,le=class le extends kt{constructor(e=G(.5),s=!1){super({x:0,y:0,width:G(100),height:st(100),tint:"lightgreen",zIndex:1});U(this,"debug");U(this,"astarInstance");U(this,"dotRadius");U(this,"world");U(this,"needsUpdate",!1);this.eventMode="none",this.debug=s,this.visible=this.debug,this.dotRadius=e,Qn.push({job:"add",child:this,obstruct:!1});const r=100/le.HORIZONTAL_CELL_COUNT,o=100/le.VERTICAL_CELL_COUNT;this.world=new Array(le.HORIZONTAL_CELL_COUNT);for(let h=0;h<=le.HORIZONTAL_CELL_COUNT;h++){this.world[h]=new Array(le.VERTICAL_CELL_COUNT);for(let l=0;l<=le.VERTICAL_CELL_COUNT;l++)this.world[h][l]=this.createCell(G(r*h),st(o*l),h,l)}}setupAStar(){this.astarInstance=new mg.AStarFinder({grid:{matrix:this.world.map(e=>e.map(s=>s.obstructed?1:0))},heuristic:"Manhatten"})}createCell(e,s,r,o){const h=new _l(e,s,this.dotRadius,r,o,{color:"blue"});return this.addChild(h),h}getClosestUnobstractedCell(e){const s=100/le.HORIZONTAL_CELL_COUNT,r=100/le.VERTICAL_CELL_COUNT,o=e.x*100/G(100),h=e.y*100/st(100),l=Math.floor(o/s),u=Math.floor(h/r),d=Math.min(Math.max(l,0),le.HORIZONTAL_CELL_COUNT-1),f=Math.min(Math.max(u,0),le.VERTICAL_CELL_COUNT-1),g=this.bfs(this.world[d][f]);return this.debug&&(g==null||g.toggleHighlight()),new at(g==null?void 0:g.wx,g==null?void 0:g.wy)}obstructions(e,s=!0){const r=100/le.HORIZONTAL_CELL_COUNT,o=100/le.VERTICAL_CELL_COUNT,h=e.x*100/G(100),l=e.y*100/st(100),u=(e.x+e.width)*100/G(100),d=(e.y+e.height)*100/st(100),f=Math.floor(h/r),g=Math.ceil(u/r),m=Math.floor(l/o),y=Math.ceil(d/o);for(let b=f;b<=g;b++)for(let S=m;S<=y;S++)this.world[b][S].markObstructed(s)}findPath(e,s){(!this.astarInstance||this.needsUpdate)&&this.setupAStar(),nn(!!this.astarInstance,"AStar must be initiated");const r=this.astarInstance.findPath(new at(e.y,e.x),new at(s.y,s.x));return nn(r.length!==0,"No path found"),r.map(([o,h])=>{const l=this.world[h][o];return[l.x,l.y]})}getAdjacentNodes(e){const s=e.wx,r=e.wy,o=[];for(let h=-1;h<=1;++h)for(let l=-1;l<=1;++l){const u=s+h,d=r+l;u>0&&u<this.world.length-1&&d>0&&d<this.world[0].length-1&&!(l===0&&h===l)&&o.push(this.world[u][d])}return o}bfs(e){if(!e)return;const s=new Set,r=new rs;let o;for(r.push(e);!r.isEmpty&&(o=r.pop(),!!o);){if(!o.obstructed)return o;s.add(o),this.getAdjacentNodes(o).forEach(h=>{s.has(h)||(s.add(h),r.push(h))})}nn(!1,"No unobstructed cells found nearby")}};U(le,"HORIZONTAL_CELL_COUNT",9*Of),U(le,"VERTICAL_CELL_COUNT",16*Of);let ml=le;const HP=`
Hi, looks like you're new here 

Please give this a quick read to know whats going on!
(You can also open this anytime by clicking the ${ce.GEAR}> ${ce.INFO})

Think of it as a take away restaurant. Yippie!!

    - You've got the Kitchen with different stations
        to make different meals
    - You've got the sitting area where customers sit
        and make their orders through the waiters
    - The waiters processes the order
    - The kitchen staff makes it
    - The waiter finally delivers it

Simply right? :)

Heres a quick summary of who is who:

    - 's are the kitchen workers,
    - 's are the waiters,
    - 's are customers.

    - 's are the customer waiting areas.
    - The colored squares are your menu item prep stations.
    - The grey bar is the transfer station from back to front staff.

Starting out you have a bit of coins to unlock the first menu item.
Marked unlockable/upgradable by the marker.

As you make sales, you gather money to upgrade stations,
and unlock more menu items.
Upgrading stations increases the product prices.

On the top right corner, 
the brown square with the yellow arrow has more upgrades.
Click on it and check it out after.
It also shows the marker when upgrades are available.

Your aim is to make as much money as possible 
and live the luxury life 

Lets get cracking 
(click outside to continue)
`;class zP extends Bi{constructor(e,s,r,o,h,l){super(e,s,r,o,l);U(this,"btnMap",new Map);U(this,"screenOverlayBg");U(this,"infoContainer");U(this,"fullScreenBtn");U(this,"fullScreenBtnFactory");this.fullScreenBtnFactory=h,this.setupFullScreenBtn(h,G(90),st(1)),this.view.eventMode="passive",this.createBtn("main",G(90),st(1),ce.GEAR,()=>this.settingsViewToggle(),!0),this.screenOverlayBg=new Bi(0,0,G(100),st(100),{color:"black",interactive:!0}),this.screenOverlayBg.view.alpha=.5,this.screenOverlayBg.view.cursor="default",this.screenOverlayBg.view.visible=!1,this.screenOverlayBg.view.on("pointertap",()=>this.settingsViewToggle()),this.view.addChild(this.screenOverlayBg.view),Dn.text.visible=!1,this.view.addChild(Dn.text),this.createBtn("reset",G(84),st(1),ce.RESET,()=>{if(confirm("Restart from beginning?")){const u=localStorage.getItem("saveIntervalId")||"0";clearInterval(parseInt(u)),localStorage.clear(),location.reload()}}),this.infoContainer=new gg({width:G(95),height:st(60),background:"lightyellow",type:"vertical",radius:G(5),padding:G(3),elementsMargin:st(.5),globalScroll:!1}),this.infoContainer.x=G(50)-this.infoContainer.width/2,this.infoContainer.y=st(50)-this.infoContainer.height/2,this.infoContainer.addItem(new gi({text:HP,style:{fontSize:G(3)}})),this.infoContainer.visible=!1,this.createBtn("info",G(78),st(1),ce.INFO,()=>{this.infoContainer.visible=!0}),this.view.addChild(this.infoContainer)}async settingsViewToggle(e=!1){this.screenOverlayBg.view.visible=!this.screenOverlayBg.view.visible,Dn.text.visible=!Dn.text.visible,this.fullScreenBtn||await this.setupFullScreenBtn(this.fullScreenBtnFactory,G(90),st(1)),this.fullScreenBtn.visible=!this.fullScreenBtn.visible;for(let[s,r]of this.btnMap)r.view.visible=!r.view.visible;this.infoContainer.visible=e}async setupFullScreenBtn(e,s,r){this.fullScreenBtn=await e(s,r),this.fullScreenBtn.visible=!1,this.view.addChild(this.fullScreenBtn)}createBtn(e,s,r,o,h,l=!1){const u=new Lo(new gi({text:o,style:{fontSize:G(5)}}));return u.onPress.connect(h),u.view.position.set(s,r),u.view.visible=l,this.view.addChild(u.view),this.btnMap.set(e,u),u}}let Dh=!1;async function $P(i){Dh?await document.exitFullscreen():await i.canvas.requestFullscreen(),Dh=!Dh}class YP extends Ms{constructor(t,e,s,r){super(t),this.width=G(5),this.height=G(5),this.position.set(s||G(94),r||G(1)),this.eventMode="static",this.cursor="pointer",this.on("pointerdown",async()=>{await $P(e)}),this.on("pointerover",()=>{this.tint=6710886}),this.on("pointerout",()=>{this.tint=16777215})}reset(){this.width=G(5),this.height=G(5),this.parent.toLocal(new at(G(94),st(1)),void 0,this.position)}}async function XP(i,t,e){const s=await Vn.load("full-screen-button.png");return new YP(s,i,t,e)}const Ps=new LP,ss=new ml;let xl=performance.now(),Wh=0;const qP=async i=>{JP(i),i.stage.eventMode="static",i.stage.hitArea=i.screen,tM(i),eM(i),iM(i),ZP(i),jP(i),nM({back:Pt.backWorkers,front:Pt.frontWorkers,customer:Pt.customerWorkers},i),sn.text.zIndex=20,i.stage.addChild(sn.text),sn.update(`${ce.MONEYSACK} ${Pt.bcoins}`),xl=performance.now(),sM(i),i.stage.on("pointertap",e=>{Kt.forEach(s=>{s.contains(e.global)||(s.infoPopup.visible=!1)})});const t=setInterval(()=>KP(),1e3);localStorage.setItem("saveIntervalId",t.toString())};function jP(i){for(let t in Pt){const e=localStorage.getItem(t);if(e)switch(t){case"stage":Pt[t]=e;break;case"bcoins":const{value:s,exp:r,negative:o}=JSON.parse(e);Pt[t]=new mt(s,r,o);break;case"backWorkers":case"frontWorkers":case"customerWorkers":Pt[t]=Number(e);break;case"stations":const h=JSON.parse(e);for(let u=0;u<Kt.length;u++)for(let d=0;d<h[u];d++)Kt[u].upgrade(!0);break;case"upgrades":const l=JSON.parse(e);Pt.upgrades=l,Ps.onLoad(l,i);break;default:throw new Error(`unrecognised keyword in StateData: ${t}`)}}}function KP(){for(let i in Pt)switch(i){case"stage":localStorage.setItem(i,"1-1");break;case"bcoins":localStorage.setItem(i,Pt[i].serialize());break;case"backWorkers":case"frontWorkers":case"customerWorkers":localStorage.setItem(i,Pt[i].toString());break;case"stations":localStorage.setItem(i,JSON.stringify(Kt.map(t=>t.LEVEL)));break;case"upgrades":localStorage.setItem(i,JSON.stringify(Pt[i]));break;default:throw new Error(`unrecognised keyword in StateData: ${i}`)}localStorage.setItem("lastUpdated",Date().toString())}function ZP(i){i.stage.addChild(Ps);const t=()=>Ps.show(),e=QP(G(90),st(8),"brown",{txt:"",color:"yellow",size:G(5)},t,i,!0,5);Ps.setup(e,[new Ht(new Ii(0,0,{color:"white"}),mt.from(190),1,"customer"),new Ht(new Nn(0,0,{color:"green"}),mt.from(850),1,"worker-back"),new Ht(new Ii(0,0,{color:"white"}),new mt(5.67,3),1,"customer"),new Ht(Kt[0],new mt(14.2,3),2,"speed"),new Ht(new _g(0,0,{color:"blue"}),new mt(21.3,3),1,"worker-front"),new Ht(new Ii(0,0,{color:"white"}),new mt(42.5,3),1,"customer"),new Ht(new Ii(0,0,{color:"white"}),new mt(142,3),1,"customer"),new Ht(new Nn(0,0,{color:"green"}),new mt(170,3),1,"worker-back"),new Ht(Kt[0],new mt(425,3),3,"price"),new Ht(Kt[1],new mt(709,3),2,"speed"),new Ht(new Ii(0,0,{color:"white"}),new mt(1.14,6),1,"customer"),new Ht(new Nn(0,0,{color:"green"}),new mt(2.84,6),1.2,"worker-speed"),new Ht(Kt[0],new mt(11.4,6),2,"speed"),new Ht(new Ii(0,0,{color:"white"}),new mt(12.8,6),1,"customer"),new Ht(new Nn(0,0,{color:"green"}),new mt(14.2,6),1,"worker-back"),new Ht(Kt[1],new mt(21.3,6),3,"price"),new Ht(Kt[2],new mt(35.5,6),2,"speed"),new Ht(new Ii(0,0,{color:"white"}),new mt(120,6),2,"customer"),new Ht(Kt[0],new mt(128,6),5,"price"),new Ht(Kt[1],new mt(567,6),2,"speed"),new Ht(new Ii(0,0,{color:"white"}),new mt(850,6),2,"customer")],i)}function QP(i,t,e,s,r,o,h=!0,l=0){const u=new Bi(i,t,G(8),st(5),{color:e,interactive:h});u.view.on("pointertap",r),u.view.zIndex=l;const d=new gi({text:s.txt,anchor:.5,style:{fontWeight:"bold",fontSize:s.size,fill:s.color}});return d.position=u.centre,d.eventMode="none",d.zIndex=l,o.stage.addChild(u.view,d),u}function JP(i){const t={color:"#1a4761",interactive:!1,zIndex:20},e=async(l,u)=>await XP(i,l,u),s=new zP(0,0,Zt.width,st(5),e,t);localStorage.length===0&&s.settingsViewToggle(!0);const r=new Bi(0,Zt.height-2,Zt.width,2,t),o=new Bi(0,0,2,Zt.height,t),h=new Bi(Zt.width-2,0,2,Zt.height,t);i.stage.addChild(...[s,r,o,h].map(l=>l.view))}function tM(i){const t=ji.SIZE,e=Math.floor(Zt.width/t),s=Zt.height/2,r=(Zt.width-e*t)/2;for(let o=0;o<e;o++){const h=new ji(r+t*o,s-t/2,{color:"grey"});ss.obstructions(h),cl.push(h),i.stage.addChild(h.view)}}function eM(i){const t={color:"orange"},e=ji.SIZE*.1,s=({x:r,y:o})=>{[new ji(r,o,t),new ji(r+ji.SIZE+e,o,t),new ji(r+(ji.SIZE+e)*2,o,t)].forEach(h=>{ss.obstructions(h),fl.push(h),i.stage.addChild(h.view)})};[new at(G(6),st(9.5)),new at(G(56),st(19)),new at(G(24),st(31))].forEach(s)}function iM(i){const t=[[[G(7.95),st(55.9),12,7,3600],["cyan","bottom"]],[[G(7.95),st(78.5),700,3540,7200],["hotpink","bottom"]],[[G(35.6),st(92.7),35400,177e3,21500],["red","right"]],[[G(35.6),st(70.4),1774e3,887e4,45500],["pink","right"]],[[G(92.04)-is.SIZE,st(55.9),887e5,441875e3,60800],["yellow","bottom"]],[[G(92.04)-is.SIZE,st(78.5),441875e4,2209375e4,9e4],["purple","bottom"]]];Kt.push(...t.map(([[e,s,r,o,h],[l,u]],d)=>{const f=new is(e,s,{category:d,color:l,productPrice:r,upgradePrice:o,workDuration:h,slotGrowDirection:u});return ss.obstructions(f),f})),Kt.map(e=>i.stage.addChild(...e.getView()))}const sM=i=>{i.ticker.add(()=>{++Wh;const t=performance.now(),e=t-xl;if(e>=1e3){const s=Wh*1e3/e;Dn.update(s.toFixed(2)),Wh=0,xl=t}for(Kt.forEach(s=>{const r=s.canUpgrade(Pt.bcoins);s.setUpgradable(r)}),Ps.setAvailableUpgradesMarker(!1),Ps.list.items.every(s=>{const r=s.refreshUpgradableStatus(Pt.bcoins);return r&&Ps.setAvailableUpgradesMarker(!0),r});!Qn.isEmpty;){const{job:s,child:r,obstruct:o}=Qn.pop();s==="add"?(i.stage.addChild(r),o&&ss.obstructions(r,!0)):s==="remove"&&(i.stage.removeChild(r),o&&ss.obstructions(r,!1))}if(!$n.isEmpty&&!uo.isEmpty){const s=$n.pop(),r=uo.pop();s.doWork(r,i)||($n.push(s),uo.push(r))}if(!Yn.isEmpty)if(dl.isEmpty){if(!ul.isEmpty){const s=Yn.pop(),r=ul.pop();s.doWork(r,i)}}else{const s=Yn.pop(),r=dl.pop();s.doWork(r,i)}if(!pl.isEmpty){const s=pl.pop(),r=fl.reduce((o,h)=>o.occupants.size<h.occupants.size?o:h,fl[0]);s.doWork(r,Ll,i)}})},nM=({back:i=0,front:t=0,customer:e=0},s,r=!1)=>{for(let o=0;o<i;o++)gl(s,"back",r);for(let o=0;o<t;o++)gl(s,"front",r);for(let o=0;o<e;o++)Ll(s,r)};(async()=>{const i=new Ip;await i.init({resizeTo:window,resolution:window.devicePixelRatio||1,width:Zt.width,height:Zt.height,autoDensity:!0}),document.querySelector("#app").appendChild(i.canvas),qP(i)})();export{Pp as $,Cp as A,zt as B,kt as C,Wt as D,q as E,Ei as F,bo as G,Yf as H,pi as I,Cd as J,Ms as K,d1 as L,yt as M,b1 as N,Qt as O,at as P,ie as Q,Kh as R,oA as S,Oi as T,Yh as U,D1 as V,Md as W,Hv as X,mh as Y,$t as Z,qf as _,ft as a,gt as a0,xt as a1,z1 as a2,Vp as a3,kA as a4,RA as a5,UA as a6,DA as a7,WA as a8,on as a9,Is as aa,kS as ab,zp as ac,jd as ad,Xd as ae,gv as af,js as ag,RC as ah,wf as ai,FS as aj,Dt as ak,Vt as al,mv as am,hl as an,al as ao,xf as ap,Yp as aq,Qs as b,ii as c,ts as d,_e as e,qd as f,sA as g,lo as h,Cs as i,vl as j,vp as k,np as l,xp as m,fd as n,mf as o,IA as p,EA as q,Iv as r,OA as s,Bp as t,VA as u,Al as v,Yt as w,pp as x,_v as y,GA as z};
